/*! For license information please see 374.js.LICENSE.txt */
(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[374,291],{1293:function(e,t,n){var a,i,r;!function(o){var s=this||(0,eval)("this"),c=s.document,d=s.navigator,l=s.jQuery,u=s.JSON;!function(o){i=[t,n],void 0===(r="function"==typeof(a=o)?a.apply(t,i):a)||(e.exports=r)}(function(e,t){function n(e,t){return(null===e||typeof e in D)&&e===t}function a(e,t){var n;return function(){n||(n=S.a.setTimeout(function(){n=o,e()},t))}}function i(e,t){var n;return function(){clearTimeout(n),n=S.a.setTimeout(e,t)}}function r(e,t){t&&t!==I?"beforeChange"===t?this.Lb(e):this.Ha(e,t):this.Mb(e)}function f(e,t){null!==t&&t.k&&t.k()}function p(e,t){var n=this.Ic,a=n[E];a.S||(this.lb&&this.Na[t]?(n.Qb(t,e,this.Na[t]),this.Na[t]=null,--this.lb):a.r[t]||n.Qb(t,e,a.s?{ia:e}:n.wc(e)))}function m(e,t,n,a){S.d[e]={init:function(e,i,r,o,s){var c,d;return S.m(function(){var r=i(),o=S.a.c(r),l=(o=!n!=!o,!d);(l||t||o!==c)&&(l&&S.va.Aa()&&(d=S.a.ua(S.e.childNodes(e),!0)),o?(l||S.e.da(e,S.a.ua(d)),S.Ka(a?a(s,r):s,e)):S.e.xa(e),c=o)},null,{i:e}),{controlsDescendantBindings:!0}}},S.h.ta[e]=!1,S.e.V[e]=!0}var _,h,b,g,v,y,S=void 0!==e?e:{};S.b=function(e,t){for(var n=e.split("."),a=S,i=0;i<n.length-1;i++)a=a[n[i]];a[n[n.length-1]]=t},S.G=function(e,t,n){e[t]=n},S.version="3.5.0-pre",S.b("version",S.version),S.options={deferUpdates:!1,useOnlyNativeEvents:!1},S.a=function(){function e(e,t){for(var n in e)e.hasOwnProperty(n)&&t(n,e[n])}function t(e,t){if(t)for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}function n(e,t){return e.__proto__=t,e}function a(e,t,n,a){var i=e[t].match(h)||[];S.a.q(n.match(h),function(e){S.a.pa(i,e,a)}),e[t]=i.join(" ")}var i={__proto__:[]}instanceof Array,r="function"==typeof Symbol,f={},p={};f[d&&/Firefox\/2/i.test(d.userAgent)?"KeyboardEvent":"UIEvents"]=["keyup","keydown","keypress"],f.MouseEvents="click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave".split(" "),e(f,function(e,t){if(t.length)for(var n=0,a=t.length;n<a;n++)p[t[n]]=e});var m={propertychange:!0},_=c&&function(){for(var e=3,t=c.createElement("div"),n=t.getElementsByTagName("i");t.innerHTML="\x3c!--[if gt IE "+ ++e+"]><i></i><![endif]--\x3e",n[0];);return 4<e?e:o}(),h=/\S+/g;return{ec:["authenticity_token",/^__RequestVerificationToken(_.*)?$/],q:function(e,t){for(var n=0,a=e.length;n<a;n++)t(e[n],n)},o:function(e,t){if("function"==typeof Array.prototype.indexOf)return Array.prototype.indexOf.call(e,t);for(var n=0,a=e.length;n<a;n++)if(e[n]===t)return n;return-1},Tb:function(e,t,n){for(var a=0,i=e.length;a<i;a++)if(t.call(n,e[a],a))return e[a];return null},Ma:function(e,t){var n=S.a.o(e,t);0<n?e.splice(n,1):0===n&&e.shift()},Ub:function(e){for(var t=[],n=0,a=(e=e||[]).length;n<a;n++)0>S.a.o(t,e[n])&&t.push(e[n]);return t},fb:function(e,t){for(var n=[],a=0,i=(e=e||[]).length;a<i;a++)n.push(t(e[a],a));return n},La:function(e,t){for(var n=[],a=0,i=(e=e||[]).length;a<i;a++)t(e[a],a)&&n.push(e[a]);return n},ra:function(e,t){if(t instanceof Array)e.push.apply(e,t);else for(var n=0,a=t.length;n<a;n++)e.push(t[n]);return e},pa:function(e,t,n){var a=S.a.o(S.a.zb(e),t);0>a?n&&e.push(t):n||e.splice(a,1)},ka:i,extend:t,Ya:n,Za:i?n:t,D:e,Ca:function(e,t){if(!e)return e;var n,a={};for(n in e)e.hasOwnProperty(n)&&(a[n]=t(e[n],n,e));return a},ob:function(e){for(;e.firstChild;)S.removeNode(e.firstChild)},lc:function(e){for(var t=((e=S.a.W(e))[0]&&e[0].ownerDocument||c).createElement("div"),n=0,a=e.length;n<a;n++)t.appendChild(S.$(e[n]));return t},ua:function(e,t){for(var n=0,a=e.length,i=[];n<a;n++){var r=e[n].cloneNode(!0);i.push(t?S.$(r):r)}return i},da:function(e,t){if(S.a.ob(e),t)for(var n=0,a=t.length;n<a;n++)e.appendChild(t[n])},sc:function(e,t){var n=e.nodeType?[e]:e;if(0<n.length){for(var a=n[0],i=a.parentNode,r=0,o=t.length;r<o;r++)i.insertBefore(t[r],a);for(r=0,o=n.length;r<o;r++)S.removeNode(n[r])}},za:function(e,t){if(e.length){for(t=8===t.nodeType&&t.parentNode||t;e.length&&e[0].parentNode!==t;)e.splice(0,1);for(;1<e.length&&e[e.length-1].parentNode!==t;)e.length--;if(1<e.length){var n=e[0],a=e[e.length-1];for(e.length=0;n!==a;)e.push(n),n=n.nextSibling;e.push(a)}}return e},uc:function(e,t){7>_?e.setAttribute("selected",t):e.selected=t},ab:function(e){return null===e||e===o?"":e.trim?e.trim():e.toString().replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")},od:function(e,t){return e=e||"",!(t.length>e.length)&&e.substring(0,t.length)===t},Nc:function(e,t){if(e===t)return!0;if(11===e.nodeType)return!1;if(t.contains)return t.contains(3===e.nodeType?e.parentNode:e);if(t.compareDocumentPosition)return 16==(16&t.compareDocumentPosition(e));for(;e&&e!=t;)e=e.parentNode;return!!e},nb:function(e){return S.a.Nc(e,e.ownerDocument.documentElement)},Rb:function(e){return!!S.a.Tb(e,S.a.nb)},A:function(e){return e&&e.tagName&&e.tagName.toLowerCase()},Xb:function(e){return S.onError?function(){try{return e.apply(this,arguments)}catch(e){throw S.onError&&S.onError(e),e}}:e},setTimeout:function(e,t){return setTimeout(S.a.Xb(e),t)},bc:function(e){setTimeout(function(){throw S.onError&&S.onError(e),e},0)},p:function(e,t,n){var a=S.a.Xb(n);if(n=_&&m[t],S.options.useOnlyNativeEvents||n||!l)if(n||"function"!=typeof e.addEventListener){if(void 0===e.attachEvent)throw Error("Browser doesn't support addEventListener or attachEvent");var i=function(t){a.call(e,t)},r="on"+t;e.attachEvent(r,i),S.a.F.oa(e,function(){e.detachEvent(r,i)})}else e.addEventListener(t,a,!1);else l(e).bind(t,a)},Da:function(e,t){if(!e||!e.nodeType)throw Error("element must be a DOM node when calling triggerEvent");var n;if(n=!("input"!==S.a.A(e)||!e.type||"click"!=t.toLowerCase()||"checkbox"!=(n=e.type)&&"radio"!=n),S.options.useOnlyNativeEvents||!l||n)if("function"==typeof c.createEvent){if("function"!=typeof e.dispatchEvent)throw Error("The supplied element doesn't support dispatchEvent");(n=c.createEvent(p[t]||"HTMLEvents")).initEvent(t,!0,!0,s,0,0,0,0,0,!1,!1,!1,!1,0,e),e.dispatchEvent(n)}else if(n&&e.click)e.click();else{if(void 0===e.fireEvent)throw Error("Browser doesn't support triggering events");e.fireEvent("on"+t)}else l(e).trigger(t)},c:function(e){return S.H(e)?e():e},zb:function(e){return S.H(e)?e.t():e},cb:function(e,t,n){var i;t&&("object"==typeof e.classList?(i=e.classList[n?"add":"remove"],S.a.q(t.match(h),function(t){i.call(e.classList,t)})):"string"==typeof e.className.baseVal?a(e.className,"baseVal",t,n):a(e,"className",t,n))},$a:function(e,t){var n=S.a.c(t);null!==n&&n!==o||(n="");var a=S.e.firstChild(e);!a||3!=a.nodeType||S.e.nextSibling(a)?S.e.da(e,[e.ownerDocument.createTextNode(n)]):a.data=n,S.a.Sc(e)},tc:function(e,t){if(e.name=t,7>=_)try{e.mergeAttributes(c.createElement("<input name='"+e.name+"'/>"),!1)}catch(e){}},Sc:function(e){9<=_&&(e=1==e.nodeType?e:e.parentNode).style&&(e.style.zoom=e.style.zoom)},Oc:function(e){if(_){var t=e.style.width;e.style.width=0,e.style.width=t}},jd:function(e,t){e=S.a.c(e),t=S.a.c(t);for(var n=[],a=e;a<=t;a++)n.push(a);return n},W:function(e){for(var t=[],n=0,a=e.length;n<a;n++)t.push(e[n]);return t},$b:function(e){return r?Symbol(e):e},sd:6===_,ud:7===_,C:_,gc:function(e,t){for(var n=S.a.W(e.getElementsByTagName("input")).concat(S.a.W(e.getElementsByTagName("textarea"))),a="string"==typeof t?function(e){return e.name===t}:function(e){return t.test(e.name)},i=[],r=n.length-1;0<=r;r--)a(n[r])&&i.push(n[r]);return i},fd:function(e){return"string"==typeof e&&(e=S.a.ab(e))?u&&u.parse?u.parse(e):new Function("return "+e)():null},Eb:function(e,t,n){if(!u||!u.stringify)throw Error("Cannot find JSON.stringify(). Some browsers (e.g., IE < 8) don't support it natively, but you can overcome this by adding a script reference to json2.js, downloadable from http://www.json.org/json2.js");return u.stringify(S.a.c(e),t,n)},gd:function(t,n,a){var i=(a=a||{}).params||{},r=a.includeFields||this.ec,o=t;if("object"==typeof t&&"form"===S.a.A(t)){o=t.action;for(var s=r.length-1;0<=s;s--)for(var d=S.a.gc(t,r[s]),l=d.length-1;0<=l;l--)i[d[l].name]=d[l].value}n=S.a.c(n);var u=c.createElement("form");for(var f in u.style.display="none",u.action=o,u.method="post",n)(t=c.createElement("input")).type="hidden",t.name=f,t.value=S.a.Eb(S.a.c(n[f])),u.appendChild(t);e(i,function(e,t){var n=c.createElement("input");n.type="hidden",n.name=e,n.value=t,u.appendChild(n)}),c.body.appendChild(u),a.submitter?a.submitter(u):u.submit(),setTimeout(function(){u.parentNode.removeChild(u)},0)}}}(),S.b("utils",S.a),S.b("utils.arrayForEach",S.a.q),S.b("utils.arrayFirst",S.a.Tb),S.b("utils.arrayFilter",S.a.La),S.b("utils.arrayGetDistinctValues",S.a.Ub),S.b("utils.arrayIndexOf",S.a.o),S.b("utils.arrayMap",S.a.fb),S.b("utils.arrayPushAll",S.a.ra),S.b("utils.arrayRemoveItem",S.a.Ma),S.b("utils.extend",S.a.extend),S.b("utils.fieldsIncludedWithJsonPost",S.a.ec),S.b("utils.getFormFields",S.a.gc),S.b("utils.peekObservable",S.a.zb),S.b("utils.postJson",S.a.gd),S.b("utils.parseJson",S.a.fd),S.b("utils.registerEventHandler",S.a.p),S.b("utils.stringifyJson",S.a.Eb),S.b("utils.range",S.a.jd),S.b("utils.toggleDomNodeCssClass",S.a.cb),S.b("utils.triggerEvent",S.a.Da),S.b("utils.unwrapObservable",S.a.c),S.b("utils.objectForEach",S.a.D),S.b("utils.addOrRemoveItem",S.a.pa),S.b("utils.setTextContent",S.a.$a),S.b("unwrap",S.a.c),Function.prototype.bind||(Function.prototype.bind=function(e){var t=this;if(1===arguments.length)return function(){return t.apply(e,arguments)};var n=Array.prototype.slice.call(arguments,1);return function(){var a=n.slice(0);return a.push.apply(a,arguments),t.apply(e,a)}}),S.a.f=new function(){function e(e,i){var r=e[n];if(!r||"null"===r||!a[r]){if(!i)return o;r=e[n]="ko"+t++,a[r]={}}return a[r]}var t=0,n="__ko__"+(new Date).getTime(),a={};return{get:function(t,n){var a=e(t,!1);return a===o?o:a[n]},set:function(t,n,a){a===o&&e(t,!1)===o||(e(t,!0)[n]=a)},clear:function(e){var t=e[n];return!!t&&(delete a[t],e[n]=null,!0)},I:function(){return t+++n}}},S.b("utils.domData",S.a.f),S.b("utils.domData.clear",S.a.f.clear),S.a.F=new function(){function e(e,t){var a=S.a.f.get(e,n);return a===o&&t&&(a=[],S.a.f.set(e,n,a)),a}function t(n){if(a=e(n,!1))for(var a=a.slice(0),r=0;r<a.length;r++)a[r](n);if(S.a.f.clear(n),S.a.F.cleanExternalData(n),i[n.nodeType])for(a=n.firstChild;n=a;)a=n.nextSibling,8===n.nodeType&&t(n)}var n=S.a.f.I(),a={1:!0,8:!0,9:!0},i={1:!0,9:!0};return{oa:function(t,n){if("function"!=typeof n)throw Error("Callback must be a function");e(t,!0).push(n)},rc:function(t,a){var i=e(t,!1);i&&(S.a.Ma(i,a),0==i.length&&S.a.f.set(t,n,o))},$:function(e){if(a[e.nodeType]&&(t(e),i[e.nodeType])){var n=[];S.a.ra(n,e.getElementsByTagName("*"));for(var r=0,o=n.length;r<o;r++)t(n[r])}return e},removeNode:function(e){S.$(e),e.parentNode&&e.parentNode.removeChild(e)},cleanExternalData:function(e){l&&"function"==typeof l.cleanData&&l.cleanData([e])}}},S.$=S.a.F.$,S.removeNode=S.a.F.removeNode,S.b("cleanNode",S.$),S.b("removeNode",S.removeNode),S.b("utils.domNodeDisposal",S.a.F),S.b("utils.domNodeDisposal.addDisposeCallback",S.a.F.oa),S.b("utils.domNodeDisposal.removeDisposeCallback",S.a.F.rc),_=[0,"",""],v={thead:h=[1,"<table>","</table>"],tbody:h,tfoot:h,tr:[2,"<table><tbody>","</tbody></table>"],td:b=[3,"<table><tbody><tr>","</tr></tbody></table>"],th:b,option:g=[1,"<select multiple='multiple'>","</select>"],optgroup:g},y=8>=S.a.C,S.a.ma=function(e,t){var n;if(l){if(l.parseHTML)n=l.parseHTML(e,t)||[];else if((n=l.clean([e],t))&&n[0]){for(var a=n[0];a.parentNode&&11!==a.parentNode.nodeType;)a=a.parentNode;a.parentNode&&a.parentNode.removeChild(a)}}else{(n=t)||(n=c),a=n.parentWindow||n.defaultView||s;var i,r=S.a.ab(e).toLowerCase(),o=n.createElement("div");for(i=(r=r.match(/^<([a-z]+)[ >]/))&&v[r[1]]||_,r=i[0],i="ignored<div>"+i[1]+e+i[2]+"</div>","function"==typeof a.innerShiv?o.appendChild(a.innerShiv(i)):(y&&n.appendChild(o),o.innerHTML=i,y&&o.parentNode.removeChild(o));r--;)o=o.lastChild;n=S.a.W(o.lastChild.childNodes)}return n},S.a.Cb=function(e,t){if(S.a.ob(e),null!==(t=S.a.c(t))&&t!==o)if("string"!=typeof t&&(t=t.toString()),l)l(e).html(t);else for(var n=S.a.ma(t,e.ownerDocument),a=0;a<n.length;a++)e.appendChild(n[a])},S.b("utils.parseHtmlFragment",S.a.ma),S.b("utils.setHtml",S.a.Cb),S.M=function(){function e(t,n){if(t)if(8==t.nodeType)null!=(a=S.M.nc(t.nodeValue))&&n.push({Mc:t,dd:a});else if(1==t.nodeType)for(var a=0,i=t.childNodes,r=i.length;a<r;a++)e(i[a],n)}var t={};return{wb:function(e){if("function"!=typeof e)throw Error("You can only pass a function to ko.memoization.memoize()");var n=(4294967296*(1+Math.random())|0).toString(16).substring(1)+(4294967296*(1+Math.random())|0).toString(16).substring(1);return t[n]=e,"\x3c!--[ko_memo:"+n+"]--\x3e"},zc:function(e,n){var a=t[e];if(a===o)throw Error("Couldn't find any memo with ID "+e+". Perhaps it's already been unmemoized.");try{return a.apply(null,n||[]),!0}finally{delete t[e]}},Ac:function(t,n){var a=[];e(t,a);for(var i=0,r=a.length;i<r;i++){var o=a[i].Mc,s=[o];n&&S.a.ra(s,n),S.M.zc(a[i].dd,s),o.nodeValue="",o.parentNode&&o.parentNode.removeChild(o)}},nc:function(e){return(e=e.match(/^\[ko_memo\:(.*?)\]$/))?e[1]:null}}}(),S.b("memoization",S.M),S.b("memoization.memoize",S.M.wb),S.b("memoization.unmemoize",S.M.zc),S.b("memoization.parseMemoText",S.M.nc),S.b("memoization.unmemoizeDomNodeAndDescendants",S.M.Ac),S.Z=function(){function e(){if(a)for(var e,t=a,i=0;r<a;)if(e=n[r++]){if(r>t){if(5e3<=++i){r=a,S.a.bc(Error("'Too much recursion' after processing "+i+" task groups."));break}t=a}try{e()}catch(e){S.a.bc(e)}}}function t(){e(),r=a=n.length=0}var n=[],a=0,i=1,r=0;return{scheduler:s.MutationObserver?function(e){var t=c.createElement("div");return new MutationObserver(e).observe(t,{attributes:!0}),function(){t.classList.toggle("foo")}}(t):c&&"onreadystatechange"in c.createElement("script")?function(e){var t=c.createElement("script");t.onreadystatechange=function(){t.onreadystatechange=null,c.documentElement.removeChild(t),t=null,e()},c.documentElement.appendChild(t)}:function(e){setTimeout(e,0)},Xa:function(e){return a||S.Z.scheduler(t),n[a++]=e,i++},cancel:function(e){(e-=i-a)>=r&&e<a&&(n[e]=null)},resetForTesting:function(){var e=a-r;return r=a=n.length=0,e},nd:e}}(),S.b("tasks",S.Z),S.b("tasks.schedule",S.Z.Xa),S.b("tasks.runEarly",S.Z.nd),S.ya={throttle:function(e,t){e.throttleEvaluation=t;var n=null;return S.B({read:e,write:function(a){clearTimeout(n),n=S.a.setTimeout(function(){e(a)},t)}})},rateLimit:function(e,t){var n,r,o;"number"==typeof t?n=t:(n=t.timeout,r=t.method),e.eb=!1,o="notifyWhenChangesStop"==r?i:a,e.Ua(function(e){return o(e,n)})},deferred:function(e,t){if(!0!==t)throw Error("The 'deferred' extender only accepts the value 'true', because it is not supported to turn deferral off once enabled.");e.eb||(e.eb=!0,e.Ua(function(t){var n;return function(){S.Z.cancel(n),n=S.Z.Xa(t),e.notifySubscribers(o,"dirty")}}))},notify:function(e,t){e.equalityComparer="always"==t?null:n}};var D={undefined:1,boolean:1,number:1,string:1};S.b("extenders",S.ya),S.xc=function(e,t,n){this.ia=e,this.gb=t,this.Lc=n,this.S=!1,S.G(this,"dispose",this.k)},S.xc.prototype.k=function(){this.S=!0,this.Lc()},S.J=function(){S.a.Za(this,x),x.rb(this)};var I="change",x={rb:function(e){e.K={},e.Ob=1},Y:function(e,t,n){var a=this;n=n||I;var i=new S.xc(a,t?e.bind(t):e,function(){S.a.Ma(a.K[n],i),a.Ia&&a.Ia(n)});return a.sa&&a.sa(n),a.K[n]||(a.K[n]=[]),a.K[n].push(i),i},notifySubscribers:function(e,t){if((t=t||I)===I&&this.Ib(),this.Qa(t))try{S.l.Vb();for(var n,a=this.K[t].slice(0),i=0;n=a[i];++i)n.S||n.gb(e)}finally{S.l.end()}},Oa:function(){return this.Ob},Vc:function(e){return this.Oa()!==e},Ib:function(){++this.Ob},Ua:function(e){var t,n,a,i=this,o=S.H(i);i.Ha||(i.Ha=i.notifySubscribers,i.notifySubscribers=r);var s=e(function(){i.Nb=!1,o&&a===i&&(a=i()),t=!1,i.tb(n,a)&&i.Ha(n=a)});i.Mb=function(e){i.Nb=t=!0,a=e,s()},i.Lb=function(e){t||(n=e,i.Ha(e,"beforeChange"))}},Qa:function(e){return this.K[e]&&this.K[e].length},Tc:function(e){if(e)return this.K[e]&&this.K[e].length||0;var t=0;return S.a.D(this.K,function(e,n){"dirty"!==e&&(t+=n.length)}),t},tb:function(e,t){return!this.equalityComparer||!this.equalityComparer(e,t)},extend:function(e){var t=this;return e&&S.a.D(e,function(e,n){var a=S.ya[e];"function"==typeof a&&(t=a(t,n)||t)}),t}};S.G(x,"subscribe",x.Y),S.G(x,"extend",x.extend),S.G(x,"getSubscriptionsCount",x.Tc),S.a.ka&&S.a.Ya(x,Function.prototype),S.J.fn=x,S.jc=function(e){return null!=e&&"function"==typeof e.Y&&"function"==typeof e.notifySubscribers},S.b("subscribable",S.J),S.b("isSubscribable",S.jc),S.va=S.l=function(){function e(e){a.push(n),n=e}function t(){n=a.pop()}var n,a=[],i=0;return{Vb:e,end:t,qc:function(e){if(n){if(!S.jc(e))throw Error("Only subscribable things can act as dependencies");n.gb.call(n.Hc,e,e.Dc||(e.Dc=++i))}},w:function(n,a,i){try{return e(),n.apply(a,i||[])}finally{t()}},Aa:function(){if(n)return n.m.Aa()},Ta:function(){if(n)return n.Ta}}}(),S.b("computedContext",S.va),S.b("computedContext.getDependenciesCount",S.va.Aa),S.b("computedContext.isInitial",S.va.Ta),S.b("ignoreDependencies",S.rd=S.l.w);var C=S.a.$b("_latestValue");S.N=function(e){function t(){return 0<arguments.length?(t.tb(t[C],arguments[0])&&(t.ga(),t[C]=arguments[0],t.fa()),this):(S.l.qc(t),t[C])}return t[C]=e,S.a.ka||S.a.extend(t,S.J.fn),S.J.fn.rb(t),S.a.Za(t,O),S.options.deferUpdates&&S.ya.deferred(t,!0),t};var O={equalityComparer:n,t:function(){return this[C]},fa:function(){this.notifySubscribers(this[C])},ga:function(){this.notifySubscribers(this[C],"beforeChange")}};S.a.ka&&S.a.Ya(O,S.J.fn);var w=S.N.hd="__ko_proto__";O[w]=S.N,S.Pa=function(e,t){return null!==e&&e!==o&&e[w]!==o&&(e[w]===t||S.Pa(e[w],t))},S.H=function(e){return S.Pa(e,S.N)},S.Ba=function(e){return!!("function"==typeof e&&e[w]===S.N||"function"==typeof e&&e[w]===S.B&&e.Wc)},S.b("observable",S.N),S.b("isObservable",S.H),S.b("isWriteableObservable",S.Ba),S.b("isWritableObservable",S.Ba),S.b("observable.fn",O),S.G(O,"peek",O.t),S.G(O,"valueHasMutated",O.fa),S.G(O,"valueWillMutate",O.ga),S.la=function(e){if("object"!=typeof(e=e||[])||!("length"in e))throw Error("The argument passed when initializing an observable array must be an array, or null, or undefined.");return e=S.N(e),S.a.Za(e,S.la.fn),e.extend({trackArrayChanges:!0})},S.la.fn={remove:function(e){for(var t=this.t(),n=[],a="function"!=typeof e||S.H(e)?function(t){return t===e}:e,i=0;i<t.length;i++){var r=t[i];a(r)&&(0===n.length&&this.ga(),n.push(r),t.splice(i,1),i--)}return n.length&&this.fa(),n},removeAll:function(e){if(e===o){var t=this.t(),n=t.slice(0);return this.ga(),t.splice(0,t.length),this.fa(),n}return e?this.remove(function(t){return 0<=S.a.o(e,t)}):[]},destroy:function(e){var t=this.t(),n="function"!=typeof e||S.H(e)?function(t){return t===e}:e;this.ga();for(var a=t.length-1;0<=a;a--)n(t[a])&&(t[a]._destroy=!0);this.fa()},destroyAll:function(e){return e===o?this.destroy(function(){return!0}):e?this.destroy(function(t){return 0<=S.a.o(e,t)}):[]},indexOf:function(e){var t=this();return S.a.o(t,e)},replace:function(e,t){var n=this.indexOf(e);0<=n&&(this.ga(),this.t()[n]=t,this.fa())}},S.a.ka&&S.a.Ya(S.la.fn,S.N.fn),S.a.q("pop push reverse shift sort splice unshift".split(" "),function(e){S.la.fn[e]=function(){var t=this.t();this.ga(),this.Wb(t,e,arguments);var n=t[e].apply(t,arguments);return this.fa(),n===t?this:n}}),S.a.q(["slice"],function(e){S.la.fn[e]=function(){var t=this();return t[e].apply(t,arguments)}}),S.b("observableArray",S.la),S.ya.trackArrayChanges=function(e,t){function n(){if(!r){r=!0,i=e.notifySubscribers,e.notifySubscribers=function(e,t){return t&&t!==I||++c,i.apply(this,arguments)};var t=[].concat(e.t()||[]);s=null,a=e.Y(function(n){var a;n=[].concat(n||[]),e.Qa("arrayChange")&&((!s||1<c)&&(s=S.a.ib(t,n,e.hb)),a=s),t=n,s=null,c=0,a&&a.length&&e.notifySubscribers(a,"arrayChange")})}}if(e.hb={},t&&"object"==typeof t&&S.a.extend(e.hb,t),e.hb.sparse=!0,!e.Wb){var a,i,r=!1,s=null,c=0,d=e.sa,l=e.Ia;e.sa=function(t){d&&d.call(e,t),"arrayChange"===t&&n()},e.Ia=function(t){l&&l.call(e,t),"arrayChange"!==t||e.Qa("arrayChange")||(i&&(e.notifySubscribers=i,i=o),a.k(),r=!1)},e.Wb=function(e,t,n){function a(e,t,n){return i[i.length]={status:e,value:t,index:n}}if(r&&!c){var i=[],o=e.length,d=n.length,l=0;switch(t){case"push":l=o;case"unshift":for(t=0;t<d;t++)a("added",n[t],l+t);break;case"pop":l=o-1;case"shift":o&&a("deleted",e[l],l);break;case"splice":t=Math.min(Math.max(0,0>n[0]?o+n[0]:n[0]),o),o=1===d?o:Math.min(t+(n[1]||0),o),d=t+d-2,l=Math.max(o,d);for(var u=[],f=[],p=2;t<l;++t,++p)t<o&&f.push(a("deleted",e[t],t)),t<d&&u.push(a("added",n[p],t));S.a.fc(f,u);break;default:return}s=i}}}};var E=S.a.$b("_state");S.m=S.B=function(e,t,n){function a(){if(0<arguments.length){if("function"!=typeof i)throw Error("Cannot write a value to a ko.computed unless you specify a 'write' option. If you wish to read the current value, don't pass any parameters.");return i.apply(r.pb,arguments),this}return S.l.qc(a),(r.T||r.s&&a.Ra())&&a.aa(),r.U}if("object"==typeof e?n=e:(n=n||{},e&&(n.read=e)),"function"!=typeof n.read)throw Error("Pass a function that returns the value of the ko.computed");var i=n.write,r={U:o,T:!0,Sa:!1,Fb:!1,S:!1,Wa:!1,s:!1,kd:n.read,pb:t||n.owner,i:n.disposeWhenNodeIsRemoved||n.i||null,wa:n.disposeWhen||n.wa,mb:null,r:{},L:0,dc:null};return a[E]=r,a.Wc="function"==typeof i,S.a.ka||S.a.extend(a,S.J.fn),S.J.fn.rb(a),S.a.Za(a,A),n.pure?(r.Wa=!0,r.s=!0,S.a.extend(a,L)):n.deferEvaluation&&S.a.extend(a,k),S.options.deferUpdates&&S.ya.deferred(a,!0),r.i&&(r.Fb=!0,r.i.nodeType||(r.i=null)),r.s||n.deferEvaluation||a.aa(),r.i&&a.ba()&&S.a.F.oa(r.i,r.mb=function(){a.k()}),a};var A={equalityComparer:n,Aa:function(){return this[E].L},Qb:function(e,t,n){if(this[E].Wa&&t===this)throw Error("A 'pure' computed must not be called recursively");this[E].r[e]=n,n.Ga=this[E].L++,n.na=t.Oa()},Ra:function(){var e,t,n=this[E].r;for(e in n)if(n.hasOwnProperty(e)&&(t=n[e]).ia.Vc(t.na))return!0},cd:function(){this.Fa&&!this[E].Sa&&this.Fa()},ba:function(){return this[E].T||0<this[E].L},md:function(){this.Nb||this.cc()},wc:function(e){if(e.eb&&!this[E].i){var t=e.Y(this.cd,this,"dirty"),n=e.Y(this.md,this);return{ia:e,k:function(){t.k(),n.k()}}}return e.Y(this.cc,this)},cc:function(){var e=this,t=e.throttleEvaluation;t&&0<=t?(clearTimeout(this[E].dc),this[E].dc=S.a.setTimeout(function(){e.aa(!0)},t)):e.Fa?e.Fa():e.aa(!0)},aa:function(e){var t=this[E],n=t.wa;if(!t.Sa&&!t.S){if(t.i&&!S.a.nb(t.i)||n&&n()){if(!t.Fb)return void this.k()}else t.Fb=!1;t.Sa=!0;try{this.Rc(e)}finally{t.Sa=!1}t.L||this.k()}},Rc:function(e){var t=this[E],n=t.Wa?o:!t.L,a={Ic:this,Na:t.r,lb:t.L};S.l.Vb({Hc:a,gb:p,m:this,Ta:n}),t.r={},t.L=0,a=this.Qc(t,a),this.tb(t.U,a)&&(t.s||this.notifySubscribers(t.U,"beforeChange"),t.U=a,t.s?this.Ib():e&&this.notifySubscribers(t.U)),n&&this.notifySubscribers(t.U,"awake")},Qc:function(e,t){try{var n=e.kd;return e.pb?n.call(e.pb):n()}finally{S.l.end(),t.lb&&!e.s&&S.a.D(t.Na,f),e.T=!1}},t:function(){var e=this[E];return(e.T&&!e.L||e.s&&this.Ra())&&this.aa(),e.U},Ua:function(e){S.J.fn.Ua.call(this,e),this.Fa=function(){this.Lb(this[E].U),this[E].T=!0,this.Mb(this)}},k:function(){var e=this[E];!e.s&&e.r&&S.a.D(e.r,function(e,t){t.k&&t.k()}),e.i&&e.mb&&S.a.F.rc(e.i,e.mb),e.r=null,e.L=0,e.S=!0,e.T=!1,e.s=!1,e.i=null}},L={sa:function(e){var t=this,n=t[E];if(!n.S&&n.s&&"change"==e){if(n.s=!1,n.T||t.Ra())n.r=null,n.L=0,n.T=!0,t.aa(),t.Ib();else{var a=[];S.a.D(n.r,function(e,t){a[t.Ga]=e}),S.a.q(a,function(e,a){var i=n.r[e],r=t.wc(i.ia);r.Ga=a,r.na=i.na,n.r[e]=r})}n.S||t.notifySubscribers(n.U,"awake")}},Ia:function(e){var t=this[E];t.S||"change"!=e||this.Qa("change")||(S.a.D(t.r,function(e,n){n.k&&(t.r[e]={ia:n.ia,Ga:n.Ga,na:n.na},n.k())}),t.s=!0,this.notifySubscribers(o,"asleep"))},Oa:function(){var e=this[E];return e.s&&(e.T||this.Ra())&&this.aa(),S.J.fn.Oa.call(this)}},k={sa:function(e){"change"!=e&&"beforeChange"!=e||this.t()}};S.a.ka&&S.a.Ya(A,S.J.fn);var M=S.N.hd;S.m[M]=S.N,A[M]=S.m,S.Yc=function(e){return S.Pa(e,S.m)},S.Zc=function(e){return S.Pa(e,S.m)&&e[E]&&e[E].Wa},S.b("computed",S.m),S.b("dependentObservable",S.m),S.b("isComputed",S.Yc),S.b("isPureComputed",S.Zc),S.b("computed.fn",A),S.G(A,"peek",A.t),S.G(A,"dispose",A.k),S.G(A,"isActive",A.ba),S.G(A,"getDependenciesCount",A.Aa),S.pc=function(e,t){return"function"==typeof e?S.m(e,t,{pure:!0}):((e=S.a.extend({},e)).pure=!0,S.m(e,t))},S.b("pureComputed",S.pc),function(){function e(n,a,i){if(i=i||new t,"object"!=typeof(n=a(n))||null===n||n===o||n instanceof RegExp||n instanceof Date||n instanceof String||n instanceof Number||n instanceof Boolean)return n;var r=n instanceof Array?[]:{};return i.save(n,r),function(e,t){if(e instanceof Array){for(var n=0;n<e.length;n++)t(n);"function"==typeof e.toJSON&&t("toJSON")}else for(n in e)t(n)}(n,function(t){var s=a(n[t]);switch(typeof s){case"boolean":case"number":case"string":case"function":r[t]=s;break;case"object":case"undefined":var c=i.get(s);r[t]=c!==o?c:e(s,a,i)}}),r}function t(){this.keys=[],this.Jb=[]}S.yc=function(t){if(0==arguments.length)throw Error("When calling ko.toJS, pass the object you want to convert.");return e(t,function(e){for(var t=0;S.H(e)&&10>t;t++)e=e();return e})},S.toJSON=function(e,t,n){return e=S.yc(e),S.a.Eb(e,t,n)},t.prototype={save:function(e,t){var n=S.a.o(this.keys,e);0<=n?this.Jb[n]=t:(this.keys.push(e),this.Jb.push(t))},get:function(e){return 0<=(e=S.a.o(this.keys,e))?this.Jb[e]:o}}}(),S.b("toJS",S.yc),S.b("toJSON",S.toJSON),S.j={u:function(e){switch(S.a.A(e)){case"option":return!0===e.__ko__hasDomDataOptionValue__?S.a.f.get(e,S.d.options.xb):7>=S.a.C?e.getAttributeNode("value")&&e.getAttributeNode("value").specified?e.value:e.text:e.value;case"select":return 0<=e.selectedIndex?S.j.u(e.options[e.selectedIndex]):o;default:return e.value}},ha:function(e,t,n){switch(S.a.A(e)){case"option":"string"==typeof t?(S.a.f.set(e,S.d.options.xb,o),"__ko__hasDomDataOptionValue__"in e&&delete e.__ko__hasDomDataOptionValue__,e.value=t):(S.a.f.set(e,S.d.options.xb,t),e.__ko__hasDomDataOptionValue__=!0,e.value="number"==typeof t?t:"");break;case"select":""!==t&&null!==t||(t=o);for(var a,i=-1,r=0,s=e.options.length;r<s;++r)if((a=S.j.u(e.options[r]))==t||""==a&&t===o){i=r;break}(n||0<=i||t===o&&1<e.size)&&(e.selectedIndex=i);break;default:null!==t&&t!==o||(t=""),e.value=t}}},S.b("selectExtensions",S.j),S.b("selectExtensions.readValue",S.j.u),S.b("selectExtensions.writeValue",S.j.ha),S.h=function(){function e(e){123===(e=S.a.ab(e)).charCodeAt(0)&&(e=e.slice(1,-1));var t,n=[],o=e.match(a),s=[],c=0;if(o){o.push(",");for(var d,l=0;d=o[l];++l){var u=d.charCodeAt(0);if(44===u){if(0>=c){n.push(t&&s.length?{key:t,value:s.join("")}:{unknown:t||s.join("")}),t=c=0,s=[];continue}}else if(58===u){if(!c&&!t&&1===s.length){t=s.pop();continue}}else 47===u&&l&&1<d.length?(u=o[l-1].match(i))&&!r[u[0]]&&((o=(e=e.substr(e.indexOf(d)+1)).match(a)).push(","),l=-1,d="/"):40===u||123===u||91===u?++c:41===u||125===u||93===u?--c:t||s.length||34!==u&&39!==u||(d=d.slice(1,-1));s.push(d)}}return n}var t=["true","false","null","undefined"],n=/^(?:[$_a-z][$\w]*|(.+)(\.\s*[$_a-z][$\w]*|\[.+\]))$/i,a=RegExp("\"(?:[^\"\\\\]|\\\\.)*\"|'(?:[^'\\\\]|\\\\.)*'|/(?:[^/\\\\]|\\\\.)*/w*|[^\\s:,/][^,\"'{}()/:[\\]]*[^\\s,\"'{}()/:[\\]]|[^\\s]","g"),i=/[\])"'A-Za-z0-9_$]+$/,r={in:1,return:1,typeof:1},o={};return{ta:[],ea:o,yb:e,Va:function(a,i){function r(e,a){var i;if(!l){var u=S.getBindingHandler(e);if(u&&u.preprocess&&!(a=u.preprocess(a,e,r)))return;(u=o[e])&&(i=a,0<=S.a.o(t,i)?i=!1:(u=i.match(n),i=null!==u&&(u[1]?"Object("+u[1]+")"+u[2]:i)),u=i),u&&c.push("'"+e+"':function(_z){"+i+"=_z}")}d&&(a="function(){return "+a+" }"),s.push("'"+e+"':"+a)}var s=[],c=[],d=(i=i||{}).valueAccessors,l=i.bindingParams,u="string"==typeof a?e(a):a;return S.a.q(u,function(e){r(e.key||e.unknown,e.value)}),c.length&&r("_ko_property_writers","{"+c.join(",")+" }"),s.join(",")},bd:function(e,t){for(var n=0;n<e.length;n++)if(e[n].key==t)return!0;return!1},Ea:function(e,t,n,a,i){e&&S.H(e)?!S.Ba(e)||i&&e.t()===a||e(a):(e=t.get("_ko_property_writers"))&&e[n]&&e[n](a)}}}(),S.b("expressionRewriting",S.h),S.b("expressionRewriting.bindingRewriteValidators",S.h.ta),S.b("expressionRewriting.parseObjectLiteral",S.h.yb),S.b("expressionRewriting.preProcessBindings",S.h.Va),S.b("expressionRewriting._twoWayBindings",S.h.ea),S.b("jsonExpressionRewriting",S.h),S.b("jsonExpressionRewriting.insertPropertyAccessorsIntoJson",S.h.Va),function(){function e(e){return 8==e.nodeType&&r.test(i?e.text:e.nodeValue)}function t(e){return 8==e.nodeType&&o.test(i?e.text:e.nodeValue)}function n(n,a){for(var i=n,r=1,o=[];i=i.nextSibling;){if(t(i)&&0==--r)return o;o.push(i),e(i)&&r++}if(!a)throw Error("Cannot find closing comment tag to match: "+n.nodeValue);return null}function a(e,t){var a=n(e,t);return a?0<a.length?a[a.length-1].nextSibling:e.nextSibling:null}var i=c&&"\x3c!--test--\x3e"===c.createComment("test").text,r=i?/^\x3c!--\s*ko(?:\s+([\s\S]+))?\s*--\x3e$/:/^\s*ko(?:\s+([\s\S]+))?\s*$/,o=i?/^\x3c!--\s*\/ko\s*--\x3e$/:/^\s*\/ko\s*$/,s={ul:!0,ol:!0};S.e={V:{},childNodes:function(t){return e(t)?n(t):t.childNodes},xa:function(t){if(e(t))for(var n=0,a=(t=S.e.childNodes(t)).length;n<a;n++)S.removeNode(t[n]);else S.a.ob(t)},da:function(t,n){if(e(t)){S.e.xa(t);for(var a=t.nextSibling,i=0,r=n.length;i<r;i++)a.parentNode.insertBefore(n[i],a)}else S.a.da(t,n)},oc:function(t,n){e(t)?t.parentNode.insertBefore(n,t.nextSibling):t.firstChild?t.insertBefore(n,t.firstChild):t.appendChild(n)},ic:function(t,n,a){a?e(t)?t.parentNode.insertBefore(n,a.nextSibling):a.nextSibling?t.insertBefore(n,a.nextSibling):t.appendChild(n):S.e.oc(t,n)},firstChild:function(n){return e(n)?!n.nextSibling||t(n.nextSibling)?null:n.nextSibling:n.firstChild},nextSibling:function(n){return e(n)&&(n=a(n)),n.nextSibling&&t(n.nextSibling)?null:n.nextSibling},Uc:e,qd:function(e){return(e=(i?e.text:e.nodeValue).match(r))?e[1]:null},mc:function(n){if(s[S.a.A(n)]){var i=n.firstChild;if(i)do{if(1===i.nodeType){var r,o=null;if(r=i.firstChild)do{if(o)o.push(r);else if(e(r)){var c=a(r,!0);c?r=c:o=[r]}else t(r)&&(o=[r])}while(r=r.nextSibling);if(r=o)for(o=i.nextSibling,c=0;c<r.length;c++)o?n.insertBefore(r[c],o):n.appendChild(r[c])}}while(i=i.nextSibling)}}}}(),S.b("virtualElements",S.e),S.b("virtualElements.allowedBindings",S.e.V),S.b("virtualElements.emptyNode",S.e.xa),S.b("virtualElements.insertAfter",S.e.ic),S.b("virtualElements.prepend",S.e.oc),S.b("virtualElements.setDomNodeChildren",S.e.da),S.R=function(){this.Gc={}},S.a.extend(S.R.prototype,{nodeHasBindings:function(e){switch(e.nodeType){case 1:return null!=e.getAttribute("data-bind")||S.g.getComponentNameForNode(e);case 8:return S.e.Uc(e);default:return!1}},getBindings:function(e,t){var n=(n=this.getBindingsString(e,t))?this.parseBindingsString(n,t,e):null;return S.g.Pb(n,e,t,!1)},getBindingAccessors:function(e,t){var n=(n=this.getBindingsString(e,t))?this.parseBindingsString(n,t,e,{valueAccessors:!0}):null;return S.g.Pb(n,e,t,!0)},getBindingsString:function(e){switch(e.nodeType){case 1:return e.getAttribute("data-bind");case 8:return S.e.qd(e);default:return null}},parseBindingsString:function(e,t,n,a){try{var i,r=this.Gc,o=e+(a&&a.valueAccessors||"");if(!(i=r[o])){var s,c="with($context){with($data||{}){return{"+S.h.Va(e,a)+"}}}";s=new Function("$context","$element",c),i=r[o]=s}return i(t,n)}catch(t){throw t.message="Unable to parse bindings.\nBindings value: "+e+"\nMessage: "+t.message,t}}}),S.R.instance=new S.R,S.b("bindingProvider",S.R),function(){function e(e){return function(){return e}}function t(e){return e()}function n(e){return S.a.Ca(S.l.w(e),function(t,n){return function(){return e()[n]}})}function a(t,a,i){return"function"==typeof t?n(t.bind(null,a,i)):S.a.Ca(t,e)}function i(e,t){return n(this.getBindings.bind(this,e,t))}function r(e,t,n){var a,i=S.e.firstChild(t),r=S.R.instance,o=r.preprocessNode;if(o){for(;a=i;)i=S.e.nextSibling(a),o.call(r,a);i=S.e.firstChild(t)}for(;a=i;)i=S.e.nextSibling(a),c(e,a,n)}function c(e,t,n){var a=!0,i=1===t.nodeType;i&&S.e.mc(t),(i&&n||S.R.instance.nodeHasBindings(t))&&(a=d(t,null,e,n).shouldBindDescendants),a&&!f[S.a.A(t)]&&r(e,t,!i)}function d(e,n,a,r){var s,c,d=S.a.f.get(e,p);if(!n){if(d)throw Error("You cannot apply bindings multiple times to the same element.");S.a.f.set(e,p,!0)}if(!d&&r&&S.vc(e,a),n&&"function"!=typeof n)s=n;else{var l=S.R.instance,u=l.getBindingAccessors||i,f=S.B(function(){return(s=n?n(a,e):u.call(l,e,a))&&a.P&&a.P(),s},null,{i:e});s&&f.ba()||(f=null)}if(s){var m=f?function(e){return function(){return t(f()[e])}}:function(e){return s[e]},_=function(){return S.a.Ca(f?f():s,t)};_.get=function(e){return s[e]&&t(m(e))},_.has=function(e){return e in s},r=function(e){var t=[],n={},a=[];return S.a.D(e,function i(r){if(!n[r]){var o=S.getBindingHandler(r);o&&(o.after&&(a.push(r),S.a.q(o.after,function(t){if(e[t]){if(-1!==S.a.o(a,t))throw Error("Cannot combine the following bindings, because they have a cyclic dependency: "+a.join(", "));i(t)}}),a.length--),t.push({key:r,hc:o})),n[r]=!0}}),t}(s),S.a.q(r,function(t){var n=t.hc.init,i=t.hc.update,r=t.key;if(8===e.nodeType&&!S.e.V[r])throw Error("The binding '"+r+"' cannot be used with virtual elements");try{"function"==typeof n&&S.l.w(function(){var t=n(e,m(r),_,a.$data,a);if(t&&t.controlsDescendantBindings){if(c!==o)throw Error("Multiple bindings ("+c+" and "+r+") are trying to control descendant bindings of the same element. You cannot use these bindings together on the same element.");c=r}}),"function"==typeof i&&S.B(function(){i(e,m(r),_,a.$data,a)},null,{i:e})}catch(e){throw e.message='Unable to process binding "'+r+": "+s[r]+'"\nMessage: '+e.message,e}})}return{shouldBindDescendants:c===o}}function u(e){return e&&e instanceof S.Q?e:new S.Q(e)}S.d={};var f={script:!0,textarea:!0,template:!0};S.getBindingHandler=function(e){return S.d[e]},S.Q=function(e,t,n,a,i){function r(){var i=l?e():e,r=S.a.c(i);return t?(t.P&&t.P(),S.a.extend(d,t),d.P=c):(d.$parents=[],d.$root=r,d.ko=S),d.$rawData=i,d.$data=r,n&&(d[n]=r),a&&a(d,t,r),d.$data}var s,c,d=this,l="function"==typeof e&&!S.H(e);i&&i.exportDependencies?r():(c=S.B(r,null,{wa:function(){return s&&!S.a.Rb(s)},i:!0})).ba()&&(d.P=c,c.equalityComparer=null,s=[],c.Bc=function(e){s.push(e),S.a.F.oa(e,function(e){S.a.Ma(s,e),s.length||(c.k(),d.P=c=o)})})},S.Q.prototype.createChildContext=function(e,t,n,a){return new S.Q(e,this,t,function(e,t){e.$parentContext=t,e.$parent=t.$data,e.$parents=(t.$parents||[]).slice(0),e.$parents.unshift(e.$parent),n&&n(e)},a)},S.Q.prototype.extend=function(e){return new S.Q(this.P||this.$data,this,null,function(t,n){t.$rawData=n.$rawData,S.a.extend(t,"function"==typeof e?e():e)})},S.Q.prototype.Zb=function(e,t){return this.createChildContext(e,t,null,{exportDependencies:!0})};var p=S.a.f.I(),m=S.a.f.I();S.vc=function(e,t){if(2!=arguments.length)return S.a.f.get(e,m);S.a.f.set(e,m,t),t.P&&t.P.Bc(e)},S.Ja=function(e,t,n){return 1===e.nodeType&&S.e.mc(e),d(e,t,u(n),!0)},S.Ec=function(e,t,n){return n=u(n),S.Ja(e,a(t,n,e),n)},S.Ka=function(e,t){1!==t.nodeType&&8!==t.nodeType||r(u(e),t,!0)},S.Sb=function(e,t){if(!l&&s.jQuery&&(l=s.jQuery),t&&1!==t.nodeType&&8!==t.nodeType)throw Error("ko.applyBindings: first parameter should be your view model; second parameter should be a DOM node");t=t||s.document.body,c(u(e),t,!0)},S.kb=function(e){switch(e.nodeType){case 1:case 8:var t=S.vc(e);if(t)return t;if(e.parentNode)return S.kb(e.parentNode)}return o},S.Kc=function(e){return(e=S.kb(e))?e.$data:o},S.b("bindingHandlers",S.d),S.b("applyBindings",S.Sb),S.b("applyBindingsToDescendants",S.Ka),S.b("applyBindingAccessorsToNode",S.Ja),S.b("applyBindingsToNode",S.Ec),S.b("contextFor",S.kb),S.b("dataFor",S.Kc)}(),function(e){function t(t,a){var o,s=i.hasOwnProperty(t)?i[t]:e;s?s.Y(a):((s=i[t]=new S.J).Y(a),n(t,function(e,n){var a=!(!n||!n.synchronous);r[t]={definition:e,$c:a},delete i[t],o||a?s.notifySubscribers(e):S.Z.Xa(function(){s.notifySubscribers(e)})}),o=!0)}function n(e,t){a("getConfig",[e],function(n){n?a("loadComponent",[e,n],function(e){t(e,n)}):t(null,null)})}function a(t,n,i,r){r||(r=S.g.loaders.slice(0));var o=r.shift();if(o){var s=o[t];if(s){var c=!1;if(s.apply(o,n.concat(function(e){c?i(null):null!==e?i(e):a(t,n,i,r)}))!==e&&(c=!0,!o.suppressLoaderExceptions))throw Error("Component loaders must supply values by invoking the callback, not by returning values synchronously.")}else a(t,n,i,r)}else i(null)}var i={},r={};S.g={get:function(n,a){var i=r.hasOwnProperty(n)?r[n]:e;i?i.$c?S.l.w(function(){a(i.definition)}):S.Z.Xa(function(){a(i.definition)}):t(n,a)},Yb:function(e){delete r[e]},Kb:a},S.g.loaders=[],S.b("components",S.g),S.b("components.get",S.g.get),S.b("components.clearCachedDefinition",S.g.Yb)}(),function(){function e(e,t,n,a){function i(){0==--s&&a(o)}var o={},s=2,c=n.template;n=n.viewModel,c?r(t,c,function(t){S.g.Kb("loadTemplate",[e,t],function(e){o.template=e,i()})}):i(),n?r(t,n,function(t){S.g.Kb("loadViewModel",[e,t],function(e){o[l]=e,i()})}):i()}function n(e,t,a){if("function"==typeof t)a(function(e){return new t(e)});else if("function"==typeof t[l])a(t[l]);else if("instance"in t){var i=t.instance;a(function(){return i})}else"viewModel"in t?n(e,t.viewModel,a):e("Unknown viewModel value: "+t)}function a(e){switch(S.a.A(e)){case"script":return S.a.ma(e.text);case"textarea":return S.a.ma(e.value);case"template":if(i(e.content))return S.a.ua(e.content.childNodes)}return S.a.ua(e.childNodes)}function i(e){return s.DocumentFragment?e instanceof DocumentFragment:e&&11===e.nodeType}function r(e,n,a){"string"==typeof n.require?t||s.require?(t||s.require)([n.require],a):e("Uses require, but no AMD loader is present"):a(n)}function o(e){return function(t){throw Error("Component '"+e+"': "+t)}}var d={};S.g.register=function(e,t){if(!t)throw Error("Invalid configuration for "+e);if(S.g.ub(e))throw Error("Component "+e+" is already registered");d[e]=t},S.g.ub=function(e){return d.hasOwnProperty(e)},S.g.pd=function(e){delete d[e],S.g.Yb(e)},S.g.ac={getConfig:function(e,t){t(d.hasOwnProperty(e)?d[e]:null)},loadComponent:function(t,n,a){var i=o(t);r(i,n,function(n){e(t,i,n,a)})},loadTemplate:function(e,t,n){if(e=o(e),"string"==typeof t)n(S.a.ma(t));else if(t instanceof Array)n(t);else if(i(t))n(S.a.W(t.childNodes));else if(t.element)if(t=t.element,s.HTMLElement?t instanceof HTMLElement:t&&t.tagName&&1===t.nodeType)n(a(t));else if("string"==typeof t){var r=c.getElementById(t);r?n(a(r)):e("Cannot find element with ID "+t)}else e("Unknown element type: "+t);else e("Unknown template value: "+t)},loadViewModel:function(e,t,a){n(o(e),t,a)}};var l="createViewModel";S.b("components.register",S.g.register),S.b("components.isRegistered",S.g.ub),S.b("components.unregister",S.g.pd),S.b("components.defaultLoader",S.g.ac),S.g.loaders.push(S.g.ac),S.g.Cc=d}(),function(){function e(e,n){if(a=e.getAttribute("params")){var a=t.parseBindingsString(a,n,e,{valueAccessors:!0,bindingParams:!0}),i=(a=S.a.Ca(a,function(t){return S.m(t,null,{i:e})}),S.a.Ca(a,function(t){var n=t.t();return t.ba()?S.m({read:function(){return S.a.c(t())},write:S.Ba(n)&&function(e){t()(e)},i:e}):n}));return i.hasOwnProperty("$raw")||(i.$raw=a),i}return{$raw:{}}}S.g.getComponentNameForNode=function(e){var t=S.a.A(e);if(S.g.ub(t)&&(-1!=t.indexOf("-")||"[object HTMLUnknownElement]"==""+e||8>=S.a.C&&e.tagName===t))return t},S.g.Pb=function(t,n,a,i){if(1===n.nodeType){var r=S.g.getComponentNameForNode(n);if(r){if((t=t||{}).component)throw Error('Cannot use the "component" binding on a custom element matching a component');var o={name:r,params:e(n,a)};t.component=i?function(){return o}:o}}return t};var t=new S.R;9>S.a.C&&(S.g.register=function(e){return function(t){return c.createElement(t),e.apply(this,arguments)}}(S.g.register),c.createDocumentFragment=function(e){return function(){var t,n=e(),a=S.g.Cc;for(t in a)a.hasOwnProperty(t)&&n.createElement(t);return n}}(c.createDocumentFragment))}(),function(e){var t=0;S.d.component={init:function(e,n,a,i,r){function o(){var e=s&&s.dispose;"function"==typeof e&&e.call(s),c=s=null}var s,c,d=S.a.W(S.e.childNodes(e));return S.a.F.oa(e,o),S.m(function(){var a,i,l=S.a.c(n());if("string"==typeof l?a=l:(a=S.a.c(l.name),i=S.a.c(l.params)),!a)throw Error("No component name specified");var u=c=++t;S.g.get(a,function(t){if(c===u){if(o(),!t)throw Error("Unknown component '"+a+"'");!function(e,t,n){if(!(t=t.template))throw Error("Component '"+e+"' has no template");e=S.a.ua(t),S.e.da(n,e)}(a,t,e);var n=function(e,t,n,a){var i=e.createViewModel;return i?i.call(e,a,{element:t,templateNodes:n}):a}(t,e,d,i);t=r.createChildContext(n,void 0,function(e){e.$component=n,e.$componentTemplateNodes=d}),s=n,S.Ka(t,e)}})},null,{i:e}),{controlsDescendantBindings:!0}}},S.e.V.component=!0}();var P={class:"className",for:"htmlFor"};S.d.attr={update:function(e,t){var n=S.a.c(t())||{};S.a.D(n,function(t,n){var a=!1===(n=S.a.c(n))||null===n||n===o;a&&e.removeAttribute(t),8>=S.a.C&&t in P?(t=P[t],a?e.removeAttribute(t):e[t]=n):a||e.setAttribute(t,n.toString()),"name"===t&&S.a.tc(e,a?"":n.toString())})}},S.d.checked={after:["value","attr"],init:function(e,t,n){function a(){var a=e.checked,r=f?i():a;if(!S.va.Ta()&&(!s||a)){var o=S.l.w(t);if(d){var c=l?o.t():o;u!==r?(a&&(S.a.pa(c,r,!0),S.a.pa(c,u,!1)),u=r):S.a.pa(c,r,a),l&&S.Ba(o)&&o(c)}else S.h.Ea(o,n,"checked",r,!0)}}var i=S.pc(function(){return n.has("checkedValue")?S.a.c(n.get("checkedValue")):n.has("value")?S.a.c(n.get("value")):e.value}),r="checkbox"==e.type,s="radio"==e.type;if(r||s){var c=t(),d=r&&S.a.c(c)instanceof Array,l=!(d&&c.push&&c.splice),u=d?i():o,f=s||d;s&&!e.name&&S.d.uniqueName.init(e,function(){return!0}),S.m(a,null,{i:e}),S.a.p(e,"click",a),S.m(function(){var n=S.a.c(t());e.checked=d?0<=S.a.o(n,i()):r?n:i()===n},null,{i:e}),c=o}}},S.h.ea.checked=!0,S.d.checkedValue={update:function(e,t){e.value=S.a.c(t())}},S.d.class={update:function(e,t){var n=S.a.ab(S.a.c(t()));S.a.cb(e,e.__ko__cssValue,!1),e.__ko__cssValue=n,S.a.cb(e,n,!0)}},S.d.css={update:function(e,t){var n=S.a.c(t());null!==n&&"object"==typeof n?S.a.D(n,function(t,n){n=S.a.c(n),S.a.cb(e,t,n)}):S.d.class.update(e,t)}},S.d.enable={update:function(e,t){var n=S.a.c(t());n&&e.disabled?e.removeAttribute("disabled"):n||e.disabled||(e.disabled=!0)}},S.d.disable={update:function(e,t){S.d.enable.update(e,function(){return!S.a.c(t())})}},S.d.event={init:function(e,t,n,a,i){var r=t()||{};S.a.D(r,function(r){"string"==typeof r&&S.a.p(e,r,function(e){var o,s=t()[r];if(s){try{var c=S.a.W(arguments);a=i.$data,c.unshift(a),o=s.apply(a,c)}finally{!0!==o&&(e.preventDefault?e.preventDefault():e.returnValue=!1)}!1===n.get(r+"Bubble")&&(e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation())}})})}},S.d.foreach={kc:function(e){return function(){var t=e(),n=S.a.zb(t);return n&&"number"!=typeof n.length?(S.a.c(t),{foreach:n.data,as:n.as,includeDestroyed:n.includeDestroyed,afterAdd:n.afterAdd,beforeRemove:n.beforeRemove,afterRender:n.afterRender,beforeMove:n.beforeMove,afterMove:n.afterMove,templateEngine:S.X.sb}):{foreach:t,templateEngine:S.X.sb}}},init:function(e,t){return S.d.template.init(e,S.d.foreach.kc(t))},update:function(e,t,n,a,i){return S.d.template.update(e,S.d.foreach.kc(t),n,a,i)}},S.h.ta.foreach=!1,S.e.V.foreach=!0,S.d.hasfocus={init:function(e,t,n){function a(a){e.__ko_hasfocusUpdating=!0;var i=e.ownerDocument;if("activeElement"in i){var r;try{r=i.activeElement}catch(e){r=i.body}a=r===e}i=t(),S.h.Ea(i,n,"hasfocus",a,!0),e.__ko_hasfocusLastValue=a,e.__ko_hasfocusUpdating=!1}var i=a.bind(null,!0),r=a.bind(null,!1);S.a.p(e,"focus",i),S.a.p(e,"focusin",i),S.a.p(e,"blur",r),S.a.p(e,"focusout",r)},update:function(e,t){var n=!!S.a.c(t());e.__ko_hasfocusUpdating||e.__ko_hasfocusLastValue===n||(n?e.focus():e.blur(),!n&&e.__ko_hasfocusLastValue&&e.ownerDocument.body.focus(),S.l.w(S.a.Da,null,[e,n?"focusin":"focusout"]))}},S.h.ea.hasfocus=!0,S.d.hasFocus=S.d.hasfocus,S.h.ea.hasFocus=!0,S.d.html={init:function(){return{controlsDescendantBindings:!0}},update:function(e,t){S.a.Cb(e,t())}},m("if"),m("ifnot",!1,!0),m("with",!0,!1,function(e,t){return e.Zb(t)}),S.d.let={init:function(e,t,n,a,i){return t=i.extend(t),S.Ka(t,e),{controlsDescendantBindings:!0}}},S.e.V.let=!0;var T={};S.d.options={init:function(e){if("select"!==S.a.A(e))throw Error("options binding applies only to SELECT elements");for(;0<e.length;)e.remove(0);return{controlsDescendantBindings:!0}},update:function(e,t,n){function a(){return S.a.La(e.options,function(e){return e.selected})}function i(e,t,n){var a=typeof t;return"function"==a?t(e):"string"==a?e[t]:n}function r(t,a){if(m&&l)S.j.ha(e,S.a.c(n.get("value")),!0);else if(p.length){var i=0<=S.a.o(p,S.j.u(a[0]));S.a.uc(a[0],i),m&&!i&&S.l.w(S.a.Da,null,[e,"change"])}}var s=e.multiple,c=0!=e.length&&s?e.scrollTop:null,d=S.a.c(t()),l=n.get("valueAllowUnset")&&n.has("value"),u=n.get("optionsIncludeDestroyed");t={};var f,p=[];l||(s?p=S.a.fb(a(),S.j.u):0<=e.selectedIndex&&p.push(S.j.u(e.options[e.selectedIndex]))),d&&(void 0===d.length&&(d=[d]),f=S.a.La(d,function(e){return u||e===o||null===e||!S.a.c(e._destroy)}),n.has("optionsCaption")&&null!==(d=S.a.c(n.get("optionsCaption")))&&d!==o&&f.unshift(T));var m=!1;t.beforeRemove=function(t){e.removeChild(t)},d=r,n.has("optionsAfterRender")&&"function"==typeof n.get("optionsAfterRender")&&(d=function(e,t){r(0,t),S.l.w(n.get("optionsAfterRender"),null,[t[0],e!==T?e:o])}),S.a.Bb(e,f,function(t,a,r){return r.length&&(p=!l&&r[0].selected?[S.j.u(r[0])]:[],m=!0),a=e.ownerDocument.createElement("option"),t===T?(S.a.$a(a,n.get("optionsCaption")),S.j.ha(a,o)):(r=i(t,n.get("optionsValue"),t),S.j.ha(a,S.a.c(r)),t=i(t,n.get("optionsText"),r),S.a.$a(a,t)),[a]},t,d),S.l.w(function(){l?S.j.ha(e,S.a.c(n.get("value")),!0):(s?p.length&&a().length<p.length:p.length&&0<=e.selectedIndex?S.j.u(e.options[e.selectedIndex])!==p[0]:p.length||0<=e.selectedIndex)&&S.a.Da(e,"change")}),S.a.Oc(e),c&&20<Math.abs(c-e.scrollTop)&&(e.scrollTop=c)}},S.d.options.xb=S.a.f.I(),S.d.selectedOptions={after:["options","foreach"],init:function(e,t,n){S.a.p(e,"change",function(){var a=t(),i=[];S.a.q(e.getElementsByTagName("option"),function(e){e.selected&&i.push(S.j.u(e))}),S.h.Ea(a,n,"selectedOptions",i)})},update:function(e,t){if("select"!=S.a.A(e))throw Error("values binding applies only to SELECT elements");var n=S.a.c(t()),a=e.scrollTop;n&&"number"==typeof n.length&&S.a.q(e.getElementsByTagName("option"),function(e){var t=0<=S.a.o(n,S.j.u(e));e.selected!=t&&S.a.uc(e,t)}),e.scrollTop=a}},S.h.ea.selectedOptions=!0,S.d.style={update:function(e,t){var n=S.a.c(t()||{});S.a.D(n,function(t,n){null!==(n=S.a.c(n))&&n!==o&&!1!==n||(n=""),e.style[t]=n})}},S.d.submit={init:function(e,t,n,a,i){if("function"!=typeof t())throw Error("The value for a submit binding must be a function");S.a.p(e,"submit",function(n){var a,r=t();try{a=r.call(i.$data,e)}finally{!0!==a&&(n.preventDefault?n.preventDefault():n.returnValue=!1)}})}},S.d.text={init:function(){return{controlsDescendantBindings:!0}},update:function(e,t){S.a.$a(e,t())}},S.e.V.text=!0,function(){if(s&&s.navigator)var e=function(e){if(e)return parseFloat(e[1])},t=s.opera&&s.opera.version&&parseInt(s.opera.version()),n=s.navigator.userAgent,a=e(n.match(/^(?:(?!chrome).)*version\/([^ ]*) safari/i)),i=e(n.match(/Firefox\/([^ ]*)/));if(10>S.a.C)var r=S.a.f.I(),c=S.a.f.I(),d=function(e){var t=this.activeElement;(t=t&&S.a.f.get(t,c))&&t(e)},l=function(e,t){var n=e.ownerDocument;S.a.f.get(n,r)||(S.a.f.set(n,r,!0),S.a.p(n,"selectionchange",d)),S.a.f.set(e,c,t)};S.d.textInput={init:function(e,n,r){function s(t,n){S.a.p(e,t,n)}function c(){u||(f=e.value,u=S.a.setTimeout(d,4))}function d(){clearTimeout(u),f=u=o;var t=e.value;p!==t&&(p=t,S.h.Ea(n(),r,"textInput",t))}var u,f,p=e.value,m=9==S.a.C?c:d;10>S.a.C?(s("propertychange",function(e){"value"===e.propertyName&&m(e)}),8==S.a.C&&(s("keyup",d),s("keydown",d)),8<=S.a.C&&(l(e,m),s("dragend",c))):(s("input",d),5>a&&"textarea"===S.a.A(e)?(s("keydown",c),s("paste",c),s("cut",c)):11>t?s("keydown",c):4>i&&(s("DOMAutoComplete",d),s("dragdrop",d),s("drop",d))),s("change",d),S.m(function t(){var a=S.a.c(n());null!==a&&a!==o||(a=""),f!==o&&a===f?S.a.setTimeout(t,4):e.value!==a&&(p=a,e.value=a)},null,{i:e})}},S.h.ea.textInput=!0,S.d.textinput={preprocess:function(e,t,n){n("textInput",e)}}}(),S.d.uniqueName={init:function(e,t){if(t()){var n="ko_unique_"+ ++S.d.uniqueName.Jc;S.a.tc(e,n)}}},S.d.uniqueName.Jc=0,S.d.value={after:["options","foreach"],init:function(e,t,n){if("input"!=e.tagName.toLowerCase()||"checkbox"!=e.type&&"radio"!=e.type){var a=["change"],i=n.get("valueUpdate"),r=!1,o=null;i&&("string"==typeof i&&(i=[i]),S.a.ra(a,i),a=S.a.Ub(a));var s=function(){o=null,r=!1;var a=t(),i=S.j.u(e);S.h.Ea(a,n,"value",i)};!S.a.C||"input"!=e.tagName.toLowerCase()||"text"!=e.type||"off"==e.autocomplete||e.form&&"off"==e.form.autocomplete||-1!=S.a.o(a,"propertychange")||(S.a.p(e,"propertychange",function(){r=!0}),S.a.p(e,"focus",function(){r=!1}),S.a.p(e,"blur",function(){r&&s()})),S.a.q(a,function(t){var n=s;S.a.od(t,"after")&&(n=function(){o=S.j.u(e),S.a.setTimeout(s,0)},t=t.substring(5)),S.a.p(e,t,n)});var c=function(){var a=S.a.c(t()),i=S.j.u(e);if(null!==o&&a===o)S.a.setTimeout(c,0);else if(a!==i)if("select"===S.a.A(e)){var r=n.get("valueAllowUnset");(i=function(){S.j.ha(e,a,r)})(),r||a===S.j.u(e)?S.a.setTimeout(i,0):S.l.w(S.a.Da,null,[e,"change"])}else S.j.ha(e,a)};S.m(c,null,{i:e})}else S.Ja(e,{checkedValue:t})},update:function(){}},S.h.ea.value=!0,S.d.visible={update:function(e,t){var n=S.a.c(t()),a="none"!=e.style.display;n&&!a?e.style.display="":!n&&a&&(e.style.display="none")}},function(e){S.d[e]={init:function(t,n,a,i,r){return S.d.event.init.call(this,t,function(){var t={};return t[e]=n(),t},a,i,r)}}}("click"),S.O=function(){},S.O.prototype.renderTemplateSource=function(){throw Error("Override renderTemplateSource")},S.O.prototype.createJavaScriptEvaluatorBlock=function(){throw Error("Override createJavaScriptEvaluatorBlock")},S.O.prototype.makeTemplateSource=function(e,t){if("string"==typeof e){var n=(t=t||c).getElementById(e);if(!n)throw Error("Cannot find template with ID "+e);return new S.v.n(n)}if(1==e.nodeType||8==e.nodeType)return new S.v.qa(e);throw Error("Unknown template type: "+e)},S.O.prototype.renderTemplate=function(e,t,n,a){return e=this.makeTemplateSource(e,a),this.renderTemplateSource(e,t,n,a)},S.O.prototype.isTemplateRewritten=function(e,t){return!1===this.allowTemplateRewriting||this.makeTemplateSource(e,t).data("isRewritten")},S.O.prototype.rewriteTemplate=function(e,t,n){t=t((e=this.makeTemplateSource(e,n)).text()),e.text(t),e.data("isRewritten",!0)},S.b("templateEngine",S.O),S.Gb=function(){function e(e,t,n,a){e=S.h.yb(e);for(var i=S.h.ta,r=0;r<e.length;r++){var o=e[r].key;if(i.hasOwnProperty(o)){var s=i[o];if("function"==typeof s){if(o=s(e[r].value))throw Error(o)}else if(!s)throw Error("This template engine does not support the '"+o+"' binding within its templates")}}return n="ko.__tr_ambtns(function($context,$element){return(function(){return{ "+S.h.Va(e,{valueAccessors:!0})+" } })()},'"+n.toLowerCase()+"')",a.createJavaScriptEvaluatorBlock(n)+t}var t=/(<([a-z]+\d*)(?:\s+(?!data-bind\s*=\s*)[a-z0-9\-]+(?:=(?:\"[^\"]*\"|\'[^\']*\'|[^>]*))?)*\s+)data-bind\s*=\s*(["'])([\s\S]*?)\3/gi,n=/\x3c!--\s*ko\b\s*([\s\S]*?)\s*--\x3e/g;return{Pc:function(e,t,n){t.isTemplateRewritten(e,n)||t.rewriteTemplate(e,function(e){return S.Gb.ed(e,t)},n)},ed:function(a,i){return a.replace(t,function(t,n,a,r,o){return e(o,n,a,i)}).replace(n,function(t,n){return e(n,"\x3c!-- ko --\x3e","#comment",i)})},Fc:function(e,t){return S.M.wb(function(n,a){var i=n.nextSibling;i&&i.nodeName.toLowerCase()===t&&S.Ja(i,e,a)})}}}(),S.b("__tr_ambtns",S.Gb.Fc),function(){S.v={},S.v.n=function(e){if(this.n=e){var t=S.a.A(e);this.bb="script"===t?1:"textarea"===t?2:"template"==t&&e.content&&11===e.content.nodeType?3:4}},S.v.n.prototype.text=function(){var e=1===this.bb?"text":2===this.bb?"value":"innerHTML";if(0==arguments.length)return this.n[e];var t=arguments[0];"innerHTML"===e?S.a.Cb(this.n,t):this.n[e]=t};var e=S.a.f.I()+"_";S.v.n.prototype.data=function(t){if(1===arguments.length)return S.a.f.get(this.n,e+t);S.a.f.set(this.n,e+t,arguments[1])};var t=S.a.f.I();S.v.n.prototype.nodes=function(){var e=this.n;if(0==arguments.length)return(S.a.f.get(e,t)||{}).jb||(3===this.bb?e.content:4===this.bb?e:o);S.a.f.set(e,t,{jb:arguments[0]})},S.v.qa=function(e){this.n=e},S.v.qa.prototype=new S.v.n,S.v.qa.prototype.text=function(){if(0==arguments.length){var e=S.a.f.get(this.n,t)||{};return e.Hb===o&&e.jb&&(e.Hb=e.jb.innerHTML),e.Hb}S.a.f.set(this.n,t,{Hb:arguments[0]})},S.b("templateSources",S.v),S.b("templateSources.domElement",S.v.n),S.b("templateSources.anonymousTemplate",S.v.qa)}(),function(){function e(e,t,n){var a;for(t=S.e.nextSibling(t);e&&(a=e)!==t;)n(a,e=S.e.nextSibling(a))}function t(t,n){if(t.length){var a=t[0],i=t[t.length-1],r=a.parentNode,o=S.R.instance,s=o.preprocessNode;if(s){if(e(a,i,function(e,t){var n=e.previousSibling,r=s.call(o,e);r&&(e===a&&(a=r[0]||t),e===i&&(i=r[r.length-1]||n))}),t.length=0,!a)return;a===i?t.push(a):(t.push(a,i),S.a.za(t,r))}e(a,i,function(e){1!==e.nodeType&&8!==e.nodeType||S.Sb(n,e)}),e(a,i,function(e){1!==e.nodeType&&8!==e.nodeType||S.M.Ac(e,[n])}),S.a.za(t,r)}}function n(e){return e.nodeType?e:0<e.length?e[0]:null}function a(e,a,i,o,s){s=s||{};var c=(e&&n(e)||i||{}).ownerDocument,d=s.templateEngine||r;if(S.Gb.Pc(i,d,c),"number"!=typeof(i=d.renderTemplate(i,o,s,c)).length||0<i.length&&"number"!=typeof i[0].nodeType)throw Error("Template engine must return an array of DOM nodes");switch(c=!1,a){case"replaceChildren":S.e.da(e,i),c=!0;break;case"replaceNode":S.a.sc(e,i),c=!0;break;case"ignoreTargetNode":break;default:throw Error("Unknown renderMode: "+a)}return c&&(t(i,o),s.afterRender&&S.l.w(s.afterRender,null,[i,o.$data])),i}function i(e,t,n){return S.H(e)?e():"function"==typeof e?e(t,n):e}var r;S.Db=function(e){if(e!=o&&!(e instanceof S.O))throw Error("templateEngine must inherit from ko.templateEngine");r=e},S.Ab=function(e,t,s,c,d){if(((s=s||{}).templateEngine||r)==o)throw Error("Set a template engine before calling renderTemplate");if(d=d||"replaceChildren",c){var l=n(c);return S.B(function(){var r=t&&t instanceof S.Q?t:new S.Q(t,null,null,null,{exportDependencies:!0}),o=i(e,r.$data,r);r=a(c,d,o,r,s),"replaceNode"==d&&(l=n(c=r))},null,{wa:function(){return!l||!S.a.nb(l)},i:l&&"replaceNode"==d?l.parentNode:l})}return S.M.wb(function(n){S.Ab(e,t,s,n,"replaceNode")})},S.ld=function(e,n,r,s,c){function d(e,n){t(n,u),r.afterRender&&r.afterRender(n,e),u=null}function l(t,n){return u=c.createChildContext(t,r.as,function(e){e.$index=n}),a(null,"ignoreTargetNode",i(e,t,u),u,r)}var u;return S.B(function(){var e=S.a.c(n)||[];void 0===e.length&&(e=[e]),e=S.a.La(e,function(e){return r.includeDestroyed||e===o||null===e||!S.a.c(e._destroy)}),S.l.w(S.a.Bb,null,[s,e,l,r,d])},null,{i:s})};var s=S.a.f.I();S.d.template={init:function(e,t){var n=S.a.c(t());if("string"==typeof n||n.name)S.e.xa(e);else{if("nodes"in n){if(n=n.nodes||[],S.H(n))throw Error('The "nodes" option must be a plain, non-observable array.')}else n=S.e.childNodes(e);n=S.a.lc(n),new S.v.qa(e).nodes(n)}return{controlsDescendantBindings:!0}},update:function(e,t,n,a,i){var r=t();n=!0,a=null,"string"==typeof(t=S.a.c(r))?t={}:(r=t.name,"if"in t&&(n=S.a.c(t.if)),n&&"ifnot"in t&&(n=!S.a.c(t.ifnot))),"foreach"in t?a=S.ld(r||e,n&&t.foreach||[],t,e,i):n?(i="data"in t?i.Zb(t.data,t.as):i,a=S.Ab(r||e,i,t,e)):S.e.xa(e),i=a,(t=S.a.f.get(e,s))&&"function"==typeof t.k&&t.k(),S.a.f.set(e,s,i&&i.ba()?i:o)}},S.h.ta.template=function(e){return 1==(e=S.h.yb(e)).length&&e[0].unknown||S.h.bd(e,"name")?null:"This template engine does not support anonymous templates nested within its templates"},S.e.V.template=!0}(),S.b("setTemplateEngine",S.Db),S.b("renderTemplate",S.Ab),S.a.fc=function(e,t,n){var a,i,r,o,s;if(e.length&&t.length)for(a=i=0;(!n||a<n)&&(o=e[i]);++i){for(r=0;s=t[r];++r)if(o.value===s.value){o.moved=s.index,s.moved=o.index,t.splice(r,1),a=r=0;break}a+=r}},S.a.ib=function(){function e(e,t,n,a,i){var r,o,s,c,d,l=Math.min,u=Math.max,f=[],p=e.length,m=t.length,_=m-p||1,h=p+m+1;for(r=0;r<=p;r++)for(c=s,f.push(s=[]),d=l(m,r+_),o=u(0,r-1);o<=d;o++)s[o]=o?r?e[r-1]===t[o-1]?c[o-1]:l(c[o]||h,s[o-1]||h)+1:o+1:r+1;for(l=[],u=[],_=[],r=p,o=m;r||o;)m=f[r][o]-1,o&&m===f[r][o-1]?u.push(l[l.length]={status:n,value:t[--o],index:o}):r&&m===f[r-1][o]?_.push(l[l.length]={status:a,value:e[--r],index:r}):(--o,--r,i.sparse||l.push({status:"retained",value:t[o]}));return S.a.fc(_,u,!i.dontLimitMoves&&10*p),l.reverse()}return function(t,n,a){return a="boolean"==typeof a?{dontLimitMoves:a}:a||{},n=n||[],(t=t||[]).length<n.length?e(t,n,"added","deleted",a):e(n,t,"deleted","added",a)}}(),S.b("utils.compareArrays",S.a.ib),function(){function e(e,t,n,a,i){var r=[],s=S.B(function(){var o=t(n,i,S.a.za(r,e))||[];0<r.length&&(S.a.sc(r,o),a&&S.l.w(a,null,[n,o,i])),r.length=0,S.a.ra(r,o)},null,{i:e,wa:function(){return!S.a.Rb(r)}});return{ca:r,B:s.ba()?s:o}}var t=S.a.f.I(),n=S.a.f.I();S.a.Bb=function(a,i,r,s,c){function d(e,t){D=p[t],g!==t&&(C[e]=D),D.qb(g++),S.a.za(D.ca,a),h.push(D),y.push(D)}function l(e,t){if(e)for(var n=0,a=t.length;n<a;n++)t[n]&&S.a.q(t[n].ca,function(a){e(a,n,t[n].ja)})}i=i||[],s=s||{};var u,f=S.a.f.get(a,t)===o,p=S.a.f.get(a,t)||[],m=S.a.fb(p,function(e){return e.ja}),_=S.a.ib(m,i,s.dontLimitMoves),h=[],b=0,g=0,v=[],y=[];i=[];for(var D,I,x,C=[],O=(m=[],0);I=_[O];O++)switch(x=I.moved,I.status){case"deleted":x===o&&((D=p[b]).B&&(D.B.k(),D.B=o),S.a.za(D.ca,a).length&&(s.beforeRemove&&(h.push(D),y.push(D),D.ja===n?D=null:i[O]=D),D&&v.push.apply(v,D.ca))),b++;break;case"retained":d(O,b++);break;case"added":x!==o?d(O,x):(D={ja:I.value,qb:S.N(g++)},h.push(D),y.push(D),f||(m[O]=D))}for(S.a.f.set(a,t,h),l(s.beforeMove,C),S.a.q(v,s.beforeRemove?S.$:S.removeNode),O=0,f=S.e.firstChild(a);D=y[O];O++){for(D.ca||S.a.extend(D,e(a,r,D.ja,c,D.qb)),b=0;_=D.ca[b];f=_.nextSibling,u=_,b++)_!==f&&S.e.ic(a,_,u);!D.Xc&&c&&(c(D.ja,D.ca,D.qb),D.Xc=!0)}for(l(s.beforeRemove,i),O=0;O<i.length;++O)i[O]&&(i[O].ja=n);l(s.afterMove,C),l(s.afterAdd,m)}}(),S.b("utils.setDomNodeChildrenFromArrayMapping",S.a.Bb),S.X=function(){this.allowTemplateRewriting=!1},S.X.prototype=new S.O,S.X.prototype.renderTemplateSource=function(e,t,n,a){return(t=9>S.a.C||!e.nodes?null:e.nodes())?S.a.W(t.cloneNode(!0).childNodes):(e=e.text(),S.a.ma(e,a))},S.X.sb=new S.X,S.Db(S.X.sb),S.b("nativeTemplateEngine",S.X),function(){S.vb=function(){var e=this.ad=function(){if(!l||!l.tmpl)return 0;try{if(0<=l.tmpl.tag.tmpl.open.toString().indexOf("__"))return 2}catch(e){}return 1}();this.renderTemplateSource=function(t,n,a,i){if(i=i||c,a=a||{},2>e)throw Error("Your version of jQuery.tmpl is too old. Please upgrade to jQuery.tmpl 1.0.0pre or later.");var r=t.data("precompiled");return r||(r=t.text()||"",r=l.template(null,"{{ko_with $item.koBindingContext}}"+r+"{{/ko_with}}"),t.data("precompiled",r)),t=[n.$data],n=l.extend({koBindingContext:n},a.templateOptions),(n=l.tmpl(r,t,n)).appendTo(i.createElement("div")),l.fragments={},n},this.createJavaScriptEvaluatorBlock=function(e){return"{{ko_code ((function() { return "+e+" })()) }}"},this.addTemplate=function(e,t){c.write("<script type='text/html' id='"+e+"'>"+t+"<\/script>")},0<e&&(l.tmpl.tag.ko_code={open:"__.push($1 || '');"},l.tmpl.tag.ko_with={open:"with($1) {",close:"} "})},S.vb.prototype=new S.O;var e=new S.vb;0<e.ad&&S.Db(e),S.b("jqueryTmplTemplateEngine",S.vb)}()})}()},1295:function(e,t,n){"use strict";n.d(t,"t",function(){return u}),n.d(t,"i",function(){return f}),n.d(t,"a",function(){return p}),n.d(t,"e",function(){return _});var a=n(0),i=n(13),r=n(490),o=n(190),s=n(191),c=n(1357),d=n(808),l="@ms/odsp-shared/lib/base/BaseModel",u=new i.t({name:"".concat(l,".asyncType"),factory:new i.e(s.e)}),f=new i.t({name:"".concat(l,".observablesFactoryType"),factory:new r.a(c.e,{asyncType:u.optional})}),p=new i.t({name:"".concat(l,".eventGroupType"),factory:new i.e(o.t)}),m=new i.t({name:"".concat(l,".errorHandler")}),_=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this,i=t.id,r=void 0===i?"":i;return a.id=r,a._BaseModel_dependencies=n,a}return Object(a.__extends)(t,e),Object.defineProperty(t.prototype,"async",{get:function(){return this._BaseModel_getAsync()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"events",{get:function(){return this._BaseModel_getEvents()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"observables",{get:function(){return this._BaseModel_getObservables()},enumerable:!1,configurable:!0}),t.prototype.subscribe=function(e,t,n){return this.observables.subscribe(e,t,{isBeforeChange:n})},t.prototype.createComputed=function(e,t){return this.observables.compute(e,t)},t.prototype.createPureComputed=function(e,t){return this.observables.pureCompute(e,t)},t.prototype.createBackgroundComputed=function(e,t){return this.observables.backgroundCompute(e,t)},t.prototype.addDisposable=function(e){return this.scope.attach(e)},t.prototype.trackPromise=function(e){var t=!1,n=this.scope.attach({dispose:function(){!t&&e.cancel&&e.cancel()}}),a=function(){t=!0,n.dispose()};return e.done(a,a),e},t.prototype.wrapObservable=function(e){return this.observables.wrap(e)},t.prototype.peekUnwrapObservable=function(e){return Object(c.a)(e)},t.prototype.createObservable=function(e){return this.observables.create(e)},t.prototype.unwrapObservable=function(e){return Object(c.i)(e)},t.prototype.isObservable=function(e){return Object(c.n)(e)},t.prototype._BaseModel_getAsync=function(){var e=new(this.scope.attached(this._BaseModel_getAsyncType()))(this,this._BaseModel_getErrorHandler());return this._BaseModel_getAsync=function(){return e},e},t.prototype._BaseModel_getEvents=function(){var e=new(this.scope.attached(this._BaseModel_getEventGroupType()))(this,this._BaseModel_getErrorHandler());return this._BaseModel_getEvents=function(){return e},e},t.prototype._BaseModel_getObservables=function(){var e=new(this.scope.attached(this._BaseModel_getObservablesFactoryType()))({owner:this});return this._BaseModel_getObservables=function(){return e},e},t.prototype._BaseModel_getAsyncType=function(){return this._BaseModel_dependencies.asyncType||this.resources&&this.resources.consume(u.optional)||s.e},t.prototype._BaseModel_getEventGroupType=function(){return this._BaseModel_dependencies.eventGroupType||this.resources&&this.resources.consume(p.optional)||o.t},t.prototype._BaseModel_getObservablesFactoryType=function(){return this._BaseModel_dependencies.observablesFactoryType||this.resources&&(this.resources.consume(f.optional)||Object(i.i)(c.e,{asyncType:this._BaseModel_getAsyncType()}))||c.e},t.prototype._BaseModel_getErrorHandler=function(){return this._BaseModel_dependencies.errorHandler||this.resources&&this.resources.consume(m.optional)},t.dependencies=Object(a.__assign)(Object(a.__assign)({},d.e.dependencies),{asyncType:u.optional,observablesFactoryType:f.optional,eventGroupType:p.optional,errorHandler:m.optional}),t}(d.e);t.n=_},1297:function(e,t,n){"use strict";n.d(t,"r",function(){return i}),n.d(t,"o",function(){return r}),n.d(t,"b",function(){return o}),n.d(t,"_",function(){return s}),n.d(t,"h",function(){return c}),n.d(t,"i",function(){return d}),n.d(t,"F",function(){return l}),n.d(t,"L",function(){return u}),n.d(t,"w",function(){return f}),n.d(t,"M",function(){return p}),n.d(t,"t",function(){return m}),n.d(t,"e",function(){return _}),n.d(t,"P",function(){return h}),n.d(t,"y",function(){return b}),n.d(t,"a",function(){return g}),n.d(t,"k",function(){return v}),n.d(t,"s",function(){return y}),n.d(t,"c",function(){return S}),n.d(t,"T",function(){return D}),n.d(t,"f",function(){return I}),n.d(t,"p",function(){return x}),n.d(t,"U",function(){return C}),n.d(t,"d",function(){return O}),n.d(t,"I",function(){return w}),n.d(t,"D",function(){return E}),n.d(t,"x",function(){return A}),n.d(t,"S",function(){return L}),n.d(t,"O",function(){return k}),n.d(t,"v",function(){return M}),n.d(t,"n",function(){return P}),n.d(t,"m",function(){return T}),n.d(t,"C",function(){return U}),n.d(t,"u",function(){return F}),n.d(t,"g",function(){return H}),n.d(t,"A",function(){return R}),n.d(t,"E",function(){return N}),n.d(t,"l",function(){return B});var a=n(13),i=new a.t("currentItem"),r=new a.t("currentItemSet"),o=new a.t("groupThrottle"),s=new a.t("focusItem"),c=new a.t("focusItemSet"),d=new a.t("dataManagerMapper"),l=new a.t("viewParams"),u=new a.t("originalViewParams"),f=new a.t("itemsSelection"),p=new a.t("selectionIndexResolver"),m=new a.t("autoFillParams"),_=new a.t("actionMap"),h=new a.t("slideshowState"),b=new a.t("isDebugWindowVisible"),g=new a.t("canUserSelect"),v=new a.t("promiseTracker"),y=new a.t("currentPage"),S=new a.t("currentSelectionModelGroup"),D=new a.t("useMobileList"),I=new a.t("disableDotDotDotHeroCommand"),x=new a.t("disableShareHeroCommand"),C=(new a.t("uploadActionHandler"),new a.t("vaultTeachingBubble")),O=new a.t("currentView"),w=(new a.t("backToClassicUrl"),new a.t("isItemSetRendered")),E=new a.t("isGuidedTourVisible"),A=new a.t("isPremiumUpsellVisible"),L=new a.t("isFamiliesOrGroupsFreVisible"),k=new a.t("isVaultFreVisible"),M=new a.t("hasUpsellBeenShownAlready"),P=new a.t("canModifySchema"),T=new a.t("displayImageTileNames"),U=new a.t("isSharingSectionExpanded"),F=new a.t("didUserUploadOrCreateFile"),H=(new a.t("didUserCreateOfficeFile"),new a.t("hasSeenPositioningThisSession")),R=new a.t("mobileUpsellDismissedThisSession"),N=new a.t("mobileOfficeAppUpsellDismissedThisSession"),B=new a.t("didUserEnterPasswordForFile")},1302:function(e,t,n){"use strict";n.d(t,"O",function(){return i}),n.d(t,"p",function(){return r}),n.d(t,"s",function(){return o}),n.d(t,"k",function(){return s}),n.d(t,"w",function(){return c}),n.d(t,"m",function(){return d}),n.d(t,"u",function(){return l}),n.d(t,"f",function(){return u}),n.d(t,"c",function(){return f}),n.d(t,"E",function(){return p}),n.d(t,"r",function(){return m}),n.d(t,"a",function(){return _}),n.d(t,"I",function(){return h}),n.d(t,"x",function(){return b}),n.d(t,"C",function(){return g}),n.d(t,"t",function(){return v}),n.d(t,"A",function(){return y}),n.d(t,"i",function(){return S}),n.d(t,"d",function(){return D}),n.d(t,"e",function(){return I}),n.d(t,"L",function(){return x}),n.d(t,"b",function(){return C}),n.d(t,"h",function(){return O}),n.d(t,"v",function(){return w}),n.d(t,"y",function(){return E}),n.d(t,"g",function(){return A}),n.d(t,"o",function(){return L}),n.d(t,"n",function(){return k}),n.d(t,"S",function(){return M}),n.d(t,"_",function(){return P}),n.d(t,"l",function(){return T}),n.d(t,"D",function(){return U});var a=n(13),i=new a.t("provider.suiteNavBasic"),r=(new a.t("provider.suiteNav"),new a.t("provider.peopleCard")),o=(new a.t("provider.shareByLink"),new a.t("provider.groups"),new a.t("provider.groupSiteProvider"),new a.t("provider.groupsAsync")),s=(new a.t("provider.groupsLeftNav"),new a.t("provider.publishingSiteProvider"),new a.t("provider.spSiteProvider"),new a.t("provider.classicSiteProvider"),new a.t("provider.userInfo")),c=new a.t("provider.tag"),d=new a.t("provider.photo"),l=new a.t("provider.notification"),u=new a.t("provider.notificationManager"),f=new a.t("provider.instrumentation"),p=new a.t("provider.teachingBubble"),m=new a.t("provider.feedback"),_=new a.t("provider.embed"),h=new a.t("provider.storageInfo"),b=new a.t("provider.storageOptions"),g=new a.t("provider.subscriptions"),v=new a.t("provider.customAction"),y=(new a.t("provider.taxonomy"),new a.t("provider.thumbnail")),S=(new a.t("provider.appsItem"),new a.t("provider.externallySharedItem")),D=(new a.t("provider.popularItem"),new a.t("provider.mostViewsItem"),new a.t("provider.mostViewersItem"),new a.t("provider.subsiteItem"),new a.t("provider.itemHistory")),I=(new a.t("provider.spotlight"),new a.t("provider.error"),new a.t("provider.publish"),new a.t("provider.bundleLoader")),x=new a.t("provider.upsell"),C=new a.t("provider.profile"),O=new a.t("provider.processFilters"),w=new a.t("provider.userState"),E=new a.t("provider.ransomwareDetection"),A=new a.t("provider.promotedPhotos"),L=(new a.t("provider.site"),new a.t("provider.graphToken")),k=new a.t("provider.dragAndDropRobot"),M=new a.t("provider.recycleBin"),P=new a.t("provider.premiumState"),T=new a.t("provider.mruRecent"),U=(new a.t("provider.userExpiration"),new a.t("provider.siteScriptProgress"),new a.t("provider.requestReview"))},1312:function(e,t,n){"use strict";var a=n(0),i=n(852),r=function(e){function t(t,n){return e.call(this,t,n)||this}return Object(a.__extends)(t,e),t}(function(){function e(e,t){this.value=e,this.extraClasses=t}return e.prototype.getClass=function(){var e=this.value?Object(i.e)(this.value):void 0;return"ms-Icon ms-Icon--".concat(this.value," ").concat(e||"").concat(this.extraClasses?" "+this.extraClasses:"")},e.prototype.getExtraClasses=function(){return this.extraClasses},e.prototype.toString=function(){return this.value},e}());t.e=r},1314:function(e,t,n){"use strict";n.r(t),n.d(t,"encodeItemSetParentKeyKey",function(){return M}),n.d(t,"resourceKey",function(){return T});var a=n(0),i=(n(1382),n(1295)),r=n(1462),o=n(1437),s=n(1324),c=n(242),d=n(1297),l=n(302),u=n(1736),f=n(1370),p=n(1479),m=n(1359),_=n(1691),h=n(1692),b=n(1778),g=n(1023),v=n(13),y=n(490),S=n(1438),D=n(376),I=n(1546),x=n(1293),C="__next__",O=function(){function e(e,t,n,a){this._context=e,this._store=t,this._isTokenBaseApi=n,this._tokenBasedExtraItemCount=a}return e.prototype.initialize=function(e,t){if(this._skipDataFetch=!1,!this._context.group&&this._context.noIndexBasedDataFetch){var n=e&&e.content.peek().groupings,a=n&&n.length&&n[0].itemGroups;this._context.group=this._getGroupStartingOnIndex(t,a)}e&&e.isExpired&&(this._context.group=null),this._isExpandingGroup=this._context.noIndexBasedDataFetch&&this._context.group&&this._context.group.groupingId!==C&&!this._context.groupReplace,this._isFetchingNextGroup=this._context.group&&this._isTokenBaseApi&&this._context.group.groupingId===C;var i=e&&e.content.peek().groupings;this._isAllCollapsedQuery=i&&i.length>0&&i[0].isAllCollapsed&&i[0].isAllCollapsed.peek()&&!this._isExpandingGroup},e.prototype.isResultSetValid=function(e,t){var n=this._skipDataFetch;return n||(n=this._isAllCollapsedQuery?!this._isExpandingGroup&&!this._context.requestToken:(this._isTokenBaseApi||!this._context.skipInMemoryCache)&&b.e(e,t)&&!(this._isFetchingNextGroup&&this._context.endIndex>e.length)),n},e.prototype.computeNewChildren=function(e,t,n,a,i){var r,o=!1;if(this._context.groupReplace&&(this._isFetchingNextGroup=!!e.nextRequestToken),r=i&&!n.isExpired?n.content.peek().items:[],e.nextRequestToken?(!t.requestToken&&r.length>e.totalChildren&&(r[e.totalChildren]=null),e.totalChildren+=this._tokenBasedExtraItemCount,this._store.setNextRequestToken(t.parentKey,a,e.nextRequestToken),o=!0,n&&(n.isTokenBasedApi=o)):this._store.setNextRequestToken(t.parentKey,a,"end"),t.requestToken&&(t.startIndex=r.length-this._tokenBasedExtraItemCount,e.totalChildren+=r.length-this._tokenBasedExtraItemCount),this._isFetchingNextGroup||this._isAllCollapsedQuery){var s=e.children.length,c=e.startIndex+s;e.nextRequestToken&&(c+=this._tokenBasedExtraItemCount),e.totalChildren=Math.max(e.totalChildren,Math.max(r.length,c))}if(e.item&&e.totalChildren>=0){var d;this._isExpandingGroup||(r.length>0&&0===e.totalChildren?r=[]:r.length=e.totalChildren),d=t.groupReplace?t.startIndex:void 0!==e.startIndex?e.startIndex:this._isExpandingGroup?t.group.startIndex:t.startIndex;for(var l=0,u=0;l<r.length;l++)l>=d&&u<e.children.length&&(r[l]=this._store.getItem(e.children[u].key),(t.remoteItem||t.isMountPointFolder)&&(r[l].peek().isMountPointFolder=!0,r[l].peek().remoteWebUrl=t.isMountPointFolder?t.remoteWebUrl:t.remoteItem.SiteUrl),u++)}return{allChildren:r,hasNextRequestToken:o}},e.prototype.computeNewGroupings=function(e,t,n,a,i){var r=this._isExpandingGroup?a.group:null,o=a.itemsPerGroup,s=e&&e.length>0?e[0].itemGroups:null,c=null;s&&s.length>0&&s[s.length-1].isPlaceholder&&(c=s.pop());var d=this._mergeGroupings(e,t,i,n);if(r&&d&&(d[0].isAllCollapsed(!1),r.state({isCollapsed:!1})),n&&n.length>0&&!n[n.length-1]&&(s=d&&d.length>0?d[0].itemGroups:null)&&s.length>0){var l=s[s.length-1];this._context.groupReplace&&this._isFetchingNextGroup&&(l.hasMoreData=!0);var u=n[l.startIndex+(-1!==o?Math.min(l.count,o):l.count)-1]&&!(this._context.groupReplace&&l.count<o),f=d[0].isAllCollapsed.peek();if(u||this._isFetchingNextGroup||f){var p=l.startIndex+l.count;c?c.startIndex=p:c={groupingId:C,startIndex:p,count:1,isPlaceholder:!0,state:x.observable({isCollapsed:!1})},n.length<p&&(n.length=p+1),s.push(c)}}return d},e.prototype._mergeGroupings=function(e,t,n,a){var i=e;if(i&&i.length>0){if(t&&t.length>0)for(var r=0;r<t.length;r++){var o=i[r].isAllCollapsed.peek();i[r].itemGroups=n?this._retainItemGroupState(i[r].itemGroups,t[r].itemGroups):this._mergeItemGroups(i[r].itemGroups,t[r].itemGroups,o,null,a)}}else i=t;return i},e.prototype._mergeItemGroups=function(e,t,n,a,i){var r=e;if(e&&e.length>0){if(t&&t.length>0)for(var o=function(e){var t=!1;n&&e.state({isCollapsed:!0});for(var o=function(i){var o=r[i];if(e.groupingId===o.groupingId){if(s._context.noIndexBasedDataFetch||!s._context.isTokenBasedApi)if(s._context.groupReplace?(o.count+=e.count,o.hasMoreData&&i<r.length-1&&(o.hasMoreData=!1)):o.count=e.count,o.children=s._mergeItemGroups(o.children,e.children,n,o),0===i)o.startIndex=a?a.startIndex:0;else{var c=r[i-1],d=c.startIndex+c.count-o.startIndex;o.startIndex+=d,o.children&&o.children.forEach(function(e){e.startIndex+=d})}else{var l=e.startIndex+s._context.startIndex,u=e.startIndex+s._context.startIndex+e.count;o.startIndex=Math.min(o.startIndex,l),o.count=Math.max(u,o.startIndex+o.count)-o.startIndex}return t=!0,"break"}},c=0;c<r.length&&"break"!==o(c);c++);if(!t){var d=r[r.length-1],l=d.startIndex+d.count-e.startIndex;e.startIndex+=l,e.children&&e.children.forEach(function(e){e.startIndex+=l});var u=Math.min(e.count,30),f=0;if(i)for(var p=e.startIndex;p<e.startIndex+u;p++)i[p]||f++;f&&(e.emptyItemCount=f),r.push(e)}},s=this,c=0,d=t;c<d.length;c++)o(d[c])}else r=t;return r},e.prototype._retainItemGroupState=function(e,t,n){var a=t;if(t&&t.length>0&&e&&e.length>0){for(var i={},r=0,o=e;r<o.length;r++){var s=o[r];i[s.groupingId]=s}for(var c=0,d=a;c<d.length;c++){var l=d[c],u=i[l.groupingId];u&&(l.state(u.state.peek()),l.children=this._retainItemGroupState(u.children,l.children,u))}}return a},e.prototype._getGroupStartingOnIndex=function(e,t){if(t&&t.length>0)for(var n=0;n<t.length;n++){var a=t[n];if(!(a&&a.startIndex<=e))break;var i=a.startIndex+a.count-1;if(a.children){if(i>=e)return this._getGroupStartingOnIndex(e,a.children)}else{if(a.startIndex===e)return a.state.peek().isCollapsed?null:a;if(i>=e){var r=n<t.length-1?t[n+1]:null;if(r&&!r.state.peek().isCollapsed)return this._skipDataFetch=!0,null}}}return null},e}(),w=n(1421),E=n(9),A=n(1724),L=n(15),k=100,M=new v.t({name:"".concat("ItemProvider",".encodeItemSetParentKey"),factory:new v.e(Object(E._r)(E.Xi))}),P=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a._registeredProjections={},a._pendingGetItemRequests={},a._store=n.itemsStore,a._operationProvider=n.operationProvider,a._schemaDataSource=n.schemaDataSource,a._updateQuota=n.updateQuota,a._groupThrottle=n.groupThrottle,a._encodeItemSetParentKey=n.encodeItemSetParentKey||!1,a._smartFiltersStore=n.smartFiltersStore,a}return Object(a.__extends)(t,e),t.prototype.getItem=function(e){return this._getItem(e)},t.prototype.getItemSetKey=function(e,t){var n="parentKey="+(this._encodeItemSetParentKey?encodeURIComponent(e.parentKey):e.parentKey);function a(e,t){t&&(n+="&".concat(e,"=").concat(t))}a("ownerId",e.ownerId),a("groupingType",e.groupingType),n+="&sortField="+(e.sortField||""),n+="&isAscending="+("boolean"==typeof e.isAscending?e.isAscending:"");var i=e.filters;if(i)for(var r in i)n+="&"+r+"="+i[r];a("groupBy",e.groupBy),a("viewId",e.baseViewId),a("viewXml",e.viewXml),a("additionalFiltersXml",e.additionalFiltersXml);var o=!t&&e.itemSetProjections;if(o){var s="";for(var c in o)s+=c+"_"+o[c];n+="&projection="+s}return e.supportsNestedGroups&&(n+="&ng=1"),n},t.prototype.getSpecifiedItems=function(e){return e&&e.needToClearParentSmartFiltersInfo&&e.parentKey&&this._smartFiltersStore&&this._smartFiltersStore.invalidate(e.parentKey),this._getItemDataSource().then(function(t){return t.getSpecifiedItems(e)})},t.prototype.getItemSync=function(e){var t=this.getItemSetKey(e),n=e.parentKey,a=this._store.getItem(n),i=this._getItemSet(t,e);if(!a){var r=new o.e(n),s=e.queryType,c=void 0===s?r.queryType:s;r.queryType=c,this._store.setItem(r),a=this._store.getItem(n)}if(!i){var d=a.peek(),l=d&&d.folder,u=l&&l.childCount||0;(i=new h.e(t,e,u)).item=a;var f=e.needSchema;if(void 0===f||f){var p=this._schemaDataSource,m=p&&p.getColumns(d);m&&m.length>0&&i.schema(m)}this._store.setItemSet(t,i)}return i},t.prototype.invalidateItem=function(e,t){var n=void 0===t?{}:t,i=n.triggerFetch,r=void 0!==i&&i,o=n.emptyAllOtherSets,s=void 0!==o&&o,c=n.refreshSchema,d=void 0!==c&&c,l=n.updateGrouping,u=void 0!==l&&l,f=n.purgeCache,p=void 0!==f&&f;if(s&&this._store.emptyAllOtherSets([e]),d&&(m=this._store.getItemSetFromItemKey(e))&&m.schema([]),u||this._store.invalidateItem(e,{purgeCache:p}),this._smartFiltersStore&&this._smartFiltersStore.invalidate(e),r){var m=this._store.getItemSetFromItemKey(e);this._getItem(Object(a.__assign)(Object(a.__assign)({parentKey:e},m&&m.context||{}),{skipCache:!0,updateGrouping:u}))}},t.prototype.removeFromRecent=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.removeFromRecent(e)}).then(function(n){return n&&t.invalidateItem(e.parentKey),n})},t.prototype.removeMountPoint=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.removeMountPoint(e)}).then(function(n){return n&&t.invalidateItem(e.parentKey),n})},t.prototype.createMountPoint=function(e){return this._getItemDataSource().then(function(t){return t.createMountPoint(e)}).then(function(e){return e},function(e){return c.n.wrapError(e)})},t.prototype.createDocument=function(e,t,n,a,i){var r=this;return this._getItemDataSource().then(function(o){return o.createDocument(e,t,n,a).then(function(t){if(i&&o.updateContentType){var n=t.match(/{(.*)}/),a=n&&n[1];return a?o.updateContentType(e,a,i).then(function(){return r.invalidateItem(e),r._updateQuota(!0),t}):t}return r.invalidateItem(e),r._updateQuota(!0),t})})},t.prototype.createCustomDocument=function(e,t,n){var a=this;return this._getItemDataSource().then(function(a){return a.createCustomDocument(e,t,n)}).then(function(t){return t?(a.invalidateItem(e),a._updateQuota(!0),a.getItem({parentKey:e}).then(function(e){return a.peekUnwrapObservable(a._store.getItem(t))})):c.n.wrapError()})},t.prototype.updateBundle=function(e,t){var n=this,a=[new S.e(e.item.key,e.item)];return t.update(a),this._getItemDataSource().then(function(t){return t.updateBundle(e)}).then(function(){n.invalidateItem(e.item.UNSAFE_parent?e.item.UNSAFE_parent.key:e.item.key),a=a.map(function(e){return e.succeed()}),t.update(a)},function(i){n.invalidateItem(e.item.UNSAFE_parent?e.item.UNSAFE_parent.key:e.item.key);var r=new Error(i);return a=a.map(function(e){return e.fail(r)}),t.update(a),c.n.wrapError(r)})},t.prototype.removeFromSharedList=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.removeFromSharedList(e)}).then(function(n){return t.invalidateItem(e.parentKey),t.resources.consume(A.e)&&t.resources.consumeAsync(l.k).then(function(t){t.invalidateItems(e.parentKey)}),n})},t.prototype.updateViewCount=function(e){return this._getItemDataSource().then(function(t){return t.updateViewCount(e)})},t.prototype.reportAbuse=function(e){var t=new p.e,n=this._operationProvider.register({name:e.item.name||"",type:m.e.reportAbuse,payloads:{reportAbuse:{item:e.item}},iconName:e.item.iconName,batch:t}),a=this._getItemDataSource().then(function(t){return t.reportAbuse(e)});return n.state(f.e.started),n.progress.maximum(1),a.then(function(e){return n.state(f.e.completed),n.progress.current(1),e},function(e){return n.state(f.e.failed),n.error(new _.e({message:e})),c.n.wrapError(e)})},t.prototype.requestReview=function(e){for(var t=this,n=new p.e,a=e.items.map(function(e){var a=t._operationProvider.register({name:e.name||"",type:m.e.requestReview,payloads:{requestReview:{item:e}},iconName:e.iconName,batch:n});return a.progress.maximum(1),a.progress.current(0),a}),i=this._getItemDataSource().then(function(t){return t.requestReview(e)}),r=0,o=a;r<o.length;r++)o[r].state(f.e.started);return i.then(function(n){for(var i=0,r=a;i<r.length;i++){var o=r[i];o.progress.current(1),o.state(f.e.completed)}var s=e.items[0].UNSAFE_parent;return s&&t.invalidateItem(s.key),n},function(e){for(var t=0,n=a;t<n.length;t++){var i=n[t];i.error(new _.e({message:e})),i.state(f.e.failed)}return c.n.wrapError(e)})},t.prototype.saveSortOrder=function(e){return this._getItemDataSource().then(function(t){return t.saveSortOrder(e)}).then(function(e){return e},function(e){})},t.prototype.addCoverPhotos=function(e){return this._updateCoverPhotos(e,m.e.addCoverPhotos,this._addCoverPhotos)},t.prototype.removeCoverPhotos=function(e){return this._updateCoverPhotos(e,m.e.removeCoverPhotos,this._removeCoverPhotos)},t.prototype.changeFolderType=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.changeFolderType(e)}).then(function(n){return t.invalidateItem(e.item.key,{triggerFetch:!0}),n})},t.prototype.updateItemProperty=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.updateItemProperty(e)}).then(function(n){return t.invalidateItem(e.item.key,{triggerFetch:!0}),n})},t.prototype.getOpenInClientDetails=function(e){return this._getItemDataSource().then(function(t){return t.getOpenInClientDetails(e)}).then(function(e){return e},function(e){})},t.prototype.getWorkProgress=function(e){return this._getItemDataSource().then(function(t){return t.getWorkProgress(e)})},t.prototype.processReferral=function(e,t){return this._getItemDataSource().then(function(n){return n.processReferral(e,t)})},t.prototype.getItemOcrTextContent=function(e){return this._getItemDataSource().then(function(t){return t.getItemOcrTextContent(e)})},t.prototype.updateItemOcrInfo=function(e,t,n){var a=this;return this._getItemDataSource().then(function(a){return a.updateItemOcrInfo(e,t,n)}).then(function(t){return a.invalidateItem(e.key,{triggerFetch:!0}),t},function(e){return e})},t.prototype.rotateItems=function(e,t){var n=this,a={},i=e.items.map(function(e){return a[e.key]=new S.e(e.key,e)});return t.update(i),this._getItemDataSource().then(function(t){return t.rotateItems(e)}).then(function(){i=i.map(function(e){return e.succeed()}),t.update(i)},function(e){var r=e.data||[];i=[];for(var o=0,s=r;o<s.length;o++){var c=s[o],d=a[c.key];n._store.setItem(d.input),delete a[c.key],i.push(d.fail(c.error))}for(var l in a)d=a[l],delete a[l],i.push(d.succeed());t.update(i)})},t.prototype.registerProjection=function(e,t){this._registeredProjections[e]=t},t.prototype.computeProjectedItemSet=function(e,t,n,a){var i=n.itemSetProjections,r=a?null:this._store.getItemSet(e),o=!r||r.isPlaceholder||r.isExpired||r.version!==t.version;if(!r||o){for(var s in r||((r=new h.e(e,n)).item=t.item,r.isTokenBasedApi=t.isTokenBasedApi,r.isPlaceholder=t.isPlaceholder,r.isExpired=t.isExpired,r.version=t.version),i){var c=this._registeredProjections[s];c&&c.projectItemSet(r,t,i[s])}a||this._store.setItemSet(e,r)}return r},t.prototype.redeemPermissionToken=function(e){return this._getItemDataSource().then(function(t){return t.redeemPermissionToken(e)})},t.prototype._getItem=function(e){var n,i=this,r=g.e(e),o=this._store;e.keyAlias?(n=this.getItemSync({parentKey:e.keyAlias}).item,e.parentKey=n.peek().key):n=this.getItemSync(e).item;var s=e.skipCache,d=void 0!==s&&s,u=this.getItemSetKey(e),f=e.itemSetProjections?this.getItemSetKey(e,!0):u,p=this._getItemSet(u,e),m=p&&p.content.peek().items,_=e.isTokenBasedApi||!!p&&!!p.isTokenBasedApi,v=!d&&n&&!n.peek().revision&&p&&!p.isExpired&&!p.isPlaceholder&&(!e.requestAllChildren||b.e(m,{start:0,end:m.length})),y=e.startIndex,S=void 0===y?0:y,I=e.pageSize,x=void 0===I?k:I,C=e.endIndex||S+x;C=m&&m.length>0&&!_?Math.min(m.length,C):C,S=Math.max(0,Math.min(C,S));var E=L.e.isActivated("73b2b18a-27b0-433f-95cf-c7f77326ff37","11/09/2021","Not set requestToken if itemSet is expired")||p&&!p.isExpired?o.getNextRequestToken(f):void 0;e.requestToken="end"===E?"":E;var A=new O(e,o,_,t.TOKEN_BASED_API_EXTRA_ITEMS);A.initialize(p,S);var M=!1,P=p&&p.content.peek();if(!P||1!==P.partialResultStatus&&2!==P.partialResultStatus||(M=!0,1===P.partialResultStatus&&p.content({items:P.items,groupings:P.groupings,partialResultRequestCount:0,partialResultStatus:2})),v&&!M&&A.isResultSetValid(m,{start:S,end:C}))return c.n.wrap(p);if(n&&n.peek().isStub){var T=e.startKey;if(T&&o.getItem(T)){p.content.peek().items=[o.getItem(T)],p.isPlaceholder=!0,p.isExpired=!1;var U=this._schemaDataSource,F=U&&U.getColumns(n.peek());F&&F.length>0&&p.schema(F),p.content.valueHasMutated&&p.content.valueHasMutated()}return c.n.wrap(p)}var H=p&&!p.isExpired&&p.content.peek().groupings;H&&H.length>0&&(e.isGrouped=!0),this._normalizeContext(e,m,S,C,!v);var R=this._getRequestKey(e),N=this._pendingGetItemRequests[R];return N?e.itemSetProjections?N.getPromise().then(function(t){return i.computeProjectedItemSet(u,t,e)}):N.getPromise():(_&&!E&&(e.startIndex=0),this._pendingGetItemRequests[R]=N=new D.e,this.resources.consumeAsync(l.g.bypass).then(function(t){return t.getItem(Object(a.__assign)(Object(a.__assign)({},e),{itemSetKey:u}))}).then(function(t){r.updateContextBasedOnResult&&e.updateContextBasedOnResult&&(r.updateContextBasedOnResult(r,t),e.updateContextBasedOnResult(e,t),u=i.getItemSetKey(r));var a=e.itemSetProjections?i.getItemSetKey(e,!0):u;n=o.getItem(e.parentKey);var s=o.getItemSet(a);v=!(!n||!s);var c=A.computeNewChildren(t,e,s,a,!!v),d=c.allChildren,l=c.hasNextRequestToken;if(l&&(_=l),t.item&&!e.ignoreChildren&&!e.skipStoreResults){v||((s=new h.e(a,e)).item=o.getItem(e.parentKey),s.isTokenBasedApi=_,o.setItemSet(a,s));var f=!!s.isExpired;s.sortField=t.sortField,s.isAscending=t.isAscending,s.isPlaceholder=!1,s.isExpired=!1;var p=e.needSchema;if(void 0===p||p){var m=t.schema;s.schema(m&&m.length>0&&m||[]),t.customViewRenderer?s.customViewRenderer=i.observables.create(t.customViewRenderer):s.customViewRenderer=i.observables.create(void 0)}var y=t.groupings;_&&e.mergeGroupings&&(y=A.computeNewGroupings(s.content.peek().groupings,t.groupings,d,e,f)),t.contentTypes&&s.contentTypes&&s.contentTypes(t.contentTypes);var S=s.content.peek(),D=S.partialResultStatus,I=S.partialResultRequestCount,x=void 0===I?0:I;if(!(y&&y.length&&y[0]))if(l&&(t.children&&t.children.length<30||!t.children)){var C=x+1;C<=5?x=C:D=1}else void 0===D||0===D||l?2===D&&t.children&&30===t.children.length&&(D=0):D=3;s.content({items:d,groupings:y,partialResultRequestCount:x,partialResultStatus:D});var O=s.version,w=void 0===O?0:O;s.version=w+1}if(delete i._pendingGetItemRequests[R],e.requestAllChildren&&!b.e(d,{start:0,end:t.totalChildren})){var E=g.e(e),L=E.startIndex,M=void 0===L?0:L;return E.startIndex=M+k,i._getItem(E)}return t.isFromBrowserCache?(r.skipCache=!0,i._getItem(r)):(e.itemSetProjections&&(s=i.computeProjectedItemSet(u,s,e)),s)},function(e){return delete i._pendingGetItemRequests[R],c.n.wrapError(e)}).then(function(e){N.complete(e)},function(t){i._groupThrottle&&!i._groupThrottle()&&t&&t.errorCode===Number(w.t.queryThrottled)&&!e.noGroupReplace?i._groupThrottle(!0):N.error(t)}),N.getPromise())},t.prototype._normalizeContext=function(e,t,n,a,i){var r=e.pageSize||k;if(!e.avoidSeamSnapping){if(!i&&n-n%r!=a-a%r&&t)for(;n<a&&t[n];)n++;e.startIndex=n-n%r}"number"!=typeof e.pageSize&&(e.pageSize=k);for(var o=e.startIndex,s=void 0===o?0:o;a-s>e.pageSize;)e.pageSize+=k},t.prototype._getRequestKey=function(e){var t=this.getItemSetKey(e,!0);return e.requestToken?t+=e.requestToken:t+="&startIndex="+e.startIndex,t+"&pageSize="+e.pageSize},t.prototype._getItemSet=function(e,t){var n=this._store,a=n.getItemSet(e);if(t.itemSetProjections){var i=this.getItemSetKey(t,!0),r=n.getItemSet(i);r&&(a=this.computeProjectedItemSet(e,r,t))}return a},t.prototype._updateCoverPhotos=function(e,t,n){for(var a=this,i=new p.e,r=e.target,o=e.items.map(function(e){var n=a._operationProvider.register({name:e.name||"",type:t,payloads:{coverPhotos:{parent:r,item:e}},iconName:e.iconName,batch:i});return n.progress.maximum(1),n.progress.current(0),n}),s=n.call(this,e),c=0,d=o;c<d.length;c++)d[c].state(f.e.started);return s.then(function(t){a.invalidateItem(r.key),(null==e?void 0:e.itemsScopeInvalidate)&&a.resources.consumeAsync(l.k).then(function(e){e.invalidateItems(null==r?void 0:r.key)});for(var n=0,i=o;n<i.length;n++){var s=i[n];s.progress.current(1),s.state(f.e.completed)}return t},function(){for(var e=0,t=o;e<t.length;e++)t[e].state(f.e.failed)})},t.prototype._addCoverPhotos=function(e){return this._getItemDataSource().then(function(t){return t.addCoverPhotos(e)})},t.prototype._removeCoverPhotos=function(e){return this._getItemDataSource().then(function(t){return t.removeCoverPhotos(e)})},t.prototype._getItemDataSource=function(){return c.n.resolve(this.resources.consumeAsync(l.T))},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.n.dependencies),{groupThrottle:d.b.optional,schemaDataSource:l.ae.optional,itemsStore:s.e,operationProvider:r.resourceKey,smartFiltersStore:u.e.optional,updateQuota:I.e,encodeItemSetParentKey:M.optional}),t.TOKEN_BASED_API_EXTRA_ITEMS=2,t}(i.n),T=(t.default=P,Object(y.r)("ItemProvider",P))},1324:function(e,t,n){"use strict";n.d(t,"e",function(){return I});var a=n(0),i=n(1437),r=n(419),o=n(1357),s=n(13),c=n(490),d=n(144),l=n(1326),u=n(82),f=n(1758),p=n(1371),m=n(57),_=Object(m.isFeatureEnabled)(m.ReadOnlyItemsStore),h="token=",b="result=",g="item_write=",v="item=";function y(e){return e&&e.item&&e.item.peek().key}function S(e){e.isExpired=!0;var t=e.content,n=t.peek();n.groupings=null,n.items=[],t.valueHasMutated()}var D=function(e){function t(){var t=e.call(this,"ItemsStore")||this;return t._itemSetsKeys={},t._observables=new o.e({owner:t}),t._vaultItemsToPurge=[],window.odstore=t,t}return Object(a.__extends)(t,e),t.prototype.dispose=function(){this._observables.dispose()},t.prototype.setItem=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return this._handleSetItem.apply(this,Object(a.__spreadArray)([e],t,!1))},t.prototype.getItem=function(e){return this.getValue(v+e)},t.prototype.setItemSet=function(e,t){var n=b+e;this.setValue(n,t),this._itemSetsKeys[n]=1},t.prototype.getItemSetFromItemKey=function(e){var t;for(var n in this._itemSetsKeys){var a=(t=this.getValue(n)).content&&t.content.peek(),i=a&&a.items;if(i)for(var r=0,o=i;r<o.length;r++){var s=o[r];if(s&&s.peek().parentKey===e)return t}}},t.prototype.getItemSet=function(e){return this.getValue(b+e)},t.prototype.getAllItemSetKeys=function(){var e=[];for(var t in this._itemSetsKeys)e.push(t.slice(b.length));return e},t.prototype.setNextRequestToken=function(e,t,n){var a=h+t;n?this.setValue(a,n):this.remove(a)},t.prototype.getNextRequestToken=function(e){return this.getValue(h+e)},t.prototype.invalidateItem=function(e,t){var n=(void 0===t?{}:t).purgeCache,a=void 0!==n&&n;return this._handleItemInvalidation(e,this.getItem(e),a)},t.prototype.invalidateItemSet=function(e){var t=this.getValue(b+e);t&&S(t)},t.prototype.emptyAllOtherSets=function(e){var t;for(var n in this._itemSetsKeys)(t=this.getValue(n)).item&&(0===e.length||e.indexOf(t.item.peek().key)<0)&&S(t)},t.prototype.invalidateLocation=function(e){var t;for(var n in this._itemSetsKeys){var a=y(t=this.getValue(n));if(a){var i=d.e(a),r=i&&i.locationFilter;r&&r.indexOf(e)>=0&&(t.isExpired=!0)}}},t.prototype.invalidateTag=function(e){var t;for(var n in this._itemSetsKeys){var a=y(t=this.getValue(n));if(a){var i=d.e(a);i&&i.tagFilter===e&&(t.isExpired=!0)}}},t.prototype.invalidateAllPhotos=function(){var e;for(var t in this._itemSetsKeys){var n=(e=this.getValue(t)).item&&e.item.peek();n&&n.key&&n.key.indexOf("allmyphotos")>=0&&(e.isExpired=!0,this._invalidateItem(n))}},t.prototype.invalidateAllVault=function(){for(var e=0,t=Object(a.__spreadArray)([],this._vaultItemsToPurge,!0);e<t.length;e++){var n=t[e],r=void 0;n.vault&&n.vault.root&&((r=new i.e(n.key)).name=n.name,r.displayName=n.displayName,r.dateModified=" ",r.folder={},r.vault={isLocked:!0,root:{}}),this._purgeItem(n,r)}this._vaultItemsToPurge=[]},t.prototype._handleItemInvalidation=function(e,t,n){var a=this;if(t){var i=t.peek(),r=!1,o=[];if(i)switch(o.push(i),i.type){case u.e.Folder:case u.e.Media:r=!0}for(var s in this._itemSetsKeys){var c=this.getValue(s),d=c.item&&c.item.peek(),l=d&&d.key;l&&(l===e||r&&l.indexOf("allmyphotos")>-1)&&(l===e?this.setNextRequestToken(e,c.key,""):o.push(d),c.isExpired=!0)}o.forEach(n?function(e){return a._purgeItem(e)}:function(e){return a._invalidateItem(e)})}},t.prototype._purgeItem=function(e,t){var n=t||new i.e(e.key);this.setItem(n)},t.prototype._invalidateItem=function(e){var t=new i.e(e.key);Object(p.default)(t,e),Object(p.default)(t,{revision:e.revision+1}),this.setItem(t)},t.prototype._handleSetItem=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var i=[];_&&!Object.isFrozen(e)&&Object.freeze(e),e.vault&&this._vaultItemsToPurge.push(e);for(var r=function(t){var n="".concat(v).concat(t),a=_?"".concat(g).concat(t):n,r=o.getValue(n),s=o.getValue(a);s?s(e):((s=o._observables.create(e)).equalityComparer=l.n,o.setValue(a,s),r=_?o._observables.pureCompute(function(){return s()}):s,o.setValue(n,r)),i.push(r)},o=this,s=0,c=Object(f.e)(Object(a.__spreadArray)([e.key],t,!0));s<c.length;s++){var d=c[s];r(d)}return i[0]},t}(r.e),I=new s.t({name:"ItemsStore",factory:new c.i(D)})},1326:function(e,t,n){"use strict";function a(e,t){return e===t}function i(e,t){if(e===t)return!0;if(!e||!t)return!1;if("object"!=typeof e||"object"!=typeof t)return!1;for(var n in e)if(e[n]!==t[n])return!1;for(var n in t)if(e[n]!==t[n])return!1;return!0}function r(e,t){if(e===t)return!0;if(!e||!t)return!1;var n=e.length;if(n!==t.length)return!1;for(;n;)if(e[--n]!==t[n])return!1;return!0}n.d(t,"n",function(){return a}),n.d(t,"t",function(){return i}),n.d(t,"e",function(){return r})},1357:function(e,t,n){"use strict";n.d(t,"a",function(){return l}),n.d(t,"i",function(){return u}),n.d(t,"n",function(){return f}),n.d(t,"t",function(){return p});var a=n(0),i=(n(1382),n(65)),r=n(1293);r.onError=function(e){i.e.log(e)};var o=n(328),s=n(191),c=n(1326),d=n(99);function l(e){return f(e)?e.peek():e}function u(e){return r.unwrap(e)}function f(e){return r.isObservable(e)}function p(e){return{defaultValue:e,reducer:function(e,t){return t}}}var m=function(){function e(e,t){void 0===e&&(e={}),void 0===t&&(t={}),this._owner=e.owner,this._asyncType=t.asyncType}return Object.defineProperty(e.prototype,"scope",{get:function(){return this._scope||(this._scope=new o.e)},enumerable:!1,configurable:!0}),e.prototype.subscribe=function(e,t,n){var a,i=(void 0===n?{}:n).isBeforeChange;return void 0!==i&&i&&(a="beforeChange"),this.scope.attach(e.subscribe(t,this._owner,a))},e.prototype.create=function(e){return r.observable(e)},e.prototype.createArray=function(e){return r.observableArray(e)},e.prototype.createCallback=function(e){var t=0,n=this.create({}),i=e.defaultValue,r=e.reducer,o=this.pureCompute(function(){return Object.keys(n()).map(function(e){return n()[e]}).reduce(function(e,t){return r(e,u(t))},u(i))});return o.equalityComparer=c.n,Object(d.e)(o,{register:function(e){var i,r="".concat(++t);return n(Object(a.__assign)(Object(a.__assign)({},n.peek()),((i={})[r]=e,i))),{dispose:function(){var e=n.peek(),t=r,i=(e[t],Object(a.__rest)(e,["symbol"==typeof t?t:t+""]));n(i)}}}})},e.prototype.compute=function(e,t){var n=this,a={owner:this._owner,disposeWhen:function(){return n.scope.isDisposed}},i=function(e){return"object"==typeof e}(e)?e:{read:e},o=r.utils.extend(a,i);t&&r.utils.extend(o,t);var s=r.computed(o);return this.scope.attach(s)},e.prototype.pureCompute=function(e,t){var n={pure:!0};return t&&r.utils.extend(n,t),this.compute(e,n)},e.prototype.backgroundCompute=function(e,t){var n={deferEvaluation:!0};return t&&r.utils.extend(n,t),this._setupBackgroundTask(this.compute(e,n))},e.prototype.wrap=function(e){return f(e)?e:this.create(e)},e.prototype.peekUnwrap=function(e){return f(e)?e.peek():e},e.prototype.unwrap=function(e){return u(e)},e.prototype.isObservable=function(e){return f(e)},e.prototype.ignore=function(e){return function(e){return r.ignoreDependencies(e)}(e)},e.prototype.dispose=function(){this._scope&&this._scope.dispose()},e.prototype._setupBackgroundTask=function(e){var t=this;return this._backgroundTasks||(this._backgroundTasks=[]),this._backgroundTasks.push(e),this._backgroundTasksTimeoutId||(this._backgroundTasksTimeoutId=this._getAsync().setImmediate(function(){return t._runBackgoundTasks()})),e},e.prototype._runBackgoundTasks=function(){for(;this._backgroundTasks.length;)this._backgroundTasks.shift()();delete this._backgroundTasksTimeoutId,delete this._backgroundTasks},e.prototype._getAsync=function(){var e=this._asyncType||s.e,t=this.scope.attach(new e(this));return this._getAsync=function(){return t},t},e}();t.e=m},1359:function(e,t,n){"use strict";var a;!function(e){e[e.multiple=0]="multiple",e[e.renameItems=1]="renameItems",e[e.deleteItems=2]="deleteItems",e[e.pointInTimeRestore=3]="pointInTimeRestore",e[e.restoreItems=4]="restoreItems",e[e.uploadItems=5]="uploadItems",e[e.moveItems=6]="moveItems",e[e.copyItems=7]="copyItems",e[e.rotateItems=8]="rotateItems",e[e.addItemsToAlbum=9]="addItemsToAlbum",e[e.addCoverPhotos=10]="addCoverPhotos",e[e.removeCoverPhotos=11]="removeCoverPhotos",e[e.createAlbumFromFolder=12]="createAlbumFromFolder",e[e.createColumn=13]="createColumn",e[e.editColumn=14]="editColumn",e[e.deleteColumn=15]="deleteColumn",e[e.checkInItem=16]="checkInItem",e[e.checkOutItem=17]="checkOutItem",e[e.undoCheckOutItem=18]="undoCheckOutItem",e[e.createFolder=19]="createFolder",e[e.updateBundle=20]="updateBundle",e[e.shareItem=21]="shareItem",e[e.reportAbuse=22]="reportAbuse",e[e.requestReview=23]="requestReview",e[e.setAlbumCoverPhoto=24]="setAlbumCoverPhoto",e[e.createAlbum=25]="createAlbum",e[e.uploadVideos=26]="uploadVideos",e[e.saveItem=27]="saveItem",e[e.createItem=28]="createItem",e[e.publishItem=29]="publishItem",e[e.unPublishItem=30]="unPublishItem",e[e.applyOfficeLens=31]="applyOfficeLens",e[e.removeOfficeLens=32]="removeOfficeLens",e[e.updateMetadata=33]="updateMetadata",e[e.makeHomepage=34]="makeHomepage",e[e.triggerFlow=35]="triggerFlow",e[e.downloadAsZip=36]="downloadAsZip",e[e.saveAutoAlbum=37]="saveAutoAlbum",e[e.discardAutoAlbum=38]="discardAutoAlbum",e[e.addToOneDrive=39]="addToOneDrive",e[e.removeFromSharedList=40]="removeFromSharedList",e[e.setupApprovalFlow=41]="setupApprovalFlow",e[e.setupReminderFlow=42]="setupReminderFlow",e[e.sharepointPointInTimeRestore=43]="sharepointPointInTimeRestore",e[e.sharingReport=44]="sharingReport",e[e.editViewColumns=45]="editViewColumns",e[e.runModelOnItems=46]="runModelOnItems",e[e.importModel=47]="importModel",e[e.downloadItem=48]="downloadItem",e[e.deleteSmartTemplate=49]="deleteSmartTemplate",e[e.publishSmartTemplate=50]="publishSmartTemplate",e[e.unpublishSmartTemplate=51]="unpublishSmartTemplate"}(a||(a={})),t.e=a},1370:function(e,t,n){"use strict";var a;!function(e){e[e.created=0]="created",e[e.started=1]="started",e[e.completed=2]="completed",e[e.failed=3]="failed",e[e.canceled=4]="canceled",e[e.expired=5]="expired"}(a||(a={})),t.e=a},1371:function(e,t,n){"use strict";n.r(t),n.d(t,"GraftOperationType",function(){return a}),n.d(t,"remove",function(){return r}),n.d(t,"optional",function(){return o}),n.d(t,"backup",function(){return s}),n.d(t,"replace",function(){return c}),n.d(t,"default",function(){return d});var a,i=n(0);function r(){return{graftOperationType:a.remove}}function o(e){return{graftOperationType:a.optional,value:e}}function s(e){return{graftOperationType:a.backup,value:e}}function c(e){return{graftOperationType:a.replace,value:e}}function d(e,t){if(!l(e))throw new Error("Value for 'base' passed to 'graft' is not an object.");if(!l(t))throw new Error("Value for 'extension' passed to 'graft' is not an object");if(t===e)return e;for(var n=0,r=Object.keys(t);n<r.length;n++){var o=r[n],s=t[o],c=e[o];if(s!==c){var _=s;if(p(_))if(_.graftOperationType===a.replace)c=void 0,s=h=_.value;else if(_.graftOperationType===a.backup){var h=_.value;if(void 0!==e[o])continue;s=h}else{if(_.graftOperationType!==a.optional){if(m(_)){delete e[o];continue}throw new Error("Unknown patch specified for grafting. Only use exported functions from Graft to create patches.")}if(void 0===(h=_.value))continue;s=h}var b=void 0;if(u(s))b=new Date(s.getTime());else if(f(s)){var g=c;f(g)||(g=[]),g.splice.apply(g,Object(i.__spreadArray)([0,g.length],s,!1)),b=g}else if(l(s)){var v=c;l(v)||(v={}),d(v,s),b=v}else b=s;e[o]=b}}return e}function l(e){return"object"==typeof e&&!!e}function u(e){return e instanceof Date}function f(e){return Array.isArray(e)}function p(e){return l(e)&&!!e.graftOperationType}function m(e){return e.graftOperationType===a.remove}!function(e){e[e.none=0]="none",e[e.replace=1]="replace",e[e.optional=2]="optional",e[e.remove=3]="remove",e[e.backup=4]="backup"}(a||(a={}))},1382:function(e,t,n){"use strict";n(1653)},1394:function(e,t,n){"use strict";var a=n(608);n.d(t,"e",function(){return a.t}),n.d(t,"t",function(){return a.n}),n.d(t,"n",function(){return a.a}),n.d(t,"a",function(){return a.r}),n.d(t,"i",function(){return a.o}),n.d(t,"r",function(){return a.s})},1412:function(e,t,n){"use strict";n.d(t,"e",function(){return r}),n.d(t,"t",function(){return o}),n.d(t,"a",function(){return s}),n.d(t,"i",function(){return c}),n.d(t,"r",function(){return d}),n.d(t,"n",function(){return l}),n.d(t,"s",function(){return u}),n.d(t,"l",function(){return f}),n.d(t,"f",function(){return p}),n.d(t,"p",function(){return m}),n.d(t,"o",function(){return _}),n.d(t,"d",function(){return h}),n.d(t,"u",function(){return b}),n.d(t,"c",function(){return g}),n.d(t,"m",function(){return v});var a=n(57),i=n(2427),r="ms-albums-list",o=Object(a.isFeatureEnabled)(a.UseTilesListForAllPhotos)?"od-tiles-list":"ms-all-photos-list",s="ms-grid-customlist",c="ms-details-customlist",d="ms-details-list",l="ms-compact-details-list",u=Object(a.isFeatureEnabled)(a.UseTilesList)?"od-tiles-list":"ms-grid-list",f="ms-single-album-list",p="od-tag-grid",m="od-tags-list",_="od-doccard-grid",h="od-shared-grid-list",b="od-sites-grid-list",g={"ms-albums-list":Object(i.e)(function(){return n.e(155).then(n.bind(null,2096))}),"od-tiles-list":Object(i.e)(function(){return n.e(168).then(n.bind(null,3041))}),"ms-all-photos-list":Object(i.e)(function(){return n.e(156).then(n.bind(null,1939))}),"ms-grid-customlist":Object(i.e)(function(){return n.e(158).then(n.bind(null,3018))}),"ms-details-customlist":Object(i.e)(function(){return n.e(159).then(n.bind(null,2861))}),"ms-details-list":Object(i.e)(function(){return n.e(160).then(n.bind(null,1891))}),"ms-compact-details-list":Object(i.e)(function(){return n.e(157).then(n.bind(null,1892))}),"ms-grid-list":Object(i.e)(function(){return n.e(162).then(n.bind(null,1911))}),"ms-single-album-list":Object(i.e)(function(){return n.e(164).then(n.bind(null,1945))}),"od-tag-grid":Object(i.e)(function(){return n.e(166).then(n.bind(null,2185))}),"od-tags-list":Object(i.e)(function(){return n.e(167).then(n.bind(null,1980))}),"od-doccard-grid":Object(i.e)(function(){return n.e(161).then(n.bind(null,3055))}),"od-shared-grid-list":Object(i.e)(function(){return n.e(163).then(n.bind(null,3056))}),"od-sites-grid-list":Object(i.e)(function(){return n.e(165).then(n.bind(null,3023))})};function v(e,t){var n=t&&t.isCustomList,a=t&&t.isPlaceholder;switch(e){case r:return r;case o:return o;case s:case"ms-grid-list":case"od-tiles-list":case u:return a?e:n?s:u;case c:case d:return a?e:n?c:d;case l:return l;case f:return f;case p:return p;case m:return m;case _:return _;case h:return h;case b:return b;default:return n?c:d}}},1421:function(e,t,n){"use strict";n.d(t,"e",function(){return i}),n.d(t,"n",function(){return r}),n.d(t,"a",function(){return o}),n.d(t,"i",function(){return s}),n.d(t,"t",function(){return b});var a={};n.r(a),n.d(a,"fileNotFound",function(){return c}),n.d(a,"invalidView",function(){return d}),n.d(a,"listNotFound",function(){return l}),n.d(a,"docAlreadyExists",function(){return u}),n.d(a,"queryThrottled",function(){return f}),n.d(a,"newExperieceRenderingNotSupported",function(){return p}),n.d(a,"onePageNavigationViewMismatch",function(){return m}),n.d(a,"onePageNavigationError",function(){return _}),n.d(a,"offline",function(){return h});var i,r,o,s,c=-2147024894,d=-2147024809,l=-1,u=-2130575257,f=-2147024860,p=-2,m=-3,_=-4,h=-5;!function(e){e[e.icon=16]="icon",e[e.iconMin=16]="iconMin",e[e.bigIcon=48]="bigIcon",e[e.bigIconMin=48]="bigIconMin",e[e.regularMin=90]="regularMin",e[e.regular=130]="regular",e[e.nameMin=220]="nameMin",e[e.nameODC=440]="nameODC",e[e.nameODB=280]="nameODB",e[e.originalLocation=300]="originalLocation",e[e.custom=900]="custom",e[e.sharedWith=150]="sharedWith",e[e.note=250]="note",e[e.dateModifiedMl=150]="dateModifiedMl",e[e.dotDotDot=32]="dotDotDot",e[e.ratingsMin=110]="ratingsMin"}(i||(i={})),function(e){e[e.none=0]="none",e[e.icon=1]="icon",e[e.name=2]="name",e[e.title=3]="title",e[e.calloutInvoker=4]="calloutInvoker",e[e.shareHeroCommand=5]="shareHeroCommand",e[e.modified=6]="modified",e[e.url=7]="url"}(r||(r={})),function(e){e[e.none=0]="none",e[e.notify=1]="notify",e[e.block=2]="block",e[e.notifyAndBlock=3]="notifyAndBlock",e[e.blockSharing=4]="blockSharing"}(o||(o={})),function(e){e[e.Auto=0]="Auto",e[e.Pinned=1]="Pinned",e[e.Removed=2]="Removed"}(s||(s={}));var b=a},1433:function(e,t,n){"use strict";n.d(t,"s",function(){return v}),n.d(t,"c",function(){return S}),n.d(t,"a",function(){return I}),n.d(t,"i",function(){return x}),n.d(t,"t",function(){return O}),n.d(t,"o",function(){return w}),n(608);var a,i,r,o,s,c=n(1312),d=n(1318),l=n(1394);n.d(t,"e",function(){return l.e}),n.d(t,"n",function(){return l.t}),n.d(t,"r",function(){return l.n}),n.d(t,"d",function(){return l.a}),n.d(t,"l",function(){return l.i}),n.d(t,"u",function(){return l.r});var u="ms-word",f="onenote|UsePlain",p="ms-powerpoint",m="ms-excel",_="ms-visio",h="ms-publisher",b="ms-project",g=((a={})[u]=d.OpenInWordOnline,a[f]=d.OpenInOneNoteOnline,a[p]=d.OpenInPowerPointOnline,a[m]=d.OpenInExcelOnline,a[_]=d.OpenInVisioOnline,a);function v(e){return g[e]||""}var y=((i={})[u]=d.OpenInWord,i[f]=d.OpenInOneNote,i[p]=d.OpenInPowerPoint,i[m]=d.OpenInExcel,i[_]=d.OpenInVisio,i[h]=d.OpenInPublisher,i[b]=d.OpenInProject,i["ms-infopath"]=d.OpenInInfoPath,i);function S(e){return y[e]}var D=((r={})[u]="Word",r[f]="OneNote",r[p]="PowerPoint",r[b]="Project",r[_]="Visio",r[m]="Excel",r);function I(e){var t=e.extension;return t&&".pdf"===t.toLowerCase()?"WordPdf":D[e.appMap]||"Word"}function x(e){return D[e]}(o={})[u]="WordLogo",o[f]="OneNoteLogo",o[p]="PowerPointLogo",o[m]="ExcelLogo",o[_]="VisioLogo",o[h]="Page";var C=((s={})[u]="svg/word_16x1.svg",s[f]="svg/onenote_16x1.svg",s[p]="svg/powerpoint_16x1.svg",s[m]="svg/excel_16x1.svg",s[_]="svg/visio_16x1.svg",s[h]="Page",s),O={"svg/word_16x1.svg":"svg/word_white_stroke_18x1.svg","svg/onenote_16x1.svg":"svg/onenote_white_stroke_18x1.svg","svg/powerpoint_16x1.svg":"svg/powerpoint_white_stroke_18x1.svg","svg/excel_16x1.svg":"svg/excel_white_stroke_18x1.svg","svg/visio_16x1.svg":"svg/visio_white_stroke_18x1.svg"};function w(e){var t=C[e];return t&&new c.e(t)}},1437:function(e,t,n){"use strict";var a=n(31);t.e=function(e){void 0===e&&(e=""),this.isDropEnabled=!1,this.permissions={High:0,Low:0},this.key=e,this.revision=0,this.queryType=a.e.Files,this.displayType=a.e.Files,this.isPlaceholder=!0,this.properties={},this.recycleBinProperties={},this.reputationProperties={},this.statistics={views:0,viewsUnique:0,viewsLast2Weeks:0,viewsLast2WeeksUnique:0,viewsLastWeek:0,viewsLastWeekUnique:0,viewsLastMonth:0,viewsLastMonthUnique:0},this.urls={},this.state={upload:{status:5},removing:!1}}},1438:function(e,t,n){"use strict";var a=function(){function e(e,t){!function(e){return!!e&&"object"==typeof e}(e)?(this.key=e,this.input=t,this.status=0):(this.key=e.key,this.input=e.input,this.output=e.output,this.status=e.status,this.error=e.error)}return e.prototype.succeed=function(t){var n=new e(this);return n.output=t,n.status=1,delete n.error,n},e.prototype.fail=function(t){var n=new e(this);return n.error=t,n.status=2,n},e.prototype.cancel=function(){var t=new e(this);return delete t.error,t.status=3,t},e.prototype.restart=function(){return new e(this.key,this.input)},e.prototype.changeInput=function(t){var n=t(this.input),a=new e(this.key,n);return a.output=this.output,a.status=this.status,a.error=this.error,a},e.prototype.changeOutput=function(t){var n=t(this.output),a=new e(this.key,this.input);return a.output=n,a.status=this.status,a.error=this.error,a},e.prototype.compare=function(e){return e&&this.input===e.input&&this.output===e.output&&this.error===e.error&&this.status===e.status?null:{previous:e,current:this}},e}();t.e=a},1453:function(e,t,n){"use strict";n.d(t,"e",function(){return J}),n.d(t,"n",function(){return X});var a,i,r=n(0),o=n(82),s=n(40),c=n(31),d=n(726),l=n(305),u=n(170),f=n(2217),p=n(57),m=n(144),_=n(25),h=n(495),b=n(1806),g=n(1433),v=n(313),y=n(1807),S=n(166),D=n(88),I=n(13),x=n(490),C=n(190),O=n(228),w=n(308),E=n(7),A=n(859),L=n(33),k=n(310),M=n(531),P=n(756),T=n(2218),U=n(213),F=n(99),H=n(822),R=n(1724),N=n(15),B=n(892),j=window.$Config&&window.$Config.isINT,V=window.FilesConfig&&window.FilesConfig.skyApiDomain,z=window.FilesConfig&&window.FilesConfig.storageDomain,G=window.FilesConfig&&window.FilesConfig.mpcDomain;!function(e){e[e.DateCreated=0]="DateCreated",e[e.DateModified=1]="DateModified"}(i||(i={}));var K=N.e.isActivated("6CEBAB53-E3AA-4B32-A437-CEC98812ABB4","10/21/2021","Refactor URL DataSource"),W=!N.e.isActivated("CA949581-487C-4A90-9D63-81958797F222","10/21/2021","Fast OneUp in ODC")&&Object(p.isFeatureEnabled)(p.UseItemsScopeInOneDrive),q=new I.t({name:"".concat("UrlDataSource",".useOneUpTextEditor"),factory:new I.e(Object(p.isFeatureEnabled)(p.UseOneUpTextEditor))}),Q=new I.t({name:"".concat("UrlDataSource",".useRefactoredGetDefaultClickUrl"),factory:new I.e(!K)}),Y=new I.t({name:"".concat("UrlDataSource",".enableFastOneUp"),factory:new I.e(W)}),J=function(){function e(e,t){void 0===e&&(e={}),void 0===t&&(t={});var n=this,a=t.navigation,i=void 0===a?this.resources.consume(O.e):a,r=t.useOneUpTextEditor,o=void 0===r?this.resources.consume(q):r,s=t.enableFastOneUp,c=void 0===s?this.resources.consume(Y):s,d=t.useRefactoredDefaultClickUrl,l=void 0===d?this.resources.consume(Q):d;this._navigation=i,this._useOneUpTextEditor=o,this._enableFastOneUp=c,this._useRefactoredDefaultClickUrl=l,this.getCurrentPageBaseUrl=e&&e._getCurrentPageBaseUrl||(this._useRefactoredDefaultClickUrl?E.s:this.getCurrentPageBaseUrl),this._getCurrentUrlPathName=e&&e._getCurrentUrlPathName||this._getCurrentUrlPathName,this._events=new C.t(this),(this._mayBeFastOneUp=this._enableFastOneUp&&Object(p.isFeatureEnabled)(p.UseItemsScopeInOneDrive)&&!!this.getFocusItemKey(this._navigation.viewParams))&&this._events.on(this._navigation,"change",function(){n.getFocusItemKey(n._navigation.viewParams)||(n._mayBeFastOneUp=!1,n._events.off(n._navigation))})}return e.getKey=function(e){return void 0===e&&(e={}),Object(E.v)(e)},e.getKeyParams=function(e){return Object(E.y)(e)},e.getIsSyncUserBusiness=function(e){return"b"===e.pt},e.getWtMcIdParamKeyIsSync=function(e){var t=e.ocid||e["WT.mc_id"];return t&&t.toLowerCase().indexOf("sync")>=0},e.getRedeemCodeParam=function(e){var t=e.redeemCode;return"undefined"===t?"":t},e.getProfileImage=function(t){return e.storageBaseUrl+"/users/0x"+t+"/myprofile/expressionprofile/profilephoto:UserTileLarge,UserTileStatic/MeControlMediumUserTile?ck=1&ex=24&fofoff=1"},e.getTermsUrl=function(){return"https://g.live.com/8seskydrive/tou"},e.getPrivacyUrl=function(){return"https://go.microsoft.com/fwlink/?LinkId=521839"},e.getImpressumUrl=function(){return Object(E.m)()},e.getResourceRedirectUrl=function(e){return"https://onedrive.live.com/redir.aspx?"+m.n({resid:e})},e.encodeSharingUrl=function(e){return Object(L.e)(e)},e.getThumbnailUrl=function(t,n,a,i){return i=i||a,_.format(e.storageBaseUrl+"/Items/{1}:CustomThumbnailSource,HighRes,Default?{2}",t,n,m.n({width:a,height:i,cropmode:"center"}))},e.getVroomBaseUrl=function(e){return Object(L.c)(e)},e.getAutoRedeemRedirectUrl=function(t){var n="",a=t.viewParams,i=a.id,r=a.cid,o=a.action;return a.autoredeeem&&i&&r&&o&&(n=e.getAutoRedeemLoginUrl(i,r,o,t)),n},e.getAutoRedeemLoginUrl=function(t,n,a,i){var r,o=e._getAutoRedeemUrl(t,n,a,!1,i.viewParams),s=((r={}).ru=o,r.wreply=o,r);return D.t.signInUrl+"&"+m.n(s,null,!0)},e.getAutoRedeemLogoutUrl=function(t,n,a,i){var r,o=e._getAutoRedeemUrl(t,n,a,!0,i.viewParams),s=((r={}).lru=o,r);return D.t.autoRedeemSignOut+"&"+m.n(s,null,!0)},e.getCookieDomain=function(){return window.$Config.sd},e.getEnvironment=function(){return Object(M.e)()},e.areCidsEqual=function(e,t){return Object(A.e)(e,t)},e._getAutoRedeemUrl=function(e,t,n,a,i){var r,o=((r={}).id=e,r.cid=t,r.action=n,r.authkey=i.authkey,r);return a&&(o.autoredeeem="1"),window.location.protocol+"//"+window.location.host+document.location.pathname+"?"+m.n(o,null,!0)},e.prototype.getDefaultRootItemId=function(){return"root"},e.prototype.getKey=function(t){return e.getKey(t)},e.prototype.getKeyParams=function(e){return Object(E.y)(e)},e.prototype.getRequestAccessLogoutUrl=function(e,t,n){var a,i,r=((a={resid:e,ithint:t}).challengeToken=n,a.v="requestaccess",a),o=window.location.protocol+"//"+window.location.host+document.location.pathname+"?"+m.n(r,null,!0),s=((i={}).lru=o,i);return D.t.autoRedeemSignOut+"&"+m.n(s,null,!0)},e.prototype.getItemHintRedirectViewParams=function(e){return void 0===e&&(e={}),Object(E._)(e)},e.prototype.getQueryType=function(e){return void 0===e&&(e=this._navigation.viewParams),Object(E.w)(e)},e.prototype.getPhotoType=function(e){return Object(E.O)(e)},e.prototype.getPageType=function(e,t){return void 0===e&&(e=this._navigation.viewParams),Object(E.x)(e,this._mayBeFastOneUp||t)},e.prototype.getFocusItemKey=function(e){return void 0===e&&(e=this._navigation.viewParams),Object(E.f)(e)},e.prototype.getCurrentItemKey=function(e){return void 0===e&&(e=this._navigation.viewParams),Object(E.o)(e)},e.prototype.areKeysEqual=function(e,t){var n=this.getKeyParams(e),a=this.getKeyParams(t);return delete n.u,delete a.u,this.getKey(n)===this.getKey(a)},e.prototype.getRootItemKey=function(e){return void 0===e&&(e=c.e.Files),Object(E.A)(e)},e.prototype.isRecycleBin=function(e){return this._useRefactoredDefaultClickUrl?Object(L.D)(e):e===c.e.RecycleBin},e.prototype.isCurrentQueryPhotoStream=function(e){return void 0===e&&(e=this._navigation.viewParams),"photostream"===e.qt},e.prototype.isCurrentQueryFiles=function(e){void 0===e&&(e=this._navigation.viewParams);var t=!N.e.isActivated("4B9ACAFF-DC04-4EA0-93FF-9439B92FD516","10/21/2021","Check is Search in Files pivot")&&(e.searchsessionid||"search"===e.parQt);return Object(E.F)(e)||0===Object.keys(e).length||!e.qt&&!e.v&&!t&&Object(E.n)(e)},e.prototype.isCurrentQueryRecent=function(e){return void 0===e&&(e=this._navigation.viewParams),"mru"===e.qt},e.prototype.isCurrentQuerySharedWithMe=function(e){return void 0===e&&(e=this._navigation.viewParams),Object(E.T)(e)},e.prototype.isCurrentQuerySharedByMe=function(e){return void 0===e&&(e=this._navigation.viewParams),"sharedbyme"===e.qt},e.prototype.isCurrentQuerySharedFilesRoot=function(e){return void 0===e&&(e=this._navigation.viewParams),"sharedbyme"===e.qt||"sharedby"===e.qt},e.prototype.isCurrentQueryRecycleBin=function(e){return void 0===e&&(e=this._navigation.viewParams),"recyclebin"===e.qt},e.prototype.getDisableQueryAlteration=function(e){return void 0===e&&(e=this._navigation.viewParams),!1},e.prototype.isCurrentQuery=function(e,t){switch(void 0===t&&(t=this._navigation.viewParams),e){case c.e.Files:return this.isCurrentQueryFiles();case c.e.Recent:return this.isCurrentQueryRecent();case c.e.SharedWithMe:return this.isCurrentQuerySharedWithMe();case c.e.SharedByMe:return this.isCurrentQuerySharedByMe();case c.e.RecycleBin:return this.isCurrentQueryRecycleBin();case c.e.Photos:case c.e.AllMyPhotos:return Object(E.P)(t);case c.e.PhotoStream:return this.isCurrentQueryPhotoStream(t);default:return!!t.qt&&t.qt.toString().toLowerCase()===c.e[e].toString().toLowerCase()}},e.prototype.getFilesQueryUrl=function(){return this._requireAuthentication(this.getItemUrl(this.getKey({}),{page:s.e.Files}))},e.prototype.getRecycleBinQueryUrl=function(){var e;return Object(p.isFeatureEnabled)(p.ConvergenceEnabled)&&Object(U.e)(E.B)&&!Object(p.isFeatureEnabled)(p.ApplyItemsScopeToRecycleBin)?"".concat(this.getMpcOneDriveUrl(),"?view=5"):this._requireAuthentication(this.getItemUrl(this.getKey(((e={}).qt="recyclebin",e)),{page:s.e.Files}))},e.prototype.getRecentQueryUrl=function(){var e;return this._requireAuthentication(this.getItemUrl(this.getKey(((e={}).qt="mru",e)),{page:s.e.Files}))},e.prototype.getPhotoStreamQueryUrl=function(e,t){var n;void 0===t&&(t=!1);var a=Object(r.__assign)({},this._navigation.viewParams);return t||delete a.psShareId,this._requireAuthentication(this.getItemUrl(this.getKey(((n={}).qt="photostream",n.v="photoStream",n.psId=e||"me",n.psShareId=a.psShareId,n.psPostId=a.psPostId,n.pssc=a.pssc,n)),{page:s.e.PhotoStream,viewParams:a}))},e.prototype.getPhotoStreamMyFeedQueryUrl=function(e){var t;void 0===e&&(e=!1);var n=Object(r.__assign)({},this._navigation.viewParams);return e||delete n.psShareId,this._requireAuthentication(this.getItemUrl(this.getKey(((t={}).qt="photostream",t.v="photoStream",t.psShareId=n.psShareId,t.psPostId=n.psPostId,t.pssc=n.pssc,t)),{page:s.e.PhotoStream,viewParams:n}))},e.prototype.getPhotoStreamShareIdUrl=function(e){var t,n=((t={}).id="root",t.qt="photostream",t.v="photoStream",t.psShareId=e,t);return this.getCurrentPageBaseUrl()+"?"+m.n(n,null,!0)},e.prototype.getPhotoStreamForMojsQueryUrl=function(e,t,n){var a,i=Object(r.__assign)({},this._navigation.viewParams);return delete i.psShareId,this._requireAuthentication(this.getItemUrl(this.getKey(((a={}).qt="photostream",a.v="photoStream",a.mojDate=e,a.moj=t,a.psRIds=n.join(","),a)),{page:s.e.PhotoStream,viewParams:i}))},e.prototype.getAllMyPhotosQueryUrl=function(t){var n;return this._requireAuthentication(this.getItemUrl(this.getKey(((n={}).qt="allmyphotos",n.id=t,n.cid=e.viewerId,n)),{page:s.e.Photos}))},e.prototype.getAlbumsQueryUrl=function(e){var t;return this._requireAuthentication(this.getItemUrl(this.getKey(((t={}).id="albums",t)),{page:s.e.Photos}))},e.prototype.getTagsQueryUrl=function(e){var t;return this._requireAuthentication(this.getItemUrl(this.getKey(((t={}).id="tags",t)),{page:s.e.Photos}))},e.prototype.getPlacesQueryUrl=function(e){var t;return this._requireAuthentication(this.getItemUrl(this.getKey(((t={}).id="places",t)),{page:s.e.Photos}))},e.prototype.getOnThisDayQueryUrl=function(e,t){var n,a;return this._requireAuthentication(this.getItemUrl(this.getKey(((n={}).qt="allmyphotos",n.onThisDay=!0,n)),{page:s.e.Photos,additionalViewParams:(a={},a.sc=e&&e.sc||"",a)}))},e.prototype.getOnThisMonthQueryUrl=function(e){var t,n;return this._requireAuthentication(this.getItemUrl(this.getKey(((t={}).qt="allmyphotos",t.onThisMonth=!0,t.useUtilityFiltering=e.useUtilityFiltering,t)),{page:s.e.Photos,additionalViewParams:(n={},n.sc=e&&e.sc||"",n)}))},e.prototype.getLastWeekPreviousYearsQueryUrl=function(e){var t,n;return this._requireAuthentication(this.getItemUrl(this.getKey(((t={}).qt="allmyphotos",t.lastWeekPreviousYears=!0,t.useUtilityFiltering=e.useUtilityFiltering,t)),{page:s.e.Photos,additionalViewParams:(n={},n.sc=e&&e.sc||"",n)}))},e.prototype.getRecentPhotoUrl=function(e){var t,n;return this._requireAuthentication(this.getItemUrl(this.getKey(((t={}).parQt=e.parQt,t.id=e.id,t.cid=e.cid,t)),{page:s.e.Photos,additionalViewParams:(n={},n.sc=e&&e.sc||"",n)}))},e.prototype.getAllPhotosForPlaceUrl=function(e,t){var n;return this.getItemUrl(this.getKey(((n={}).id=t,n.locationFilter=e,n.qt="allmyphotos",n)),{page:s.e.Photos})},e.prototype.getSharedByQueryUrl=function(){var e;return this._requireAuthentication(this.getItemUrl(this.getKey(((e={}).qt="sharedby",e)),{page:s.e.Files}))},e.prototype.getSharedByYouQueryUrl=function(){var e,t=this.resources.consume(R.e);return this._requireAuthentication(this.getItemUrl(this.getKey(((e={}).qt=t?"sharedbyme":"sharedby",e)),{page:s.e.Files}))},e.prototype.getOneDriveAppsUrl=function(){return"https://g.live.com/8SESkyDrive/SkyDriveApps?biciid=lhnlink"},e.prototype.getOptionsUrl=function(e){return void 0===e&&(e=this._navigation.viewParams),this.getNewManageStorageUrl()},e.prototype.getManageStorageUrl=function(){return this.getCurrentPageBaseUrl()+"/options/ManageStorage"},e.prototype.getPhotoPreferencesUrl=function(){var e,t=((e={}).v="photopreferences",e),n="#"+m.n(t,null,!0);return this._requireAuthentication(n)},e.prototype.getManageVaultUrl=function(){var e,t=((e={}).v="ManageVault",e),n="#"+m.n(t,null,!0);return this._requireAuthentication(n)},e.prototype.getTagPreferencesUrl=function(){var e,t=((e={}).v="tagpreferences",e),n="#"+m.n(t,null,!0);return this._requireAuthentication(n)},e.prototype.getOfficeFileOptionsUrl=function(){var e;if(Object(p.isFeatureEnabled)(p.EnableVroomDocFormatSettings)&&Object(U.e)(E.B)){var t=((e={}).v="documentoptions",e),n="#"+m.n(t,null,!0);return this._requireAuthentication(n)}return this.getCurrentPageBaseUrl()+"/options/DocumentOptions"},e.prototype.getPhotosOptionsUrl=function(){return this.getCurrentPageBaseUrl()+"/options/PeopleOptions"},e.prototype.getUpgradeOptionsUrl=function(e,t){return this.getNewUpgradeOptionsUrl(e,this._navigation.viewParams,t)},e.prototype.getNotificationOptionsUrl=function(){var e;if(Object(H.a)()){var t=((e={}).v="NotificationOptions",e),n="#"+m.n(t,null,!0);return this._requireAuthentication(n)}return this.getCurrentPageBaseUrl()+"/options/NotificationOptions"},e.prototype.getDeviceBackupsOptionsUrl=function(){return this.getCurrentPageBaseUrl()+"/options/DeviceBackups"},e.prototype.getSearchOptionsUrl=function(){return this.getCurrentPageBaseUrl()+"/options/Search"},e.prototype.getNewManageStorageUrl=function(e){var t;void 0===e&&(e=this._navigation.viewParams);var n=((t={}).ocid=e.ocid||e["WT.mc_id"],t.v="managestorage",t),a="#"+m.n(n,null,!0);return this._requireAuthentication(a)},e.prototype.getNewUpgradeOptionsUrl=function(e,t,n){return void 0===t&&(t=this._navigation.viewParams),Object(E.I)({wtcParam:e,viewParams:t,hideLeftNav:n})},e.prototype.getNewRestoreOptionsUrl=function(e,t){var n;void 0===t&&(t=this._navigation.viewParams);var a=((n={}).ocid=t.ocid||t["WT.mc_id"]||e,n.v="restore",n),i="#"+m.n(a,null,!0);return this._requireAuthentication(i)},e.prototype.getTaggingOptionsUrl=function(){return"/options/PeopleOptions"},e.prototype.getPeopleApiUrl=function(t){var n={prefix:t};return e.peopleBaseUrl+"/directory/search?"+m.n(n)},e.prototype.getUserInfoApiUrl=function(){return Object(T.e)()},e.prototype.setUserInfoApiUrl=function(){return Object(T.t)()},e.prototype.getPublishToWalgreensUrl=function(){return e.skyApiBaseUrl+"PublishToWalgreens"},e.prototype.getDownloadUrl=function(e,t){void 0===t&&(t=this._navigation.viewParams);var n=e.ownerId,a=this.getAuthKeyParamValue(t),i=this.getTicketParamValue(t),r=D.t.canary,o={cid:n,authKey:a,ticket:i,resid:e.id,canary:r};if(e.video){var s=Math.ceil((1.25*e.video.duration||0)/6e4);o.duration=Math.min(Math.max(1,s)+60,1440)}return this.getCurrentPageBaseUrl()+"/GetDownloadUrl?"+m.n(o,null,!0)},e.prototype.getEmbedInfoUrl=function(t){var n={id:t.id};return e.skyApiBaseUrl+"GetEmbedInfo?"+m.n(n,null,!0)},e.prototype.getEmbedPageUrl=function(e){var t={cid:e.ownerId,resid:e.id};return this.getCurrentPageBaseUrl()+"/embed?"+m.n(t,null,!0)},e.prototype.getPermissionsUrl=function(t,n){var a;void 0===n&&(n=this._navigation.viewParams);var i=this.getAuthKeyParamValue(n),r=((a={}).id=t.id,a);return i&&(r.authkey=i),e.skyApiBaseUrl+"GetPermissions?"+m.n(r)},e.prototype.getSearchQueryUrl=function(e,t){var n,a=e.query,r=e.dateFilter,o=e.conversationId,s=e.largestSize,c=e.filter;c||(c=Object(E.P)(this._navigation.viewParams)?b.t.photos:b.t.all);var d=((n={}).qt="search",n.q=a,n.searchsessionid=o,n.ft=E.e[b.t[c]],n);if("number"==typeof r&&r!==b.e.anyDate){var l=new Date,u=this._getDateDuration(r,l);d.df=i[i.DateCreated],d.beginDate=u.toISOString(),d.endDate=l.toISOString()}return s&&(d.sp="size"),this.getItemUrl(this.getKey(d),t)},e.prototype.getSearchFilterQueryUrl=function(e,t){return void 0===t&&(t=this._navigation.viewParams),this.getSearchQueryUrl({query:t.q,conversationId:t.searchsessionid,filter:e,dateFilter:this.getAppliedDateFilter()})},e.prototype.isSearchFilterApplied=function(e,t){return void 0===t&&(t=this._navigation.viewParams),this.getContextualFilter(t)===String(E.e[b.t[e]])},e.prototype.getSearchByDateFilterQueryUrl=function(e,t){return void 0===t&&(t=this._navigation.viewParams),this.getSearchQueryUrl({query:t.q,conversationId:t.searchsessionid,filter:b.t[String(E.e[this.getContextualFilter(t)])],dateFilter:e})},e.prototype.isSearchByDateFilterApplied=function(e){return this.getAppliedDateFilter()===e},e.prototype.getAutoActionType=function(e){if(this._useRefactoredDefaultClickUrl)return Object(E.r)(e);var t=e.action||"";return u.e[t.toLowerCase()]||u.t.none},e.prototype.getQueryParamValue=function(e){return void 0===e&&(e=this._navigation.viewParams),e.q},e.prototype.getCommentIdParamValue=function(e){return void 0===e&&(e=this._navigation.viewParams),e.commentId},e.prototype.getLayoutContentType=function(t){void 0===t&&(t=this._navigation.viewParams);var n=t.layout;return n&&e.contentTypeByLayoutType[n]},e.prototype.getItemTypeFilter=function(e){var t=[],n=Number(e.ft)||0;7==(7&n)&&t.push(S.e.folder),16==(16&n)&&t.push(S.e.document),8==(8&n)&&t.push(S.e.media);for(var a=0,i=(e.ext||"").split(";");a<i.length;a++){var r=i[a];t.push(r)}return{filters:t}},e.prototype.saveItemTypeFilter=function(e){return void 0===e&&(e={filters:[]}),Object(E.N)(e)},e.prototype.getUsersFilter=function(e){var t=e.userFilters;return t&&t.split(";#")},e.prototype.saveUsersFilter=function(e){var t={};return t.userFilters=e&&e.join(";#"),t},e.prototype.saveDateDurationFilter=function(e){return{}},e.prototype.getDateDurationFilter=function(e){return""},e.prototype.getIAmValue=function(e){return void 0===e&&(e=this._navigation.viewParams),e.iam},e.prototype.getFeedbackUrl=function(){return e.skyApiBaseUrl+"GetFeedBackUrl"},e.prototype.getCidFromResourceId=function(e){return void 0===e&&(e=this._navigation.viewParams),Object(L.n)(e)},e.prototype.getCreateTextDocumentUrl=function(t,n,a){void 0===a&&(a=this._navigation.viewParams);var i={};i.id=t,i.cid=n,i.iam=this.getIAmParamValue(a),i.action=e.createTextDocumentActionValue,i.v="TextFileEditor";var r=m.n(i,null,!0);return this._getCurrentPageUrl(2,r)},e.prototype.getCreateDocumentInTabUrl=function(e,t,n,a){var i;void 0===a&&(a=this._navigation.viewParams);var r,o=this.getAuthKeyParamValue(a),s=this.getTicketParamValue(a),c=this.getIAmParamValue(a),d=a.qt,l=1===e.documentFormat?"odf":"",f=((i={}).cid=e.ownerId,i.wacqt=d||"",i.wdo=1,i);if(n){r="?",f.id=e.id;var p=void 0;switch(t){case"w":p=u.t.createWord;break;case"x":p=u.t.createExcel;break;case"p":p=u.t.createPowerPoint;break;case"n":p=u.t.createOneNote}f.action=p&&u.t[p].toLowerCase()||""}else r="/create.aspx?",f.parId=e.id,f.nd=t+l;return o&&(f.authkey=o),s&&(f.ticket=s),c&&(f.iam=c),r+m.n(f)},e.prototype.getDownloadItemUrl=function(e,t,n,a){if(void 0===a&&(a=this._navigation.viewParams),e.processFilters)return e.processFilters.thumbnailUrl;var i=this.getAuthKeyParamValue(a),r=this.getTicketParamValue(a),o=this.getIAmParamValue(a),s={cid:e.ownerId,authKey:i,ticket:r,iam:o,resid:e.id,canary:t,ithint:e.extension&&e.extension.toLowerCase(),open:n||void 0};return this.getCurrentPageBaseUrl()+"/download.aspx?"+m.n(s,null,!0)},e.prototype.getPrintPdfUrl=function(e,t){void 0===t&&(t=this._navigation.viewParams);var n=this.getAuthKeyParamValue(t),a=this.getTicketParamValue(t),i=this.getIAmParamValue(t),r=D.t.canary,o={cid:e.ownerId,authKey:n,ticket:a,iam:i,resid:e.id,canary:r,ithint:e.extension&&e.extension.toLowerCase(),open:1,serve:1};return this.getCurrentPageBaseUrl()+"/pdf?"+m.n(o,null,!0)},e.prototype.getVersionHistoryUrl=function(e,t,n){void 0===n&&(n=this._navigation.viewParams);var a={cid:e,resid:t,iam:this.getIAmParamValue(n)};return"/versions.aspx?"+m.n(a,null,!0)},e.prototype.getOpenInOfficeOnlineUrl=function(e,t,n){void 0===n&&(n={});var a,i=n.forceReadOnly,r=void 0!==i&&i,o=e.properties.commandsSupported,s=(void 0===o?{}:o).defc,c=e.openUrl;a=r?"view.aspx":"2"===s?"edit.aspx":"view.aspx";var d=Object(g.a)(e),l=c.indexOf("?")>0?"&":"?";return c.replace("redir.aspx",a).replace("download.aspx",a)+l+m.n({app:d,wdo:1,wacqt:t.qt},null,!0)},e.prototype.getOpenInOfficeClientUrl=function(e,t,n){var a,i,r;if(void 0===t&&(t=this._navigation.viewParams),!N.e.isActivated("C1567AF7-26C3-4CFC-A439-2A58F8558245","07/18/2022","open history file in office client")&&Object(p.isFeatureEnabled)(p.ConvergenceEnabled)&&Object(U.e)(e.ownerId)){var o=null!==(i=null===(a=e.properties)||void 0===a?void 0:a.path)&&void 0!==i?i:null===(r=e.itemFromServer)||void 0===r?void 0:r.webDavUrl;return Object(B.t)(e.appMap,o,e.extension,!0,!1)}var s=this.getAuthKeyParamValue(t),c=this.getIAmParamValue(t),d={cid:n,resid:e.id,authKey:s,iam:c,autoRedirect:"false"};return this.getCurrentPageBaseUrl()+"/openinclient?"+m.n(d,null,!0)},e.prototype.getNewInOfficeClientUrl=function(e,t,n){return""},e.prototype.getDownloadAsZipIframeUrl=function(e,t){void 0===t&&(t=this._navigation.viewParams);var n={canary:e,iam:this.getIAmParamValue(t)};return this.getCurrentPageBaseUrl()+"/downloadasziplanding?"+m.n(n,null,!0)},e.prototype.getDownloadAsZipPostUrl=function(t,n,a){void 0===a&&(a=this._navigation.viewParams);var i=_.format(e.storageBaseUrl+"/downloadfiles/V1/Zip",t),r=a,o={authKey:r.authkey,ticket:r.ticket,iam:this.getIAmParamValue(r),application:n};return i+"?"+m.n(o,null,!0)},e.prototype.getOwnerId=function(t,n){return this.getKeyParams(t||this.getCurrentItemKey(n)).cid||e.viewerId},e.prototype.getSharedByUrl=function(e,t,n){var a,i;return this.getItemUrl(this.getKey(Object(r.__assign)(((a={}).qt="sharedby",a.id=e,a.cid=t,a),n?((i={}).groupId=n,i):{})))},e.prototype.getExternalUrl=function(t){var n=f.e[t];if(!n)throw new Error("Invalid external alias provided to fetch external url.");return this.getCurrentPageBaseUrl()+e.EXTERNAL_URL_FORMAT+n},e.prototype.getUploadStorageUrl=function(t,n){return"root"===t.id?_.format(e.storageBaseUrl,[t.ownerId])+"/MyCIDStuff/0x"+t.ownerId+"/LiveFolders/"+h.e.encodeURIComponent(n):_.format(e.storageBaseUrl,[t.uploadOwnerId])+"/items/"+t.id+"/"+h.e.encodeURIComponent(n)},e.prototype.getAppSubfolder=function(){return"odc"},e.prototype.getDefaultClickUrl=function(e,t){var n,a,i,s;void 0===t&&(t={});var c,d=t.viewParams,l=void 0===d?this._navigation.viewParams:d,f=t.itemSet,p=t.urlType,_=void 0===p?"default":p,h=t.preserveAction,b=void 0!==h&&h,g=t.action,v=void 0===g?b&&this.getAutoActionType(l)||void 0:g;if(!e||!e.key)return"";if(l.sb&&(!this.isCurrentQuery(e.queryType,l)||(e=Object(r.__assign)(Object(r.__assign)({},e),{key:m.n(Object(r.__assign)(Object(r.__assign)({},m.e(e.key)),(n={},n.sb=l.sb,n.sd=l.sd,n)))}))),l.mcid&&this.getKeyParams(e.key).cid===(l.cid||l.parCid)&&(e=Object(r.__assign)(Object(r.__assign)({},e),{key:m.n(Object(r.__assign)(Object(r.__assign)({},m.e(e.key)),(a={},a.mcid=l.mcid,a.mid=l.mid,a)))})),this._useRefactoredDefaultClickUrl){var y=null===(s=null===(i=null==e?void 0:e.properties)||void 0===i?void 0:i.commandsSupported)||void 0===s?void 0:s.defc,S=f&&f.item.peek(),D=S&&S.key!==e.key&&S||e.UNSAFE_parent,I=D&&D.key,x=void 0;y&&(x="1"===y);var C={itemInfo:{itemKey:e.key,itemIsStub:e.isStub,itemIsPlaceholder:e.isPlaceholder,itemIsPhoto:!!e.photo,itemIsVideo:!!e.video,itemVirtualItemType:e.virtualItemType,itemExtension:e.extension,itemType:e.type,itemOpenUrl:e.openUrl,itemErrorType:e.error&&e.error.type,openItemByDefault:x},parentItemInfo:D&&{itemKey:I,itemIsAlbum:D.isAlbum,itemIsPlaceholder:D.isPlaceholder,itemIsStub:D.isStub,itemVirtualItemType:D.virtualItemType,itemExtension:D.extension,itemType:D.type,itemOpenUrl:D.openUrl,itemErrorType:D.error&&D.error.type},preserveAction:b,action:v,viewParams:l,page:t.page,useOneUpTextEditor:this._useOneUpTextEditor,queryType:e.queryType,additionalViewParams:t.additionalViewParams,urlType:_};return Object(P.t)(C)}var O=this._getDefaultUrlFormat(e),w=!!N.e.isActivated("CBF950BB-C412-4331-9430-066677E49966","10/21/2021","Compute OneUp URL for media items in mount points")||e.type!==o.e.Media;return l.mid&&w&&(O=P.e.current),c=e.type===o.e.Error?P.e.external:"existing"===_?this._getCurrentUrlFormat(l):"focus"===_||v?v&&v!==u.t.locate&&O===P.e.current?O:P.e.focus:O,this._getItemClickUrl(e,f,c,t)},e.prototype.getTagUrl=function(e){var t,n;return n=e.localizedTag&&e.localizedTag!==e.tag?"".concat(e.localizedTag,";").concat(e.tag):e.tag,this._requireAuthentication(this.getItemUrl(this.getKey(((t={}).qt="allmyphotos",t.tagFilter=n,t)),{page:s.e.Photos}))},e.prototype.getAuthenticateUrl=function(e){if(this._useRefactoredDefaultClickUrl)return Object(E.i)(e);var t=D.t.signInUrl;return window.location.href.indexOf("iam=")>-1?(t+="&redirect_uri={0}",e=this.getCurrentPageBaseUrl()+"/business"):t+="&ru={0}&wreply={0}",_.format(t,h.e.encodeURIComponent(e||window.location.href))},e.prototype.getLanguageWithAuthenRedirectUrl=function(){return Object(E.S)()},e.prototype.getRootUrl=function(e){var t;void 0===e&&(e=this._navigation.viewParams);var n=((t={}).iam=this.getIAmParamValue(e),t);return this.getCurrentPageBaseUrl()+"?"+m.n(n,null,!0)},e.prototype.getCurrentSiteUrl=function(){return window.location.href},e.prototype.getCurrentPageBaseUrl=function(){return window.location.protocol+"//"+window.location.host},e.prototype.getMarketBlockedUrl=function(){return this._useRefactoredDefaultClickUrl?Object(E.D)():this.getCurrentPageBaseUrl()+"/marketblockerror.aspx"},e.prototype.getValidatePermissionUrl=function(){if(this._useRefactoredDefaultClickUrl)return Object(E.M)(this._navigation.viewParams);var e={};return e.id=this._navigation.viewParams.id,e.challengeToken=this._navigation.viewParams.authkey,e.v="validatepermission",this.getCurrentPageBaseUrl()+"?"+m.n(e,null,!0)},e.prototype.getRequestAccessUrl=function(){if(this._useRefactoredDefaultClickUrl)return Object(E.E)(this._navigation.viewParams);var e={};return e.id=this._navigation.viewParams.id,e.challengeToken=this._navigation.viewParams.authkey,e.v="requestaccess",this.getCurrentPageBaseUrl()+"?"+m.n(e,null,!0)},e.prototype.handleFatalErrorDuringViewLoad=function(){0===document.cookie.indexOf("sr=3")||document.cookie.indexOf("; sr=3")>-1?this._setFatalErrorCookie(0,!0):0===document.cookie.indexOf("sr=2")||document.cookie.indexOf("; sr=2")>-1?(this._setFatalErrorCookie(3,!1),window.top.location=document.location.href):0===document.cookie.indexOf("sr=")||document.cookie.indexOf("; sr=")>-1?(this._setFatalErrorCookie(2,!1),location.reload(!0)):(this._setFatalErrorCookie(1,!1),window.top.location=document.location.href)},e.prototype.getForceLoginDownloadUrl=function(e){var t="https://"+location.host+"?"+this.getDefaultClickUrl(e.UNSAFE_parent).substring(1);return this.getAuthenticateUrl(t)},e.prototype.getItemUrl=function(e,t){if(void 0===t&&(t={}),this._useRefactoredDefaultClickUrl){var n=t.viewParams,a=void 0===n?this._navigation.viewParams:n,i=t.item;return Object(E.g)(Object(r.__assign)(Object(r.__assign)({},t),{itemKey:e,itemInfo:i&&{itemKey:i.key,itemIsPlaceholder:i.isPlaceholder,itemVirtualItemType:i.virtualItemType,itemExtension:i.extension,itemType:i.type},viewParams:a}))}var o=this._getItemQueryParams(e,t),s=t.additionalViewParams;return s&&s.sc?Object(F.e)(o,s):delete o.sc,"#"+m.n(o,null,!0)},e.prototype.getSuiteNavConfigUrl=function(e){var t;void 0===e&&(e=this._navigation.viewParams);var n=((t={}).iam=this.getIAmParamValue(e),t);return"/getsuitenavconfig?"+m.n(n,null,!0)},e.prototype.getApiName=function(){return"Vroom"},e.prototype.getApiBaseUrl=function(t){return e.getVroomBaseUrl(t)},e.prototype.getAppliedDateFilter=function(e){var t;if(void 0===e&&(e=this._navigation.viewParams),!e.df)return b.e.anyDate;var n=(Date.parse(e.endDate)-Date.parse(e.beginDate))/864e5;switch(Math.floor(n)){case 1:t=b.e.oneDay;break;case 30:t=b.e.oneMonth;break;case 7:t=b.e.oneWeek;break;case 365:t=b.e.oneYear}return t},e.prototype.getResourcePreloadUrl=function(){return"/preload?manifest=wac"},e.prototype.getHipCheckUrl=function(){return"https://mail.".concat(j?"live-int":"live",".com/?rru=hip")},e.prototype.getVerifyAccountUrl=function(){return"https://g.live.com/8SESkydrive/VerifyAccount"},e.prototype.isSearchPassThrough=function(e){return void 0===e&&(e=this._navigation.viewParams),!!e.sp},e.prototype.isLargestFilesView=function(e){return void 0===e&&(e=this._navigation.viewParams),"size"===e.sp},e.prototype.getNavLinkClickUrl=function(e){return""},e.prototype.qualifyUrl=function(e){return this._useRefactoredDefaultClickUrl?Object(E.H)(e):(0===e.indexOf("#")&&(e=this._getCurrentPageUrl(2,e.substring(1))),e)},e.prototype.getSignInUrlWithAction=function(e,t){var n=t||D.t.si;if(!n)return"";var a=v.t(n),i=m.e(a),r=i.wreply,o=v.t(r),s=m.e(o);return s.action=u.t[e],i.wreply="".concat(v.n(r),"?").concat(m.n(s)),"".concat(v.n(n),"?").concat(m.n(i))},e.prototype.getNewPlaceholderItemKey=function(){var t;return m.n(((t={}).id="placeHolder ".concat(e.placeholderId++),t))},e.prototype.getIAmParamValue=function(e){return void 0===e&&(e=this._navigation.viewParams),e.iam},e.prototype.getAuthKeyParamValue=function(e){return void 0===e&&(e=this._navigation.viewParams),Object(E.a)(e)},e.prototype.getTicketParamValue=function(e){return void 0===e&&(e=this._navigation.viewParams),e.ticket},e.prototype.getReferrer=function(e){return void 0===e&&(e=this._navigation.viewParams),e.referrer},e.prototype.getContextualFilter=function(e){return void 0===e&&(e=this._navigation.viewParams),this._useRefactoredDefaultClickUrl?Object(L.a)(e):e.ft},e.prototype.getMyRestorePageUrl=function(){return Promise.resolve("")},e.prototype.getTextEditorItemUrl=function(e,t){var n=t.parentItem,a=t.viewParams;if(this._useRefactoredDefaultClickUrl)return Object(P.a)({itemInfo:{itemKey:e.key,itemExtension:e.extension,itemType:e.type},parentItemInfo:n&&{itemKey:n.key},viewParams:a});var i=this._getItemQueryParams(e.key,{item:e,page:s.e.TextFileEditor,viewParams:a}),r=n||e.UNSAFE_parent,o=this.getKeyParams(r&&r.key||"");i.parId=o.id;var c=m.n(i,null,!0);return"TextFileEditor"!==a.v?this._getCurrentPageUrl(2,c):"#"+c},e.prototype.getQueryUrl=function(e,t){return this._requireAuthentication(this.getItemUrl(this.getRootItemKey(t),{page:e}))},e.prototype.getMpcOneDriveUrl=function(){return"".concat(G,"/personal/").concat(e.viewerId,"/_layouts/15/onedrive.aspx")},e.prototype._getItemQueryParams=function(e,t){var n=void 0===t?{}:t,a=n.item,i=n.page,o=n.action,s=n.preserveAction,f=void 0!==s&&s,p=n.viewParams,m=void 0===p?this._navigation.viewParams:p,_=this.getKeyParams(e),h=Object(r.__assign)({},_),b=this._getPreservedViewParams(m);void 0!==i&&(b.v=this._getPageParamValue(i,m));var g=!1,v=Object(w.a)(a);if(a&&!a.isPlaceholder)switch("TextFileEditor"===b.v&&(v||(b.v="")),a.virtualItemType){case l.e.Album:case l.e.AlbumRoot:case l.e.Tag:case l.e.TagsRoot:b.v="photos",g=!0}else switch(h.id){case"tags":case"places":case"albums":b.v="photos",g=!0}"allmyphotos"===_.qt&&(h.v="photos",g=!0,"true"!==_.onThisDay&&"true"!==_.onThisMonth&&"true"!==_.lastWeekPreviousYears||(m&&m.startDate&&(h.startDate=m.startDate),m&&m.cid&&(h.cid=m.cid))),"photostream"===_.qt&&(h.v="photoStream",h.psShareId=m.psShareId);var y=this.getQueryType(_);v||!a||g||y===c.e.Search||y===c.e.AllMyPhotos||y===c.e.PhotoStream||(h.v=""),v||!Object(d.e)(y)||"photos"===b.v&&"photoStream"===b.v&&this.getContextualFilter(_)===E.e.photos.toString()||(h.v=""),this._isFilePickerPage(b.v)&&(h.v=b.v),delete h.u;var S=this.getAutoActionType(m);return o?h.action=o&&u.t[o]&&u.t[o].toLowerCase()||"":f&&S&&(S===u.t.showProperties&&h.o||(h.action=u.t[S].toLowerCase())),Object(F.e)(b,h),b},e.prototype._getDateDuration=function(e,t){var n=new Date(t.toString())||new Date;switch(e){case b.e.oneDay:n.setDate(n.getDate()-1);break;case b.e.oneMonth:n.setDate(n.getDate()-30);break;case b.e.oneWeek:n.setDate(n.getDate()-7);break;case b.e.oneYear:n.setDate(n.getDate()-365)}return n},e.prototype._setFatalErrorCookie=function(e,t){var n="sr="+e+"requireDeps;path=/;domain="+window.$Config.urlHost+";";t&&(n+="expires="+new Date(2e3,1,1).toUTCString()+";"),document.cookie=n},e.prototype._getCurrentUrlFormat=function(e){return void 0===e&&(e=this._navigation.viewParams),this.getFocusItemKey(e)?P.e.focus:P.e.current},e.prototype._getDefaultUrlFormat=function(e){var t;switch(e.type){case o.e.Media:t=P.e.focus;break;case o.e.Folder:case o.e.Error:t=P.e.current;break;default:t=P.e.external}return t},e.prototype._getItemClickUrl=function(e,t,n,a){var i=a.viewParams,r=void 0===i?this._navigation.viewParams:i,o=a.page,c=void 0===o?this.getPageType(r):o;if(n!==P.e.current&&c===s.e.FilePicker)return"";var d,l=this.getKeyParams(e.key);if(this.isRecycleBin(e.queryType)&&!this.isRecycleBin(this.getQueryType(l)))return"";if(Object(w.a)(e))n=this._useOneUpTextEditor&&c!==s.e.TextFileEditor?P.e.focus:P.e.external;else if(c===s.e.TextFileEditor&&this.getAutoActionType(r)===u.t.createTextDocument)return"#"+m.n(r,null,!0);switch(n){case P.e.current:d=this._getCurrentItemUrl(e,a);break;case P.e.focus:d=this._getFocusItemUrl(e,t,a);break;default:d=this._getDefaultItemUrl(e,{itemSet:t,viewParams:r})}return d},e.prototype._getCurrentItemUrl=function(e,t){var n=void 0===t?{}:t,a=n.preserveAction,i=n.action,r=n.viewParams,o=void 0===r?this._navigation.viewParams:r,s=n.page,c=n.additionalViewParams;if(e.isStub){var d=this.getFocusItemKey(o);if(d)return this.getAutoActionType(o)===u.t.locate?"":this._getFocusItemUrlFromKey(d,e,{action:u.t.locate,viewParams:o})}return this.getItemUrl(e.key,{item:e,preserveAction:a,action:i,viewParams:o,page:s,additionalViewParams:c})},e.prototype._getFocusItemUrl=function(t,n,a){var i,r=this._getParentItem(t,n),o=!!a.viewParams&&Boolean("photos"===a.viewParams.v&&(t.video||t.photo)&&"allmyphotos"!==a.viewParams.qt&&!a.viewParams.parId&&!a.viewParams.parQt&&r&&!r.isAlbum),s={key:this.getKey((i={},i.qt="allmyphotos",i.id="root",i.cid=e.viewerId,i))};return this._getFocusItemUrlFromKey(t.key,o?s:r,a)},e.prototype._getFocusItemUrlFromKey=function(t,n,a){var i=void 0===a?{}:a,r=i.preserveAction,o=void 0!==r&&r,s=i.action,c=i.viewParams,d=void 0===c?this._navigation.viewParams:c,l=i.additionalViewParams,u=n&&n.key||"",f=this.getKeyParams(t),p=this._getItemQueryParams(u,{item:n,preserveAction:o,action:s,viewParams:d});d&&d.commentId&&(f.commentId=d.commentId),f.parId=p.id,f.parQt=p.qt,f.cid!==p.cid&&(f.parCid=p.cid,delete p.cid),delete p.internalPath,delete p.qt,delete p.id,delete f.u;var _=p.action;return _?d&&d.commentId&&"showproperties"===_.toLowerCase()?(delete p.action,f.o=e.oneUpOverlayValue):(delete p.action,f.action=_):f.o=e.oneUpOverlayValue,l&&Object(F.e)(f,l),"#"+m.n(f,p,!0)},e.prototype._getPageParamValue=function(e,t){var n,a=t.v;switch(e){case s.e.FilePicker:n=this._isFilePickerPage(a)?a:"FilePickerView";break;case s.e.TextFileEditor:n="TextFileEditor";break;case s.e.Photos:n="photos";break;case s.e.RansomwareDetection:n="RansomwareDetection";default:case s.e.Files:}return n},e.prototype._getErrorItemUrl=function(t,n){var a;switch(void 0===n&&(n=this._navigation.viewParams),t&&t.error&&t.error.type||0){case 3:return this.getMarketBlockedUrl();case 5:return this.qualifyUrl(this.getItemUrl(t.key));case 2:var i=n.lor;return i&&i.toLowerCase()===e.linkOriginParamValue?"?".concat("v","=").concat("error","&").concat("type","=").concat(e.linkNotSupportedParamValue):this._requireAuthentication(this.getItemUrl(t.key,{viewParams:n,additionalViewParams:(a={},a.sc=n.sc||"",a)}));case 1:return this._requireAuthentication(this.getItemUrl(t.key,{viewParams:n}),!0);case 4:var r=this.getAutoActionType(n)===u.t.feedback?u.t.feedback:void 0;return D.t.si?this._requireAuthentication(this.getItemUrl(t.key,{viewParams:n,action:r}),!0):this.getItemUrl(t.key,{action:r});case 6:return this.getValidatePermissionUrl();case 9:return this.getRequestAccessUrl()}return this.getItemUrl(t.key)},e.prototype._getDefaultItemUrl=function(e,t){var n,a,i=void 0===t?{}:t,r=i.itemSet,s=i.viewParams,c=void 0===s?this._navigation.viewParams:s,d=this._getParentItem(e,r);if(e.type===o.e.Error)a=this._getErrorItemUrl(e,c);else if(Object(w.a)(e))a=this.getTextEditorItemUrl(e,{parentItem:d,viewParams:c});else{var l=null===(n=null==e?void 0:e.properties)||void 0===n?void 0:n.commandsSupported,f=(null==l?void 0:l.defc)||"";a=f&&"1"!==f?this._getFocusItemUrl(e,r,{action:u.t.defaultClick,viewParams:c}):"1"===f&&e.openUrl&&(-1===e.openUrl.indexOf("redir.aspx")||e.extension&&(".fluid"===e.extension.toLowerCase()||".loop"===e.extension.toLowerCase()))?e.openUrl:this._getFocusItemUrl(e,r,{action:u.t.locate,viewParams:c})}return a},e.prototype._getCurrentPageUrl=function(t,n){if(this._useRefactoredDefaultClickUrl)return Object(E.c)(t,n);var a=[];switch(a.push(this.getCurrentPageBaseUrl()),t){case 0:a.push("/");break;case 1:a.push(e.nextSiteUrlPrefix);break;default:a.push(this._getCurrentUrlPathName())}return a.push("?"),a.push(n),a.join("")},e.prototype._getCurrentUrlPathName=function(){return this._useRefactoredDefaultClickUrl?Object(E.d)():window.location.pathname},e.prototype._getPreservedViewParams=function(e){var t;void 0===e&&(e=this._navigation.viewParams);var n=((t={}).iam=e.iam,t.ticket=e.ticket,t.authkey=e.authkey,t.v=e.v,t.invref=e.invref,t.invsrc=e.invsrc,t.client_id=e.client_id,t.scope=e.scope,t.domain=e.domain,t.referrer=e.referrer,t.crid=e.crid,t.auth=e.auth,t.picker=e.picker,t.filePicker=e.filePicker,t.expectsBusiness=e.expectsBusiness,t.sc=e.sc,t);for(var a in e)0===a.indexOf("EXPExperimentTest_e")&&(n[a]=e[a]);var i=e["WT.mc_id"],r=e.ocid;return i&&(n["WT.mc_id"]=i,n.ocid=r||i),n},e.prototype._isFilePickerPage=function(e){var t;switch(e){case"FilePickerView":case"2":case"FolderPickerView":case"1":case"pickerconsent":t=!0;break;default:t=!1}return t},e.prototype._requireAuthentication=function(e,t){return void 0===t&&(t=!1),this._useRefactoredDefaultClickUrl?Object(E.R)(e,t):t||D.t.si?this.getAuthenticateUrl(this.qualifyUrl(e)):e},e.prototype._getParentItem=function(e,t){var n=t&&t.item.peek();return n&&n.key!==e.key&&n||e.UNSAFE_parent},e.dependencies={navigation:O.e,useOneUpTextEditor:q,useRefactoredDefaultClickUrl:Q,enableFastOneUp:Y},e.oneUpOverlayValue=k.i,e.EXTERNAL_URL_FORMAT="/externalredirector?alias=",e.skyApiBaseUrl=V+"/API/2/",e.viewerId=E.B,e.storageBaseUrl=z,e.feedbackBaseUrl="https://cid-{0}.users.storage.live.com",e.tagsFeedbackBaseUrl="https://storage.live.com",e.peopleBaseUrl="https://people.onedrive.com",e.nextSiteUrlPrefix=k.a,e.scenarioName="odweb",e.locateActionName="locate",e.linkOriginParamValue="shorturl",e.linkNotSupportedParamValue="linknotsupported",e.createTextDocumentActionValue="createTextDocument",e.contentTypeByLayoutType=((a={}).photo=y.i,a.list=y.a,a.grid=y.n,a),e.placeholderId=0,e}();t.t=J;var X=Object(x.r)("UrlDataSource",J)},1454:function(e,t,n){"use strict";var a=n(1950);n.d(t,"e",function(){return a.e})},1462:function(e,t,n){"use strict";n.r(t),n.d(t,"OperationProvider",function(){return p}),n.d(t,"resourceKey",function(){return m});var a=n(0),i=n(1295),r=n(1370),o=n(1479),s=n(1359),c=n(1725),d=function(e){function t(t){var n=e.call(this,{})||this,i=n.observables;n.name=t.name,n.iconName=t.iconName,n.state=i.create(r.e.created),n.warning=i.create(""),n.error=i.create(),n.count=i.create(1);var c=Object(a.__assign)({minimum:0,maximum:0,current:0},t.progress||{});return n.progress={minimum:i.create(c.minimum),maximum:i.create(c.maximum),current:i.create(c.current)},n.type=i.create(t.type||s.e.multiple),n.batch=t.batch||new o.e,n._initializeActions(t.actions),n.payloads=i.create(t.payloads||{}),n.visibility=i.create(t.visibility||0),n}return Object(a.__extends)(t,e),t.prototype.dispose=function(){this.actions({}),this.payloads({}),e.prototype.dispose.call(this)},t.prototype._initializeActions=function(e){void 0===e&&(e={});var t={};for(var n in e){var a=e[n];t[n]=this.scope.attach(new c.e({key:n,operation:this,isAvailable:a.isAvailable,onExecute:a.execute}))}this.actions=this.observables.create(t)},t}(i.n),l=n(1912),u=n(1726),f=n(490),p=function(e){function t(t,n){void 0===t&&(t={});var a=e.call(this,t,n)||this,i=a.observables,r=new o.e;a._observers=i.createArray();var s=a.operations=i.createArray(),c=a.scope.attached(l.e),d=a.groups=a.addDisposable(u.e.group(s,function(e){return e.batch}).map({mappingWithDisposeCallback:function(e){var t=new c({batch:e.key,operations:e.values});return{mappedValue:t,dispose:function(){t.dispose()}}}}));return a.overall=new(a.managed(l.e))({batch:r,operations:d}),a.isLocked=a.createPureComputed(a._computeIsLocked),a.createBackgroundComputed(a._computeRemoveAllWhenUnlocked).extend({deferred:!0}),a}return Object(a.__extends)(t,e),t.prototype.lock=function(){var e=this,t={};return this._observers.push(t),{dispose:function(){e._observers.remove(t)}}},t.prototype.register=function(e){var t=new d(e);return 2!==t.visibility.peek()&&this.operations.push(t),t},t.prototype.deleteGroupOperation=function(e){var t=Object(a.__spreadArray)([],e.operations.peek(),!0);this.operations.removeAll(t),t.forEach(function(e){e.dispose()})},t.prototype.cleanup=function(e){void 0===e&&(e=!1);for(var t=[],n=0,a=this.groups.peek();n<a.length;n++){var i=a[n],o=i.state.peek();if(o===r.e.completed||!e&&(o===r.e.expired||o===r.e.canceled||o===r.e.failed))for(var s=i.operations.peek(),c=void 0,d=0;d<s.length;d++){c=!0;var l=s[d];if(o===r.e.failed&&l.actions)for(var u=l.actions.peek(),f=Object.keys(u),p=0;p<f.length;p++)if("cancel"!==f[p]&&u[f[p]].isAvailable.peek()){c=!1;break}c&&t.push(s[d])}}this.operations.removeAll(t),t.forEach(function(e){e.dispose()})},t.prototype._computeRemoveAllWhenUnlocked=function(){this.isLocked()||this.cleanup()},t.prototype._computeIsLocked=function(){return this._observers().length>0},t}(i.n),m=Object(f.r)("OperationProvider",p);t.default=p},1470:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=function(){function e(e){this._value=e,this._observers=new Set}return e.prototype.get=function(){return this._value},e.prototype.set=function(e){this._value=e,this._observers.forEach(function(e){e()})},e.prototype.subscribe=function(e){var t=this;return this._observers.add(e),function(){t._observers.delete(e)}},e}()},1479:function(e,t,n){"use strict";var a=function(){function e(){this.id=++e._lastBatchId}return e._lastBatchId=0,e}();t.e=a},1528:function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return b});var a=n(0),i=n(808),r=n(490),o=n(302),s=n(1302),c=n(1314),d=n(228),l=function(e){function t(t,n){void 0===t&&(t={});var a=e.call(this,t,n)||this;return a._dataSource=n.sharingDataSource,a}return Object(a.__extends)(t,e),t.prototype.share=function(e,t,n){return this._dataSource.share(e,t)},t.dependencies={sharingDataSource:o.se},t}(i.e),u=Object(r.r)("ShareItemHelper",l),f=n(242),p=function(){function e(e,t){this.item=e.item,this._dataSource=t.dataSource}return e.prototype.getSettings=function(){var e=this;return this._settingsPromise||(this._settingsPromise=this._dataSource.getSettings(this),this._settingsPromise.done(null,function(t){f.n.isCanceled(t)&&(e._settingsPromise=null,e._rawResponse=null)})),this._settingsPromise},e.prototype.getPermissions=function(e){return this._permissionsPromise&&!e||(this._permissionsPromise=this._dataSource.getPermissions(this)),this._permissionsPromise},e.prototype.cancelGetPermissionsPromise=function(){this._permissionsPromise&&(this._permissionsPromise.cancel(),this._cleanCacheIfCancel())},e.prototype.getLinks=function(){var e=this;return this._linksPromise||(this._linksPromise=this._dataSource.getLinks(this).then(function(t){return e._linksData=t,t})),this._linksPromise},e.prototype.cancelGetLinksPromise=function(){this._linksPromise&&(this._linksPromise.cancel(),this._cleanCacheIfCancel())},e.prototype.getBestSharingLink=function(e){return this._dataSource.getBestSharingLink(this,e)},e.prototype.setLink=function(e){var t=this._linksData;if(e&&t){var n=t.filter(function(t){return t&&t.role===e.role&&t.type===e.type});if(0===n.length)t.push(e);else{var a=n[0];a.url=e.url,a.expiration=e.expiration,a.isActive=e.isActive}}},e.prototype.doSharingScopesContainLinks=function(){return this._dataSource.doSharingScopesContainLinks()},e.prototype.getRawResponse=function(){var e=this;return this._rawResponse||(this._rawResponse=this._dataSource.getRawResponse(this),this._rawResponse.done(null,function(t){f.n.isCanceled(t)&&(e._rawResponse=null)})),this._rawResponse},e.prototype._cleanCacheIfCancel=function(){this._linksPromise=null,this._settingsPromise=null,this._permissionsPromise=null,this._rawResponse=null},e}(),m=n(31),_=n(57),h=function(e){function t(t,n){void 0===t&&(t={});var a=e.call(this,t,n)||this;return a._dataSource=n.sharingDataSource,a._sharingDataDataSource=n.sharingDataDataSource,a._itemProvider=n.externallySharedItemProvider||n.itemProvider,a._shareDataCache={},a._shareItemHelper=n.shareItemHelper,a}return Object(a.__extends)(t,e),t.prototype.getSharingInformation=function(e,t,n,a,i){return this._dataSource.getSharingInformation(e,t,n,a,"",i)},t.prototype.shareLink=function(e){var t=this;return this._dataSource.shareLink(e).then(function(n){return n.link&&(t._invalidateCachedItem(e.items[0]),t._invalidateItem(e.items[0])),n})},t.prototype.unshareLink=function(e){var t=this;return this._dataSource.unshareLink(e).then(function(n){return t._invalidateCachedItem(e.item),t._invalidateItem(e.item),n})},t.prototype.updatePermissions2=function(e,t,n){var a=this;return this._dataSource.updatePermissions2(e,t,n).then(function(e){return a._invalidateCachedItem(t),a._invalidateItem(t),e})},t.prototype.updatePermissionsMultiple=function(e,t,n,a,i){var r=this;return this._dataSource.updatePermissionsMultiple(e,t,n,a,i).then(function(e){return r._invalidateCachedItem(t),r._invalidateItem(t),e})},t.prototype.supportsExistingAccessOption=function(e){return this._dataSource.supportsExistingAccessOption(e)},t.prototype.getClientId=function(){return this._dataSource.getClientId()},t.prototype.parseRawSharingInformation=function(e,t){return this._dataSource.parseRawSharingInformation(e,t)},t.prototype.emailWithoutPermissioning=function(e,t,n){return this._dataSource.emailWithoutPermissioning(e,t,n)},t.prototype.checkPermissions=function(e,t){return this._dataSource.checkPermissions(e,t)},t.prototype.setAddressBarLinkCapability=function(e,t){return this._dataSource.setAddressBarLinkCapability(e,t)},t.prototype.getSharingData=function(e,t){var n=this._shareDataCache[e.id],a=n&&n.data;return a&&e.eTag===n.eTag&&!t||(a=this.scope.attach(new p({item:e},{dataSource:this._sharingDataDataSource})),this._shareDataCache[e.id]={eTag:e.eTag,data:a}),a},t.prototype.share=function(e,t){var n=this;return this._shareItemHelper.share(e,t).then(function(e){return n._invalidateCache(),e})},t.prototype.stopSharing=function(e,t){var n=this;return this._dataSource.stopSharing(e,t).then(function(e){return n._invalidateCache(),e})},t.prototype.unshare=function(e){var t=this;return this._dataSource.unshare(e).then(function(n){t._invalidateCache();var a=t._itemProvider;return a&&(a.invalidateItem(e.UNSAFE_parent.key),a.invalidateItem(e.key)),n})},t.prototype.updatePermissions=function(e,t,n,a){var i=this;return this._dataSource.updatePermissions(e,t,n,a).then(function(e){return i._invalidateCache(),i._itemProvider&&i._itemProvider.invalidateItem(t.UNSAFE_parent.key),e})},t.prototype.manageSharingLinks=function(e,t){var n=this;if(t&&t.link&&t.link.shareId&&!t.create){var a={item:e[0],kind:t.link.kind,shareId:t.link.shareId};return this._dataSource.unshareLink(a).then(function(e){return n._invalidateCachedItem(a.item),n._invalidateItem(a.item),[]})}var i=(e=e&&e.length?e:[]).map(function(e){return n.getSharingData(e)});return this._dataSource.manageSharingLinks(i,t).then(function(t){n._invalidateCache();var a=e[0]&&e[0].UNSAFE_parent&&e[0].UNSAFE_parent.key;return a&&n._itemProvider.invalidateItem(a),t})},t.prototype._invalidateCache=function(){this._shareDataCache={}},t.prototype._invalidateCachedItem=function(e){e&&e.id&&this._shareDataCache[e.id]&&(this._shareDataCache[e.id]=null)},t.prototype._invalidateItem=function(e){this._itemProvider&&e&&e.UNSAFE_parent&&e.UNSAFE_parent.key&&(e.queryType!==m.e.Search||!Object(_.isFeatureEnabled)(_.DisableShareInvalidateItemInSearchView))&&this._itemProvider.invalidateItem(e.UNSAFE_parent.key)},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.e.dependencies),{sharingDataSource:o.se,sharingDataDataSource:o.ce.optional,navigation:d.e,externallySharedItemProvider:s.i.optional,itemProvider:c.resourceKey.optional,shareItemHelper:u}),t}(i.e),b=(t.default=h,Object(r.r)("SharingProvider",h))},1546:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(1295),i=new(n(13).t)({name:"".concat("UserStateProvider.key",".updateQuota"),factory:{dependencies:{observablesFactoryType:a.i},create:function(e){var t=new(0,e.observablesFactoryType);return{instance:t.create(!1),disposables:t}}}})},1583:function(e,t,n){"use strict";function a(e){return function(e){return!!e&&"object"==typeof e&&"default"in e}(e)?e.default:e}n.d(t,"e",function(){return a})},1628:function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a=n(2801),i=n(13),r=n(490),o=new i.t({name:"offlineDetection",factory:new r.i(a.e)})},1638:function(e,t,n){"use strict";var a=function(){function e(){}return e.addConfig=function(e){window.require.config(e)},e.addPaths=function(e){window.require.config({paths:e})},e.addShims=function(e){window.require.config({shim:e})},e}();t.e=a},1653:function(e,t,n){var a,i,r;!function(o){"use strict";function s(e,t,n,a,i,r,o){this.inputItem=t,this.stateArrayIndex=n,this.mappingOptions=i,this.arrayOfState=r,this.outputObservableArray=o,this.outputArray=this.outputObservableArray.peek(),this.isIncluded=null,this.suppressNotification=!1,this.outputArrayIndex=e.observable(a),this.disposeFuncFromMostRecentMapping=null,this.mappedValueComputed=e.computed(this.mappingEvaluator,this),this.mappedValueComputed.subscribe(this.onMappingResultChanged,this),this.previousMappedValue=this.mappedValueComputed.peek()}function c(e,t){if(!e)return null;switch(e.status){case"added":return e.index;case"deleted":return e.index+t;default:throw new Error("Unknown diff status: "+e.status)}}function d(e,t,n,a,i,r,o,c,d){var l="number"==typeof t.moved,u=l?n[t.moved]:new s(e,t.value,a,i,r,o,c);return o.splice(a,0,u),u.isIncluded&&d.splice(i,0,u.mappedValueComputed.peek()),l&&(u.stateArrayIndex=a,u.setOutputArrayIndexSilently(i)),u}function l(e,t,n,a,i){var r=t.splice(n,1)[0];r.isIncluded&&i.splice(a,1),"number"!=typeof e.moved&&r.dispose()}function u(e,t,n){return e.stateArrayIndex=t,e.setOutputArrayIndexSilently(n),n+(e.isIncluded?1:0)}function f(e,t,n,a,i,r){return t.subscribe(function(t){if(t.length){for(var o=function(e,t){for(var n={},a=0;a<e.length;a++){var i=e[a];"added"===i.status&&"number"==typeof i.moved&&(n[i.moved]=t[i.moved])}return n}(t,n),s=0,f=t[0],p=0,m=f&&function(e,t,n){return n.length&&t[e.index]?t[e.index].outputArrayIndex.peek():n.length}(f,n,a),_=f.index;f||_<n.length;_++)if(c(f,p)===_){switch(f.status){case"added":d(e,f,o,_,m,r,n,i,a).isIncluded&&m++,p++;break;case"deleted":l(f,n,_,m,a),p--,_--;break;default:throw new Error("Unknown diff status: "+f.status)}f=t[++s]}else _<n.length&&(m=u(n[_],_,m));i.valueHasMutated()}},null,"arrayChange")}function p(e,t){var n=[],a=[],i=e.observableArray(a),r=this.peek();if("function"==typeof t&&(t={mapping:t}),t.mappingWithDisposeCallback){if(t.mapping||t.disposeItem)throw new Error("'mappingWithDisposeCallback' cannot be used in conjunction with 'mapping' or 'disposeItem'.")}else if(!t.mapping)throw new Error("Specify either 'mapping' or 'mappingWithDisposeCallback'.");for(var o=0;o<r.length;o++){var c=r[o],d=new s(e,c,o,a.length,t,n,i),l=d.mappedValueComputed.peek();n.push(d),d.isIncluded&&a.push(l)}var u=f(e,this,n,a,i,t),p=e.computed(i).extend({trackArrayChanges:!0}),m=p.dispose;return p.dispose=function(){u.dispose(),e.utils.arrayForEach(n,function(e){e.dispose()}),m.call(this,arguments)},_(e,p),p}function m(e,t){return p.call(this,e,function(e){return t(e)?e:b})}function _(e,t){return e.utils.extend(t,e[g]),t}function h(e){e.projections={_exclusionMarker:b},function(e){function t(e,t){return function(){return t.apply(this,[e].concat(Array.prototype.slice.call(arguments,0)))}}e[g]={map:t(e,p),filter:t(e,m)}}(e),_(e,e.observableArray.fn)}var b={};s.prototype.dispose=function(){this.mappedValueComputed.dispose(),this.disposeResultFromMostRecentEvaluation()},s.prototype.disposeResultFromMostRecentEvaluation=function(){if(this.disposeFuncFromMostRecentMapping&&(this.disposeFuncFromMostRecentMapping(),this.disposeFuncFromMostRecentMapping=null),this.mappingOptions.disposeItem){var e=this.mappedValueComputed();this.mappingOptions.disposeItem(e)}},s.prototype.mappingEvaluator=function(){var e;if(null!==this.isIncluded&&this.disposeResultFromMostRecentEvaluation(),this.mappingOptions.mapping)e=this.mappingOptions.mapping(this.inputItem,this.outputArrayIndex);else{if(!this.mappingOptions.mappingWithDisposeCallback)throw new Error("No mapping callback given.");var t=this.mappingOptions.mappingWithDisposeCallback(this.inputItem,this.outputArrayIndex);if(!("mappedValue"in t))throw new Error("Return value from mappingWithDisposeCallback should have a 'mappedItem' property.");e=t.mappedValue,this.disposeFuncFromMostRecentMapping=t.dispose}var n=e!==b;return this.isIncluded!==n&&(null!==this.isIncluded&&this.moveSubsequentItemsBecauseInclusionStateChanged(n),this.isIncluded=n),e},s.prototype.onMappingResultChanged=function(e){e!==this.previousMappedValue&&(this.isIncluded&&this.outputArray.splice(this.outputArrayIndex.peek(),1,e),this.suppressNotification||this.outputObservableArray.valueHasMutated(),this.previousMappedValue=e)},s.prototype.moveSubsequentItemsBecauseInclusionStateChanged=function(e){var t,n,a=this.outputArrayIndex.peek();if(e)for(this.outputArray.splice(a,0,null),t=this.stateArrayIndex+1;t<this.arrayOfState.length;t++)(n=this.arrayOfState[t]).setOutputArrayIndexSilently(n.outputArrayIndex.peek()+1);else for(this.outputArray.splice(a,1),t=this.stateArrayIndex+1;t<this.arrayOfState.length;t++)(n=this.arrayOfState[t]).setOutputArrayIndexSilently(n.outputArrayIndex.peek()-1)},s.prototype.setOutputArrayIndexSilently=function(e){this.suppressNotification=!0,this.outputArrayIndex(e),this.suppressNotification=!1};var g="_ko.projections.cache";!function(){if(void 0!==e.exports){var o=n(1293);h(o),e.exports=o}else i=[n(1293)],void 0===(r="function"==typeof(a=h)?a.apply(t,i):a)||(e.exports=r)}()}()},1691:function(e,t,n){"use strict";var a=n(0),i=function(e){function t(t){var n=e.call(this,t)||this;return n.errorType=t.errorType||0,n.payloads=t.payloads||{},n}return Object(a.__extends)(t,e),t}(n(45).e);t.e=i},1692:function(e,t,n){"use strict";var a=n(1809),i=n(1293),r=n(1326);t.e=function(e,t,n){this.key=e||"",this.content=i.observable(new a.e(n)),this.content.equalityComparer=r.n,this.schema=i.observableArray([]),this.schema.equalityComparer=r.e,this.context=i.utils.extend({},t),this.contentTypes=i.observableArray([]),this.isPlaceholder=!0,this.version=0}},1724:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(13),i=n(9),r=new a.t({name:"".concat("SharedItemsScopeExperiment.key",".isUseItemsScopeInSharedEnabled"),factory:new a.e(Object(i._r)(i.Fi))})},1725:function(e,t,n){"use strict";var a=n(0),i=n(1295),r=n(242),o=function(e){function t(t){var n=e.call(this,t)||this;n.key=t.key;var a=n.observables,i=t.count,r=void 0===i?a.create(1):i,o=t.isAvailable,c=void 0===o?a.create(!0):o,d=t.onExecute,l=void 0===d?s:d;return n.count=r,n.isAvailable=c,n._onExecute=l.bind(t.operation),n}return Object(a.__extends)(t,e),t.prototype.dispose=function(){e.prototype.dispose.call(this),this._onExecute=s},t.prototype.execute=function(){return this._onExecute()},t}(i.n);function s(){return r.n.wrap()}t.e=o},1726:function(e,t,n){"use strict";n(1382);var a=n(404),i=n(1293),r=function(){function e(e,t){var n=this;this._source=e,this._getKey=t,this._groupsByKeyId={},this.groups=i.observableArray(),this._initializeGroups(),Object(a.e)(this.groups,function(){n._mapping.dispose()})}return e.group=function(t,n){return new e(t,n).groups},e.prototype._initializeGroups=function(){var e=this;this._mapping=this._source.map({mappingWithDisposeCallback:function(t){var n=e._getKey(t),a=JSON.stringify(n),r=e._groupsByKeyId[a];return r?r.values.push(t):(r={key:n,values:i.observableArray([t])},e._groupsByKeyId[a]=r,e.groups.push(r)),{mappedValue:a,dispose:function(){r.values.peek().length>1?r.values.remove(t):(delete e._groupsByKeyId[a],e.groups.remove(r))}}}})},e}();t.e=r},1736:function(e,t,n){"use strict";n.d(t,"n",function(){return i}),n.d(t,"t",function(){return r}),n.d(t,"e",function(){return o});var a=n(13),i=(new a.t("dataStore"),new a.t("userSettingsStore")),r=new a.t("userInfoStore"),o=new a.t("smartFiltersStore")},1758:function(e,t,n){"use strict";function a(e){var t;t={};for(var n=[],a=0,i=e;a<i.length;a++){var r=i[a],o="".concat(r);t[o]||(t[o]=!0,n.push(r))}return n}n.d(t,"e",function(){return a})},1778:function(e,t,n){"use strict";function a(e,t){for(var n=t.start,a=Math.min(t.end,e.length),i=n;i<a;i++)if(!e[i])return!1;return!0}n.d(t,"e",function(){return a})},1806:function(e,t,n){"use strict";var a,i;n.d(t,"t",function(){return a}),n.d(t,"e",function(){return i}),function(e){e[e.all=0]="all",e[e.folders=1]="folders",e[e.photos=2]="photos",e[e.documents=3]="documents",e[e.music=4]="music"}(a||(a={})),function(e){e[e.anyDate=0]="anyDate",e[e.oneDay=1]="oneDay",e[e.oneWeek=2]="oneWeek",e[e.oneMonth=3]="oneMonth",e[e.oneYear=4]="oneYear"}(i||(i={}))},1807:function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"t",function(){return i}),n.d(t,"n",function(){return r}),n.d(t,"i",function(){return o}),n.d(t,"e",function(){return s});var a="List",i="CompactList",r="Grid",o="Album",s="AllPhotos"},1809:function(e,t,n){"use strict";t.e=function(e){this.items=new Array(e||0),this.groupings=null,this.partialResultRequestCount=0,this.partialResultStatus=0}},1843:function(e,t,n){"use strict";n.d(t,"e",function(){return s});var a=n(13),i=n(1628),r=n(896),o=n(1470),s=new a.t({name:"".concat("isOfflineStateObservable.key",".isOfflineStateObservable"),factory:{dependencies:{offlineDetection:i.e},create:function(e){var t=new r.e,n=new o.e(e.offlineDetection.offline);return t.attach(e.offlineDetection.onChange(function(e){n.set(e)})),{instance:n,disposable:t}}}})},1883:function(e,t,n){"use strict";n.d(t,"e",function(){return f});var a=n(0),i=n(1),r=n(90),o=n(169),s=n(259),c=n(13),d=n(15);function l(e){return i.createElement(i.Fragment,null,e.children)}var u=new c.t("".concat("WithKnockoutResourceScope",".canary"));function f(e){var t=this,n=e.bypass,f=Object(r.n)(),p=i.useState(function(){return Object(o.e)(function(){return Object(a.__awaiter)(t,void 0,void 0,function(){var e;return Object(a.__generator)(this,function(t){switch(t.label){case 0:return n?d.e.isActivated("CE443088-1048-4D30-BCF1-14E5A320BE65","07/12/2022","Directly consume resources with .bypass")?[3,2]:[4,f.consumeAsync(s.e.optional.bypass)]:[3,7];case 1:return t.sent(),[3,6];case 2:(e=new c.n(f,{owner:"WithKnockoutResourceScope"})).expose(u,!0),t.label=3;case 3:return t.trys.push([3,,5,6]),[4,e.consumeAsync(s.e.optional.bypass)];case 4:return t.sent(),[3,6];case 5:return e.dispose(),[7];case 6:return[3,9];case 7:return[4,f.consumeAsync(s.e.optional)];case 8:t.sent(),t.label=9;case 9:return[2,l]}})})})})[0];return i.createElement(p,Object(a.__assign)({},e))}},1912:function(e,t,n){"use strict";var a=n(0),i=n(1359),r=n(1370),o=n(1725),s=n(242),c=n(1295),d=n(1293);function l(e,t){var n,a=function(e){t(t.peek()+e)},i=e.subscribe(function(){n=e.peek()},null,"beforeChange"),r=e.subscribe(function(){a(e.peek()-n)});return a(e.peek()),{dispose:function(){i.dispose(),r.dispose(),a(-e.peek())}}}var u=n(1726),f=function(e){function t(t){var n=e.call(this,t)||this;return n.operations=t.operations,n.name="",n.iconName="",n.progress={minimum:n.createObservable(0),maximum:n.createObservable(0),current:n.createObservable(0)},n.batch=t.batch,n.error=n.createObservable(),n.count=n.createObservable(0),n._initializeType(),n.payloads=n.createPureComputed(n._computePayloads),n.actions=n.createObservable({}),n.states=n.createObservable({created:0,started:0,completed:0,failed:0,canceled:0,expired:0}),n._initializeOperations(),n.state=n.createPureComputed(n._computeState),n.visibility=n.createPureComputed(n._computeVisibility),n}return Object(a.__extends)(t,e),t.prototype._initializeType=function(){var e=this.addDisposable(u.e.group(this.operations,function(e){return e.type()}));this.type=this.createPureComputed(function(){return 1===e().length&&e()[0].key||i.e.multiple})},t.prototype._computePayloads=function(){var e=this.operations()[0];return e&&e.payloads()||{}},t.prototype._initializeOperations=function(){var e=this;this.addDisposable(this.operations.map({mappingWithDisposeCallback:function(t){var n,a,i,o,s,c,u=e.createPureComputed(function(){return r.e[t.state()]}),f=e.addDisposable(l(t.progress.minimum,e.progress.minimum)),p=e.addDisposable(l(t.progress.maximum,e.progress.maximum)),m=e.addDisposable(l(t.progress.current,e.progress.current)),_=e.addDisposable((n=u,a=e.states,o=function(e,t){var n=a.peek();void 0!==e&&n[e]--,void 0!==t&&(n[t]=(n[t]||0)+1),a.valueHasMutated()},s=n.subscribe(function(){i=n.peek()},null,"beforeChange"),c=n.subscribe(function(){o(i,n.peek())}),o(void 0,n.peek()),{dispose:function(){s.dispose(),c.dispose(),o(n.peek(),void 0)}})),h=e.addDisposable(function(e,t){var n=e.peek(),a=e.subscribe(function(){n=e.peek()},null,"beforeChange"),i=d.computed(function(){!t()&&e()&&t(e())}),r=e.subscribe(function(e){!e&&n&&t.peek()===n&&t(void 0)});return{dispose:function(){i.dispose(),r.dispose(),a.dispose()}}}(t.error,e.error)),b=e.addDisposable(l(t.count,e.count)),g=e.createComputed(function(){var n=!1,a=e.actions.peek();for(var i in t.actions())i in a||(a[i]=e._initializeAction(i),n=!0);n&&e.actions.valueHasMutated()});return{mappedValue:t,dispose:function(){u.dispose(),f.dispose(),p.dispose(),m.dispose(),_.dispose(),g.dispose(),h.dispose(),b.dispose()}}}}))},t.prototype._computeState=function(){var e=this.states();return e.started||e.created&&(e.failed||e.completed||e.canceled)?r.e.started:e.created?r.e.created:e.failed?r.e.failed:e.completed?r.e.completed:e.canceled?r.e.canceled:r.e.expired},t.prototype._computeVisibility=function(){return this.operations().reduce(function(e,t){var n=t.visibility.peek();return n<e?n:e},2)},t.prototype._initializeAction=function(e){var t=this.addDisposable(this.operations.filter(function(t){var n=t.actions()[e];return n&&n.isAvailable()}));return this.addDisposable(new o.e({count:this.createPureComputed(function(){return t().length}),key:e,operation:this,isAvailable:this.createPureComputed(function(){return!!t().length}),onExecute:function(){return s.n.all(t().slice().map(function(t){var n=t.actions.peek()[e];return n&&n.execute()||s.n.wrap()}))}}))},t}(c.n);t.e=f},1950:function(e,t,n){"use strict";n.d(t,"e",function(){return f});var a=n(13),i=n(490),r=n(873),o=n(2192),s=n(817),c=n(1843),d=n(242),l=new a.t({name:"cookieOrigin",factory:new a.e(window.location.origin)}),u=new a.t({name:"".concat("VroomDataRequestor",".isOfflineStatePromise"),factory:{dependencies:{isOfflineStateObservable:c.e},create:function(e){return{instance:function(){return d.n.resolve(e.isOfflineStateObservable.get())}}}}}),f=Object(i.r)("VroomDataRequestor",s.e,{sessionManagementProvider:o.e.optional,urlDataSource:r.e.optional,cookieOrigin:l,isOffline:u})},1963:function(e,t,n){"use strict";var a;n.d(t,"a",function(){return i}),n.d(t,"e",function(){return r}),n.d(t,"s",function(){return o}),n.d(t,"l",function(){return s}),n.d(t,"d",function(){return c}),n.d(t,"n",function(){return d}),n.d(t,"t",function(){return l}),n.d(t,"r",function(){return u}),n.d(t,"o",function(){return f}),n.d(t,"c",function(){return p}),n.d(t,"i",function(){return m});var i="msa_client_id",r="aad_client_id",o="ru",s="view_type",c="selection_mode",d="link_type",l="access",u="prompt",f="select_account",p=((a={})[1]=0,a[0]=1,a),m=1e3},1997:function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a=n(0),i=n(166),r=n(1758);function o(e){var t=e.viewType,n=void 0===t?0:t,o=e.typeFilter,s=(void 0===o?{filters:[]}:o).filters;return 2===n&&(s=Object(a.__spreadArray)(Object(a.__spreadArray)([],s,!0),[i.e.folder],!1)),{filters:Object(r.e)(s)}}},2123:function(e,t,n){"use strict";n.d(t,"e",function(){return s}),n.d(t,"t",function(){return c});var a=n(1103),i=n(91),r=n(242),o=n(1583);function s(e){return function(e){return void 0!==e.getModule}(e)?c({path:e.path,getModule:e.getModule,getExport:o.e}):c({path:e.path,require:e.require,getExport:o.e})}function c(e){var t=e.path,n=e.getExport;return r.n.resolve(function(e){return void 0!==e.getModule}(e)?d(e.getModule,t):function(e,t){return d(function(){return new r.n(function(n,a){e([t],n,a)})},t)}(e.require,t)).then(n)}function d(e,t){return i.n.mark("Module_".concat(t),20),e().then(function(e){return e},function(e){return r.n.isCanceled(e)||a.e.log(e),r.n.reject(e)})}},2139:function(e,t,n){"use strict";var a=function(){function e(){}return e.prototype.getState=function(e){return this._getNormalizedWindowName()[e]},e.prototype.setState=function(e,t){var n=this._getNormalizedWindowName();n[e]=t,window.name=JSON.stringify(n)},e.prototype.removeState=function(e){var t=this._getNormalizedWindowName(),n=t[e];return delete t[e],window.name=JSON.stringify(t),n},e.prototype._getNormalizedWindowName=function(){var e,t;try{t=JSON.parse(window.name)||{}}catch(e){t={}}return"object"!=typeof t&&((e={}).value=t,t=e),t},e}();t.e=a},2140:function(e,t,n){"use strict";n.d(t,"e",function(){return d});var a=n(0),i=n(1295),r=n(302),o=n(1371),s=n(490),c=function(e){function t(t,n){void 0===t&&(t={});var a=e.call(this,t,n)||this;return a._itemPickerDataSource=n.itemPickerDataSource,a._urlDataSource=n.urlDataSource,a}return Object(a.__extends)(t,e),t.prototype.getHandler=function(e){return this._itemPickerDataSource.getHandler(e)},t.prototype.getPivots=function(e){return this._itemPickerDataSource.getPivots(e)},t.prototype.getInitialViewParams=function(e){var t=e.behavior.typeFilter,n=void 0===t?{filters:[]}:t,i=e.viewParams;return{viewParams:Object(a.__assign)(Object(a.__assign)({},i),this._urlDataSource.saveItemTypeFilter(n))}},t.prototype.getItemFromPickerItem=function(e){var t={key:""};return Object(o.default)(t,{itemId:e.id,graph:{itemId:e.id,driveId:o.optional(e.parentReference&&e.parentReference.driveId)},name:o.backup(e.name),extension:o.backup(e.extension),folder:o.optional(e.folder&&{})}),Object(o.default)(t,this._itemPickerDataSource.getItemFromPickerItem(e)),t},t.prototype.getPickerItemFromItem=function(e,t){var n={id:e.itemId};return Object(o.default)(n,{id:o.optional(e.graph&&e.graph.itemId),parentReference:o.optional(e.graph&&{driveId:e.graph.driveId}),folder:o.optional(e.folder&&{})}),t.hostAuthenticationLevel>0&&Object(o.default)(n,{name:e.name,extension:e.extension}),Object(o.default)(n,this._itemPickerDataSource.getPickerItemFromItem(e,t)),n},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.n.dependencies),{itemPickerDataSource:r.P,urlDataSource:r.ge}),t}(i.n),d=Object(s.r)("ItemPickerProvider",c)},2192:function(e,t,n){"use strict";n.d(t,"e",function(){return _});var a,i=n(338),r=new(n(13).t)("MicroServiceDataSource.key"),o=n(242),s=n(832),c=n(490),d=n(45),l=n(58);!function(e){e.unauthUser="unauthUser"}(a||(a={}));var u=n(344),f={ODB:n(894).e.ODB?1651:60021},p=Object(u.e)(f)&&Object(u.e)({ODB:671}),m=function(){function e(e,t){this._identityDataSource=t.identityDataSource,this._microServiceDataSource=t.microServiceDataSource}return e.prototype.getToken=function(e,t){var n=this._identityDataSource.getIdentity().type;if(n===i.e.aad){if(t&&p){var r=new l.e(t).authority;return this._identityDataSource.getSharePointToken(r)}if(this._microServiceDataSource)return this._microServiceDataSource.getAuthData().then(function(t){if(t)return e&&"v2.1"===e?{accessToken:t.authTokenV21,proofToken:t.proofTokenV21,tokenUrl:t.tokenUrlV21}:{accessToken:t.authToken,proofToken:t.proofToken,tokenUrl:t.tokenUrl}},function(e){return o.n.resolve()})}else if(n===i.e.msa)return this._identityDataSource.getSessionToken();return o.n.reject(new d.e({code:a.unauthUser,isExpected:!0,message:"Cannot request a token for an unauthenticated user."}))},e.prototype.getFormDigest=function(e){return this._identityDataSource.getFormDigest(e)},e.dependencies={identityDataSource:s.e,microServiceDataSource:r.optional},e}(),_=Object(c.r)("SessionManagementProvider",m)},2217:function(e,t,n){"use strict";var a;!function(e){e[e.iosappstore=0]="iosappstore"}(a||(a={})),t.e=a},2218:function(e,t,n){"use strict";n.d(t,"e",function(){return i}),n.d(t,"t",function(){return r});var a=(window.FilesConfig&&window.FilesConfig.skyApiDomain)+"/API/2/";function i(){return a+"GetUserInfo"}function r(){return a+"SetUserInfo"}},2235:function(e,t,n){"use strict";n.d(t,"e",function(){return l}),n.d(t,"t",function(){return u}),n.d(t,"n",function(){return f}),n.d(t,"a",function(){return p}),n.d(t,"i",function(){return m}),n.d(t,"r",function(){return _});var a=n(0),i=n(2338),r=n(1997),o=n(1371),s=n(1412),c=n(864),d=n(21);function l(e,t){return void 0===t&&(t={}),Object(a.__assign)(Object(a.__assign)({},u(Object(c.e)(e),t)),f(e))}function u(e,t){void 0===e&&(e={}),void 0===t&&(t={});var n=t.itemTypeFilterFromViewParams,o=e.id,c=e.aid,l=e.a,u=e.v,f=e.s,p=e.l,m=e.f,_=e.o,h=e.sa,b=void 0===h||h,g=e.ss,v=void 0===g||g,y=e.sh,S=void 0!==y&&y,D=e.tf,I=void 0!==D&&D,x=e.cbt,C=e.fbt,O=e.cm,w=e.qos,E=e.sn,A=void 0===E||E,L=!function(){try{return!!parent.document}catch(e){return!1}}()||A,k=Object(i.r)(u);return Object(a.__assign)(Object(a.__assign)({id:o,showActions:b,showBranding:L,showSwitchAccount:v,showSearch:S,enableFocusTrap:I,aadClientId:c,accessLevel:Object(i.e)(l),viewType:k,selectionMode:Object(i.a)(f),linkType:Object(i.n)(p),origin:_,typeFilter:Object(r.e)({typeFilter:Object(i.i)(m)||!d.e.isActivated("7FC5B3FB-AF5D-4346-9F85-5A57C56A2908","6/24/2021","Fall back to filters from initial URL")&&n,viewType:k}),completeText:x,cancelText:C},function(e){if(e){var t=void 0;switch(e){case"d":t=s.r;break;case"cd":t=s.n;break;case"t":t=s.s}if(t)return{layoutType:t}}}(e.lt)||{}),{sdkVersion:"7.1",commandMode:O,qosData:w})}function f(e){return{state:e.state,accessToken:e.access_token}}function p(e){var t=m(e);return Object(a.__assign)(Object(a.__assign)({},_(e)),Object(c.n)(t))}function m(e){var t=e.showActions,n=e.showBranding,a=e.showSwitchAccount,r=e.aadClientId,s=e.accessLevel,c=e.viewType,d=e.selectionMode,l=e.linkType,u=e.typeFilter,f=e.origin,p=e.id,m=e.commandMode,_=e.qosData,b={};return Object(o.default)(b,{sa:o.optional(t),sn:o.optional(n),ss:o.optional(a),aid:o.optional(r),id:o.optional(p),o:o.optional(f),a:o.optional(Object(i.s)(s)),s:o.optional(Object(i.d)(d)),v:o.optional(Object(i.u)(c)),f:o.optional(Object(i.l)(u)),l:o.optional(Object(i.c)(l)),lt:o.optional(h(e.layoutType)),cm:o.optional("safe-write"!==m?m:void 0),qos:o.optional(_)}),b}function _(e){var t=e.msaClientId,n=e.state,a=e.accessToken,i={};return n&&(i.state=n),t&&(i.client_id=t),a&&(i.access_token=a),i}function h(e){if(e)switch(e){case s.r:return"d";case s.n:return"cd";case s.s:return"t"}}},2236:function(e,t,n){"use strict";n.d(t,"t",function(){return c}),n.d(t,"e",function(){return d}),n.d(t,"n",function(){return l});var a=n(0),i=n(864),r=n(2235),o=n(1371),s={ONEDRIVE:"oneDrive",SITES:"sites",RECENT:"recent",SHARED:"shared",PHOTOS:"photos",BUSINESS:"business",CONSUMER:"consumer"};function c(e){var t=Object(i.e)(e);return!!t&&"7.2"===t.sdk}function d(e){return Object(a.__assign)(Object(a.__assign)({},function(e){void 0===e&&(e={sdk:"7.2"});var t=e.ln,n=void 0===t||t;return Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},Object(r.t)(e)),function(e){var t="string"==typeof e?e.split(","):e;if(t){for(var n={},a=0,i=t;a<i.length;a++){var r=i[a],o="".concat(r).trim().toUpperCase(),c=s[o];c&&(n[c]=!0)}return{sourceTypes:n}}}(e.st)||{}),function(e){if(e)return{entryLocation:Object(a.__assign)(Object(a.__assign)({},e.oneDrive?{oneDrive:Object(a.__assign)({},e.oneDrive.recent?{recent:{}}:{})}:{}),e.sharePoint?{sharePoint:{web:e.sharePoint.sitePath,list:e.sharePoint.listPath,folder:e.sharePoint.itemPath}}:{})}}(e.e)||{}),{showNavigation:n,showBranding:!1,sdkVersion:"7.2"})}(Object(i.e)(e))),Object(r.n)(e))}function l(e){var t=function(e){var t=Object(a.__assign)(Object(a.__assign)({},Object(r.i)(e)),{sdk:"7.2"});return Object(o.default)(t,{ln:o.optional(e.showNavigation),st:o.optional(u(e.sourceTypes)),e:o.optional(f(e.entryLocation)),sn:!1}),t}(e);return Object(a.__assign)(Object(a.__assign)({},Object(r.r)(e)),Object(i.n)(t))}function u(e){if(e){var t=[];for(var n in e)e[n]&&t.push(n);return 1===t.length?t[0]:t}}function f(e){if(e)return Object(a.__assign)(Object(a.__assign)({},e.oneDrive?{oneDrive:Object(a.__assign)({},e.oneDrive.recent?{recent:{}}:{})}:{}),e.sharePoint?{sharePoint:{sitePath:e.sharePoint.web,listPath:e.sharePoint.list,itemPath:e.sharePoint.folder}}:{})}},2336:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a="odcpicker"},2337:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=["HTTP:","HTTPS:"];function i(e){void 0===e&&(e="");var t=e.toUpperCase();return a.filter(function(e){return 0===t.indexOf(e)}).length?e:void 0}},2338:function(e,t,n){"use strict";n.d(t,"o",function(){return l}),n.d(t,"t",function(){return u}),n.d(t,"e",function(){return f}),n.d(t,"s",function(){return p}),n.d(t,"a",function(){return m}),n.d(t,"d",function(){return _}),n.d(t,"n",function(){return h}),n.d(t,"c",function(){return b}),n.d(t,"r",function(){return g}),n.d(t,"u",function(){return v}),n.d(t,"l",function(){return y});var a=n(2139),i=n(166),r=n(1997),o=n(2337),s=n(887);n.d(t,"i",function(){return s.e});var c=n(21),d="picker";function l(e){return!!(new a.e).getState(d)}function u(e,t){void 0===t&&(t={});var n=t.itemTypeFilterFromViewParams,i=new a.e,l=i.getState(d)||{},u=i.getState("options")||{},p=l.accessLevel,_=l.viewType,b=l.linkType,v=l.selectionMode,y=l.filter,S=u.clientId,D=u.advanced.redirectUri,I=!!S&&!!D,x=g(_);return{showActions:!0,showBranding:!0,accessLevel:f(p),viewType:x,linkType:h(b),selectionMode:m(v),typeFilter:Object(r.e)({typeFilter:Object(s.e)(y)||!c.e.isActivated("7FC5B3FB-AF5D-4346-9F85-5A57C56A2908","6/24/2021","Fall back to filters from initial URL")&&n,viewType:x}),aadClientId:S,returnUrl:Object(o.e)(D),showSwitchAccount:I,sdkVersion:"7.0"}}function f(e){return void 0===e&&(e=""),"readwrite"===e?1:0}function p(e){var t;return void 0===e&&(e=0),1===e&&(t="readwrite"),t}function m(e){return void 0===e&&(e=""),"multiple"===e?1:0}function _(e){var t;return void 0===e&&(e=0),1===e&&(t="multiple"),t}function h(e){var t;switch(void 0===e&&(e=""),e){case"download":t=2;break;case"webView":t=0;break;case"share":t=3;break;case"all":t=4;break;default:t=1}return t}function b(e){var t;switch(void 0===e&&(e=1),e){case 2:t="download";break;case 0:t="webView"}return t}function g(e){var t;switch(void 0===e&&(e=""),e){case"files":t=1;break;case"folders":t=2;break;default:t=0}return t}function v(e){var t;switch(void 0===e&&(e=0),e){case 1:t="files";break;case 2:t="folders"}return t}function y(e){void 0===e&&(e={filters:[]});for(var t,n=[],a=0,r=e.filters;a<r.length;a++){var o=r[a];if("string"==typeof o)n.push(o);else{var s=void 0;switch(o){case i.e.folder:s="folder";break;case i.e.photo:s="photo"}s&&n.push(s)}}return n.length>1?t=n:n.length&&(t=n[0]),t}},2427:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(242);function i(e){var t;return function(){return t||(t=a.n.resolve(e()).then(function(e){return e.default}).catch(function(e){return t=void 0,a.n.reject(e)}))}}},2562:function(e,t,n){"use strict";n.d(t,"e",function(){return s});var a=n(72),i=n(620),r=n(166),o=n(350);function s(e){var t=e.typeFilter;if(t){for(var n=[],s=t.filters,c=0,d=void 0===s?[]:s;c<d.length;c++){var l=d[c];if("string"==typeof l)Object(o.e)(l)&&n.push(Object(i.t)(l));else switch(l){case r.e.folder:n.push(a.n);break;case r.e.photo:n.push(a.d);break;case r.e.video:n.push(a.l)}}return n}}},2563:function(e,t,n){"use strict";n.d(t,"e",function(){return s}),n.d(t,"t",function(){return c});var a=n(166),i=n(498),r=n(608),o=n(57);function s(e){void 0===e&&(e={filters:[]});var t=e.filters;if(t.length){for(var n={},s=Object(o.isFeatureEnabled)(o.EnableRecentForMediaTypeFilters),c=0,d=t;c<d.length;c++){var l=d[c];if("string"==typeof l){var u=Object(i.n)(l);if(r.t[u])n.recent=!0,n.shared=!0;else switch(u){case"photo":case"video":n.photos=!0,n.shared=!0,s&&(n.recent=!0)}}else switch(l){case a.e.media:case a.e.photo:case a.e.video:n.photos=!0,n.shared=!0,s&&(n.recent=!0);break;case a.e.audio:n.shared=!0;break;default:case a.e.folder:n.oneDrive=!0,n.sites=!0,n.shared=!0,n.business=!0,n.consumer=!0}}return n}}function c(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.reduce(function(e,t){if(!t)return e;if(!e)return t;var n={};for(var a in t)e[a]&&t[a]&&(n[a]=!0);return n},void 0)}},2801:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(63),i=function(){function e(){this._initialized=!1,this._ignoreSWOffline=!1}return e.prototype.onChange=function(e){var t=this;return this._ensureInitialized(),this._listeners.push(e),function(){var n=t._listeners.indexOf(e);-1!==n&&t._listeners.splice(n,1)}},e.prototype.dispose=function(){this._events.dispose()},Object.defineProperty(e.prototype,"offline",{get:function(){return this._ignoreSWOffline?!navigator.onLine:!navigator.onLine||this._swOffline()},enumerable:!1,configurable:!0}),e.prototype._ensureInitialized=function(){this._initialized||(this._initialized=!0,this._listeners=[],this._events=new a.e(window),this._events.on(window,"online",this._onStateChange.bind(this,"online")),this._events.on(window,"offline",this._onStateChange.bind(this,"offline")),this._events.on(window,"swonline",this._onStateChange.bind(this,"swonline")),this._events.on(window,"swoffline",this._onStateChange.bind(this,"swoffline")))},e.prototype._onStateChange=function(e){this._swOffline()&&"online"===e&&(this._ignoreSWOffline=!0);var t=this.offline;this._listeners&&this._listeners.forEach(function(e){try{e(t)}catch(e){}})},e.prototype._swOffline=function(){return!(!window.__swstats||void 0===window.__swstats.offline)&&window.__swstats.offline},e}()},2850:function(e,t,n){"use strict";n.r(t),n.d(t,"typeResourceKey",function(){return u});var a=n(0),i=n(1295),r=n(1297),o=n(2140),s=n(302),c=n(242),d=n(490),l=function(e){function t(t,n){void 0===t&&(t={});var a=e.call(this,t,n)||this;a._applicationDataSource=n.applicationDataSource;var i=n.itemPickerProvider,r=n.viewParams.peek(),o=i.getHandler({viewParams:r}).handlerTypeKey,s=new(a.child(o))({viewParams:r,getApplication:function(){return a._getApplication()}});return a._behavior=s.getBehavior(),a._agent={initialize:function(){return s.initialize()},getApplication:function(){return a._getApplication()},complete:function(e){return s.complete(e)},cancel:function(){return s.cancel()},switchAccount:function(){return s.switchAccount()}},a}return Object(a.__extends)(t,e),t.prototype.getAgent=function(){return this._agent},t.prototype.getBehavior=function(){return this._behavior},t.prototype._getApplication=function(){var e,t=this._behavior.msaClientId;return e=this._applicationDataSource&&t?this._applicationDataSource.getApplicationDetails({clientId:t}):c.n.wrap(),this._getApplication=function(){return e},e},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.n.dependencies),{applicationDataSource:s.n.optional,viewParams:r.F,itemPickerProvider:o.e}),t}(i.n);t.default=l;var u=Object(d.o)("FilePickerAgentHelper",l)},3019:function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return Ee});var a=n(0),i=n(1295),r=n(242),o=n(376),s=n(1453),c=n(1638),d=n(2123),l=n(66),u=n(88),f=n(1997),p=n(818),m=n(144),_=n(490),h=n(112),b=n(49),g=n(45),v=function(e){function t(t,n){var a=e.call(this,t,n)||this,i=n.currentWindow,r=void 0===i?window:i;return a._currentWindow=r,a}return Object(a.__extends)(t,e),t.prototype.validateExperience=function(e){void 0===e&&(e={authenticationLevel:0,reason:"unknown"});var t=new h.e({name:"ItemPickerSecureExperienceHelper.validateExperience"}),n=this._currentWindow;if(n.self===n.top)return t.end({resultType:b.e.Success,extraData:{pickerHostIdentityLevel:e.authenticationLevel,pickerHostIdentityReason:"self"}}),r.n.wrap();var a=n.parent;if(a)try{if(a.location.href)return t.end({resultType:b.e.Success,extraData:{pickerHostIdentityLevel:e.authenticationLevel,pickerHostIdentityReason:"sameDomain"}}),r.n.wrap()}catch(e){}return e.authenticationLevel>0?(t.end({resultType:b.e.Success,extraData:{pickerHostIdentityLevel:e.authenticationLevel,pickerHostIdentityReason:e.reason}}),r.n.wrap()):(t.end({resultType:"origin"===e.reason?b.e.ExpectedFailure:b.e.Failure,extraData:{pickerHostIdentityLevel:e.authenticationLevel,pickerHostIdentityReason:e.reason}}),this._createInsecureError())},t.prototype._createInsecureError=function(){return r.n.reject(new g.e({code:"UnableToVerifyPickerHost",message:"The picker is not being loaded in a secure context."}))},t.dependencies=Object(a.__assign)({},i.n.dependencies),t}(i.n),y=Object(_.o)("SecureExperienceHelper",v),S=n(58),D=n(15),I=Object(a.__spreadArray)(["DOCS.COM","ONEDRIVE.COM","LIVE.COM","LIVE-INT.COM","OFFICE.COM","LIVE-TST.COM","OFFICEAPPS.LIVE.COM","GOV.ONLINE.OFFICE365.US","DOD.ONLINE.OFFICE365.US","OFFICEAPPS-DF.LIVE.COM","ONLINE.OFFICE.DE","PARTNER.OFFICEWEBAPPS.CN"],D.e.isActivated("83940490-3FD1-41CA-BA88-9CDD54EE60AA","03/07/2022","Add WAC air-gap domains to first-party approved list")?[]:["OFFICE.MICROSOFT.SCLOUD","OFFICE.EAGLEX.IC.GOV"],!0);function x(e){for(var t=new S.e(e).domain.toUpperCase(),n=0,a=I;n<a.length;n++){var i=a[n],r=".".concat(i);if(i===t||t.indexOf(r,t.length-r.length)>-1)return!0}return!1}var C=n(1963),O=function(e){function t(t,n){var a=e.call(this,t)||this,i=t.viewParams;a._liveSdkScriptSource=i.livesdk,a._urlType=i.auth===u.t.skyDrivePickerOAuth?2:1;var r=n.getSkyDrivePicker,o=void 0===r?w:r,s=n.DataRequest,c=void 0===s?p.e:s;a._getSkyDrivePicker=o;var d=a._behavior=function(e){var t,n=function(e){var t,n;switch(e.v){case"1":case"FolderPickerView":t=2,n=1}return{viewType:t,accessLevel:n}}(e),a=n.viewType,i=n.accessLevel,r=e.domain,o={showActions:!0,showBranding:!0,showSwitchAccount:!1,viewType:a,selectionMode:(t=e.select,"multi"===t?1:0),accessLevel:i,typeFilter:Object(f.e)({viewType:a}),sdkVersion:"5.0"};return r&&(o.origin="https://".concat(r)),o}(i);a._validateSignal=a._getValidateSignal();var l=a.scope;return a._dataRequest=new(l.attached(c)),a._secureExperienceHelper=new(l.attached(n.secureExperienceHelperType))({behavior:d}),a}return Object(a.__extends)(t,e),t.prototype.getBehavior=function(){return this._behavior},t.prototype.initialize=function(){var e=this;return this._loadSkyDrivePicker().then(function(){return e.async.setTimeout(function(){e._validateSignal.complete({authenticationLevel:0,reason:"timeout"})},C.i),e._validateSignal.getPromise()}).then(function(t){return e._secureExperienceHelper.validateExperience(t)})},t.prototype.complete=function(e){var t=this,n=r.n.all(e.map(function(e){return t._getSkyApiItem(e)}));return this._loadSkyDrivePicker().then(function(e){return n.then(function(t){e.onSuccess(t)})})},t.prototype.cancel=function(){return this._loadSkyDrivePicker().then(function(e){e.onFailure(void 0)})},t.prototype.switchAccount=function(){return r.n.wrap()},t.prototype._loadSkyDrivePicker=function(){var e=this.trackPromise(this._getSkyDrivePicker(this._liveSdkScriptSource).then(function(e){return new r.n(function(t,n){e.init({subscribe:function(e,n){t({onSuccess:e,onFailure:n})}})})}));return this._loadSkyDrivePicker=function(){return e},e},t.prototype._getSkyApiItem=function(e){var t={caller:s.t.viewerId,m:u.e.mkt,rset:"skyweb_picker",v:"".concat(Math.random()),d:"1",iabch:"1",pi:"5",path:1,lct:1,id:e.id,urlType:this._urlType},n="".concat(s.t.skyApiBaseUrl,"GetItems?").concat(Object(m.n)(t)),a={"X-SkyApiOriginId":"".concat(Math.random())};return this._dataRequest.send({apiName:"GetItems",url:n,headers:a}).then(function(e){return(e.items||[e.item])[0]})},t.prototype._getValidateSignal=function(){var e=this,t=this._behavior.origin,n=new o.e;return x(t)?this.events.on(window,"message",function(a){var i="".concat(a.data||"");a.source===window.parent&&a.origin===t&&0===i.indexOf("<file_dialog>")&&(n.complete({authenticationLevel:2,reason:"origin"}),e.events.off(window,"message"))}):n.complete({authenticationLevel:0,reason:"origin"}),n},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.n.dependencies),{secureExperienceHelperType:y}),t}(i.n);function w(e){var t,n=u.e.isINT,a=void 0!==n&&n?"js.live-int.net":"js.live.net";if((new l.t(e).getHost()||"").toUpperCase()!==a.toUpperCase())throw new Error("Cannot continue with the picker because the SDK is not from a trusted domain");var i=e.lastIndexOf(".js");return i===e.length-3&&(e=e.substring(0,i)),c.e.addPaths(((t={}).livesdk=e,t)),Object(d.e)({path:"livesdk",getModule:function(){return new r.n(function(e,t){window.require(["livesdk"],e,t)})}}).then(function(){return WL&&WL.skydrivePicker})}var E,A,L,k,M=Object(_.o)("Sdk50Handler",O),P=n(2139),T=n(2336),U=n(2337);function F(e){return!!e.scope}function H(e){return Object(U.e)(e.ru)}function R(e){var t=e.client_id;return(void 0===t?"":t).split(",")[0]}var N=((E={})[1]="file",E[2]="folder",E),B=((A={})[0]="webViewLink",A[1]="webLink",A[2]="downloadLink",A),j=((L={})[1]="multi",L[0]="single",L),V=((k={})[1]="readwrite",k[0]="read",k);function z(e){var t,n;if(e.msaClientId||e.aadClientId){var a=((t={})[C.a]=e.msaClientId,t[C.e]=e.aadClientId,t[C.s]=e.returnUrl,t[C.l]=N[e.viewType],t[C.d]=j[e.selectionMode],t[C.n]=B[e.linkType],t[C.t]=V[e.accessLevel],t[C.r]=C.o,t);n="https://onedrive.live.com/picker/accountchooser?"+m.n(a,null,!0)}return n}var G=n(1528),K=n(228),W=function(e){function t(t,n){var a=e.call(this,t,n)||this,i=t.behavior,o=t.returnUrl,s=t.getApplication,c=void 0===s?function(){return r.n.wrap()}:s;return a._behavior=i,a._returnUrl=o,a._sharingProvider=n.sharingProvider,a._navigation=n.navigation,a._onGetApplication=c,a}return Object(a.__extends)(t,e),t.prototype.complete=function(e){var t=this,n=this._behavior,a=n.accessLevel,i=n.linkType,o=this._returnUrl;if(!o)return r.n.wrapError(new Error("No return URL specified to handle completion."));var s=1!==a&&2!==i,c=1===a?2:1;return this.trackPromise(this._onGetApplication().then(function(n){if(!n)return r.n.wrapError({code:1});if(s){var a={role:c,type:4,name:n.name,create:!0,person:n};return t._sharingProvider.manageSharingLinks(e,a).then(function(e){return{userId:e[0].id,itemId:e[0].item.id}})}return t._sharingProvider.share([n],{items:e,roleValue:String(c)}).then(function(e){return{userId:e.people[0].sharingInfo.userId,itemId:e.itemId}})}).then(function(e){var n=[e.itemId];1!==a&&2!==i&&n.push(e.userId);var r={res:"success",resuictx:{uriValue:"selection_".concat(n.join("!"))}};t._navigation.navigateTo({url:"".concat(o,"&").concat(m.n(r))})}))},t.prototype.cancel=function(){var e=this._returnUrl;return e?(this._navigation.navigateTo({url:"".concat(e,"&").concat(m.n({res:"cancel"}))}),r.n.wrap()):r.n.wrapError(new Error("No return URL specified to handle cancellation."))},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.n.dependencies),{sharingProvider:G.resourceKey,navigation:K.e}),t}(i.n),q=Object(_.o)("OAuthConsentHelper",W),Q=function(e){function t(t,n){var a=e.call(this,t,n)||this,i=t.accountChooserUrl;return a._accountChooserUrl=i,a._navigation=n.navigation,a}return Object(a.__extends)(t,e),t.prototype.switchAccount=function(){var e=this._accountChooserUrl;return this._navigation.navigateTo({url:e}),r.n.wrap()},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.n.dependencies),{navigation:K.e}),t}(i.n),Y=Object(_.o)("AccountChooserQueryStringHelper",Q),J=function(e){function t(t,n){var a=e.call(this,t,n)||this,i=t.viewParams,r=t.getApplication,o=a._behavior=function(e){var t=((new P.e).getState(T.e)||{}).aad_client_id,n=e.scope,a=H(e),i=function(e){void 0===e&&(e="");var t,n,a,i,r=e.split(":")[1],o=(void 0===r?"":r).split("|"),s=o[0],c=void 0===s?"":s,d=o[1],l=void 0===d?"":d,u=o[2],f=void 0===u?"":u;switch(c.toUpperCase()){case"READWRITEFOLDER":t=1,i=2;break;case"READWRITEFILE":t=1,i=1;break;case"READFOLDER":t=0,i=2;break;default:t=0,i=1}switch(l.toUpperCase()){case"MULTI":case"MULTIPLE":n=1;break;default:n=0}switch(f.toUpperCase()){case"DOWNLOADLINK":a=2;break;case"WEBVIEWLINK":a=0;break;default:a=1}return{accessLevel:t,viewType:i,selectionMode:n,linkType:a}}(n),r=i.accessLevel,o=i.viewType,s=i.selectionMode,c=i.linkType,d=R(e),u=function(e){void 0===e&&(e="");var t=new l.t(e).getQueryParameter("redirect_uri");return t&&Object(U.e)(t)}(a);return{showActions:!0,showBranding:!0,showSwitchAccount:!(!u||!d&&!t),accessLevel:r,viewType:o,selectionMode:s,linkType:c,returnUrl:u,aadClientId:t,msaClientId:d,typeFilter:Object(f.e)({viewType:o}),sdkVersion:"6.0"}}(i),s=a.scope;return a._oAuthConsentHelper=new(s.attached(n.oAuthConsentHelperType))({behavior:o,returnUrl:H(i),getApplication:r}),a._accountChooserQueryStringHelper=new(s.attached(n.accountChooserQueryStringHelperType))({accountChooserUrl:z(o)}),a._secureExperienceHelper=new(s.attached(n.secureExperienceHelperType))({behavior:o}),a}return Object(a.__extends)(t,e),t.prototype.getBehavior=function(){return this._behavior},t.prototype.initialize=function(){return this._secureExperienceHelper.validateExperience()},t.prototype.complete=function(e){return this._oAuthConsentHelper.complete(e)},t.prototype.cancel=function(){return this._oAuthConsentHelper.cancel()},t.prototype.switchAccount=function(){return this._accountChooserQueryStringHelper.switchAccount()},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.n.dependencies),{oAuthConsentHelperType:q,accountChooserQueryStringHelperType:Y,secureExperienceHelperType:y}),t}(i.n),X=Object(_.o)("Sdk60Handler",J),Z=n(2338),$=n(327);function ee(e){var t=e.aadClientId,n=e.returnUrl,a=e.state;if(!t||!n)return"";var i={client_id:t,redirect_uri:n,response_type:{uriValue:"id_token+token"},scope:"profile openid https://graph.microsoft.com/Files.ReadWrite https://graph.microsoft.com/User.Read",response_mode:"fragment",state:void 0===a?"aad_login":a,nonce:$.e.generate()};return"".concat("https://login.microsoftonline.com/common/oauth2/v2.0/authorize","?").concat(m.n(i,null,!0))}var te=function(e){function t(t,n){var a=e.call(this,t,n)||this,i=t.viewParams,r=a.scope,o=a._behavior=function(e){var t=Object(Z.t)(e);return t.msaClientId=R(e),t}(i);return a._oAuthConsentHelper=new(r.attached(n.oAuthConsentHelperType))({behavior:o,returnUrl:H(i),getApplication:t.getApplication}),a._accountChooserQueryStringHelper=new(r.attached(n.accountChooserQueryStringHelperType))({accountChooserUrl:ee(o)}),a._secureExperienceHelper=new(r.attached(n.secureExperienceHelperType))({behavior:o}),a}return Object(a.__extends)(t,e),t.prototype.getBehavior=function(){return this._behavior},t.prototype.initialize=function(){return this._secureExperienceHelper.validateExperience()},t.prototype.complete=function(e){return this._oAuthConsentHelper.complete(e)},t.prototype.cancel=function(){return this._oAuthConsentHelper.cancel()},t.prototype.switchAccount=function(){return this._accountChooserQueryStringHelper.switchAccount()},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.n.dependencies),{oAuthConsentHelperType:q,accountChooserQueryStringHelperType:Y,secureExperienceHelperType:y}),t}(i.n),ne=Object(_.o)("Sdk70Handler",te),ae=n(2235);n(864);var ie,re,oe,se=n(759),ce=n(1454),de=n(2140),le=n(302),ue=n(13);re=ie||(ie={}),oe=function(){function e(e,t){this._vroomDataRequestor=t.vroomDataRequestor}return e.prototype.getItem=function(e){var t=e.itemUrl,n=e.accessToken;return this._vroomDataRequestor.send({path:"".concat(t,"?select=*,sharePointIds"),accessToken:n,apiName:"GetItem"})},e.prototype.createLink=function(e){var t=e.itemUrl,n=e.accessToken;return this._vroomDataRequestor.send({path:"".concat(t,"/oneDrive.createLink"),accessToken:n,apiName:"CreateLink",postData:JSON.stringify({type:"view"}),requestType:"POST"})},e.dependencies={vroomDataRequestor:ce.e},e}(),re.PickerItemService=oe,re.pickerItemServiceResourceKey=new ue.t({name:"".concat("PickerItemHelper",".internals.pickerItemService"),factory:new _.n(oe)});var fe=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a._pickerItemService=n.pickerItemService,a._itemPickerProvider=n.itemPickerProvider,a._behavior=t.behavior,a}return Object(a.__extends)(t,e),t.prototype.getPickerItemsFromItems=function(e,t){var n=this,a=t.hostAuthenticationLevel;return r.n.all(e.map(function(e){var t,i,o=r.n.wrap(n._itemPickerProvider.getPickerItemFromItem(e,{hostAuthenticationLevel:a}));if(a>=2){var s=n._behavior.linkType;4!==s&&2!==s||(o=o.then(function(t){return n._attachDriveItemToPickerItem(e,t)})),4!==s&&3!==s||(o=o.then(function(t){return n._attachShareUrlToPickerItem(e,t)}))}else D.t.isActivated("EC770879-DEBC-4A0E-8078-E84625157D6B","3/18/2021","Attach minimum identity information to picked items")||(null===(t=e.graph)||void 0===t?void 0:t.driveId)&&(null===(i=e.graph)||void 0===i?void 0:i.itemId)||(o=o.then(function(t){return n._attachMinimumIdentityToPickerItem(e,t)}));return o}))},t.prototype._attachDriveItemToPickerItem=function(e,t){var n=t.urls,i=void 0===n?{}:n,r=Object(a.__rest)(t,["urls"]);return this._getOneDrivePickerItem(e).then(function(e){return Object(a.__assign)(Object(a.__assign)({},r),{urls:Object(a.__assign)(Object(a.__assign)({},i),{download:e["@content.downloadUrl"]}),driveItem:e})})},t.prototype._attachMinimumIdentityToPickerItem=function(e,t){t.urls;var n=Object(a.__rest)(t,["urls"]);return this._getOneDrivePickerItem(e).then(function(e){var t;return Object(a.__assign)(Object(a.__assign)({},n),{id:e.root?"root":e.id,parentReference:Object(a.__assign)({driveId:null===(t=e.parentReference)||void 0===t?void 0:t.driveId},n.parentReference)})})},t.prototype._attachShareUrlToPickerItem=function(e,t){var n=t.urls,i=void 0===n?{}:n,r=Object(a.__rest)(t,["urls"]);return this._getShareLink(e).then(function(e){return Object(a.__assign)(Object(a.__assign)({},r),{urls:Object(a.__assign)(Object(a.__assign)({},i),{share:e})})})},t.prototype._getOneDrivePickerItem=function(e){var t=this;return r.n.resolve(this.resources.consumeAsync(le.v)).then(function(n){return r.n.resolve().then(function(){return n.getAccessToken(e)||n.refreshAccessToken&&n.refreshAccessToken(e)}).then(function(a){return t._pickerItemService.getItem({itemUrl:n.getItemUrl(e,{useDirectEndpoint:!0,isPath:!1}),accessToken:a})})})},t.prototype._getShareLink=function(e){var t=this;return r.n.resolve(this.resources.consumeAsync(le.v)).then(function(n){return t._pickerItemService.createLink({itemUrl:n.getItemUrl(e,{useDirectEndpoint:!0,isPath:!1}),accessToken:n.getAccessToken(e)}).then(function(e){return e.link.webUrl})})},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.n.dependencies),{pickerItemService:ie.pickerItemServiceResourceKey,itemPickerProvider:de.e}),t}(i.n),pe=Object(_.o)("PickerItemHelper",fe),me=function(e){function t(t,n){var a=e.call(this,t,n)||this,i=t.behavior;a._behavior=i;var r=n.currentWindow,s=void 0===r?window:r,c=a._postMessageTargetSignal=new o.e,d=a._hostIdentitySignal=new o.e,l=s.parent!==s?s.parent:void 0,u=s.opener,f=i.origin,p=l||u;if(p){var m=a._getOrigin(p,f),_=m.origin,h=m.hostAuthenticationLevel;c.complete({window:p,origin:_}),h&&d.complete({authenticationLevel:h,reason:"origin"})}return x(i.origin)||d.complete({authenticationLevel:0,reason:"origin"}),a._pickerItemHelper=new n.pickerItemHelperType({behavior:i}),a._responseSignals={},a.events.on(s,"message",a._onMessage),a}return Object(a.__extends)(t,e),t.prototype.initialize=function(){var e=this._behavior.id,n=this._hostIdentitySignal;return this.async.setTimeout(function(){n.complete({authenticationLevel:0,reason:"timeout"})},C.i),this._sendRequest({conversationId:++t._nextConversationId,pickerId:e,type:"initialize"}).done(function(e){n.complete({authenticationLevel:0,reason:"invalid"})}),n.getPromise()},t.prototype.complete=function(e){var n=this,a=this._behavior.id;return this._hostIdentitySignal.getPromise().then(function(i){return n._pickerItemHelper.getPickerItemsFromItems(e,{hostAuthenticationLevel:i.authenticationLevel}).then(function(e){return n._sendRequest({conversationId:++t._nextConversationId,pickerId:a,type:"success",items:e})}).then(function(e){if("error"===e.type)return r.n.wrapError(new Error(e.error.message))})})},t.prototype.cancel=function(){var e=this._behavior.id;return this._sendRequest({conversationId:++t._nextConversationId,pickerId:e,type:"cancel"}).then(function(e){if("error"===e.type)return r.n.wrapError(new Error(e.error.message))})},t.prototype.switchAccount=function(){var e=this._behavior.id;return this._sendRequest({conversationId:++t._nextConversationId,pickerId:e,type:"switch"}).then(function(e){if("error"===e.type)return r.n.wrapError(new Error(e.error.message))})},t.prototype._getOrigin=function(e,t){var n,a;try{var i=e;n=new S.e(i.location.href).authority,a=2}catch(e){t===this._behavior.origin&&(n=t)}return{origin:n,hostAuthenticationLevel:a}},t.prototype._sendRequest=function(e){var t=this;return this._postMessageTargetSignal.getPromise().then(function(n){var a=n.window,i=n.origin;!function(e){if(!e)throw new Error("No specified origin");var t=new l.t(e),n=t.getScheme();if(!n||!/http(s)?/.test(n))throw new Error("Invalid origin scheme");var a=t.getHost();if(!a||a.indexOf("*")>-1)throw new Error("Invalid origin host")}(i);var r=e.conversationId,s="".concat(se.e).concat(JSON.stringify(e)),c=new o.e;return t._responseSignals[r]=c,a.postMessage(s,i),c.getPromise().then(function(e){return delete t._responseSignals[r],e})})},t.prototype._onMessage=function(e){var t=this,n="".concat(e.data||"");if(0===n.indexOf(se.t))try{var a=JSON.parse(n.substring(se.t.length));if(a.pickerId===this._behavior.id){var i=this._postMessageTargetSignal;if("activate"===a.type){var r=this._getOrigin(e.source,e.origin),o=r.hostAuthenticationLevel,s=void 0===o?x(e.origin)?2:0:o,c=r.origin;this._hostIdentitySignal.complete({authenticationLevel:s,reason:"origin"}),i.complete({window:e.source,origin:c})}i.getPromise().done(function(n){if(e.origin===n.origin){var i=t._responseSignals[a.conversationId];i&&i.complete(a)}})}}catch(e){}},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.n.dependencies),{pickerItemHelperType:pe}),t._nextConversationId=0,t}(i.n),_e=Object(_.o)("PostMessageHelper",me),he=function(e){function t(t,n){var a=e.call(this,t,n)||this,i=t.viewParams,r=a._behavior=function(e){return Object(ae.e)(e)}(i),o=a.scope;return a._postMessageHelper=new(o.attached(n.postMessageHelperType))({behavior:r}),a._secureExperienceHelper=new(o.attached(n.secureExperienceHelperType))({behavior:r}),a}return Object(a.__extends)(t,e),t.prototype.getBehavior=function(){return this._behavior},t.prototype.initialize=function(){var e=this;return this._postMessageHelper.initialize().then(function(t){return e._secureExperienceHelper.validateExperience(t)})},t.prototype.complete=function(e){return this._postMessageHelper.complete(e)},t.prototype.cancel=function(){return this._postMessageHelper.cancel()},t.prototype.switchAccount=function(){return this._postMessageHelper.switchAccount()},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.n.dependencies),{postMessageHelperType:_e,secureExperienceHelperType:y}),t}(i.n),be=Object(_.o)("Sdk71Handler",he),ge=n(2236),ve=function(e){function t(t,n){var a=e.call(this,t,n)||this,i=a._behavior=Object(ge.e)(t.viewParams),r=a.scope;return a._postMessageHelper=new(r.attached(n.postMessageHelperType))({behavior:i}),a._secureExperienceHelper=new(r.attached(n.secureExperienceHelperType))({behavior:i}),a}return Object(a.__extends)(t,e),t.prototype.getBehavior=function(){return this._behavior},t.prototype.initialize=function(){var e=this;return this._postMessageHelper.initialize().then(function(t){return e._secureExperienceHelper.validateExperience(t)})},t.prototype.complete=function(e){return this._postMessageHelper.complete(e)},t.prototype.cancel=function(){return this._postMessageHelper.cancel()},t.prototype.switchAccount=function(){return this._postMessageHelper.switchAccount()},t.dependencies={postMessageHelperType:_e,secureExperienceHelperType:y},t}(i.n),ye=Object(_.o)("Sdk72Handler",ve),Se=n(1437),De=n(82),Ie=n(509),xe=n(166),Ce=n(1324),Oe=n(1371),we=function(e){function t(t,n){void 0===t&&(t={});var a=e.call(this,t,n)||this;return a._urlDataSource=n.urlDataSource,a._itemsStore=n.itemsStore,a}return Object(a.__extends)(t,e),t.prototype.getHandler=function(e){var t=e.viewParams;return{handlerTypeKey:function(e){return!!e.livesdk}(t)?M:function(e){return F(e)&&Object(Z.o)(e)}(t)?ne:F(t)?X:Object(ge.t)(t)?ye:be}},t.prototype.getPivots=function(e){var t=e.behavior,n=this._createFilesRootItem(t),a=this._createPhotosRootItem(t),i=[];return n&&i.push({item:n,isActive:this._isCurrentViewFiles}),a&&i.push({item:a,isActive:this._isCurrentViewPhotos}),{pivots:i}},t.prototype.getItemFromPickerItem=function(e){var t;return{key:this._urlDataSource.getKey(((t={}).id=e.id,t)),id:e.root?"root":e.id}},t.prototype.getPickerItemFromItem=function(e){return{root:Oe.optional("root"===e.id?{}:void 0),endpoint:this._urlDataSource.getApiBaseUrl({apiVersion:"v1.0",driveId:e.ownerId})}},t.prototype._isCurrentViewFiles=function(e){return!e.qt},t.prototype._isCurrentViewPhotos=function(e){return"allmyphotos"===e.qt},t.prototype._createFilesRootItem=function(e){var t=e.typeFilter,n=void 0===t?{filters:[]}:t,a=new Se.e(this._urlDataSource.getKey(this._urlDataSource.saveItemTypeFilter(n)));a.name=Ie.e,a.displayName=Ie.e,a.properties.commandsSupported={defc:"1"},a.type=De.e.Folder;var i=this._itemsStore.getItem(a.key);return i&&!i.peek().isPlaceholder||this._itemsStore.setItem(a),a},t.prototype._createPhotosRootItem=function(e){for(var t,n,a=e.typeFilter,i=void 0===a?{filters:[]}:a,r=0===i.filters.length,o=0,s=i.filters;o<s.length;o++){var c=s[o];if(r)break;if("string"==typeof c);else switch(c){case xe.e.media:case xe.e.file:case xe.e.photo:case xe.e.video:r=!0}}if(r){(n=new Se.e(this._urlDataSource.getKey(((t={}).qt="allmyphotos",t)))).name=Ie.i,n.displayName=Ie.i,n.properties.commandsSupported={defc:"1"},n.type=De.e.Folder;var d=this._itemsStore.getItem(n.key);d&&!d.peek().isPlaceholder||this._itemsStore.setItem(n)}return n},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.n.dependencies),{urlDataSource:le.ge,itemsStore:Ce.e}),t}(i.n),Ee=(t.default=we,Object(_.r)("ItemPickerDataSource",we))},3528:function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return c});var a=n(0),i=n(7),r=n(31),o=n(13),s=n(729),c=new o.t({name:"OpenEntryItem",factory:{dependencies:{behavior:s.n},create:function(e){var t=e.behavior.entryLocation;return{instance:function(e,n){var o=this,s=e.viewParams;return function(c){return Object(a.__awaiter)(o,void 0,void 0,function(){var o,d,l;return Object(a.__generator)(this,function(u){switch(u.label){case 0:return t&&t.oneDrive?t.oneDrive.recent?(d=Object(i.A)(r.e.Recent),o=[{}],[4,c(n(Object(a.__assign)(Object(a.__assign)({},e),{viewParams:Object(a.__assign)(Object(a.__assign)({},s),Object(i.y)(d))})))]):[3,2]:[3,4];case 1:return[2,a.__assign.apply(void 0,[a.__assign.apply(void 0,o.concat([u.sent()])),{prefetchTimeout:2e3}])];case 2:return d=Object(i.A)(r.e.Files),l=[{}],[4,c(n(Object(a.__assign)(Object(a.__assign)({},e),{viewParams:Object(a.__assign)(Object(a.__assign)({},s),Object(i.y)(d))})))];case 3:return[2,a.__assign.apply(void 0,[a.__assign.apply(void 0,l.concat([u.sent()])),{prefetchTimeout:2e3}])];case 4:return[4,c(n(e))];case 5:return[2,u.sent()]}})})}}}}}})},3750:function(e,t,n){"use strict";n.r(t),n.d(t,"LegacyFilePicker",function(){return ne});var a=n(0),i=n(1),r=n(90),o=n(33),s=n(7),c=n(151),d=n(729),l=n(2562),u=n(911),f=n(1111),p=n(81),m=n(842),_=n(1883),h=n(209),b=n(814),g=n(13),v=n(925),y=n(926),S=n(746),D=n(1412),I=n(147),x=n(280),C=n(389),O=n(402),w=n(169),E=n(15),A=new g.t("".concat("Components",".canary"));function L(e,t,n){var r=this;return i.useMemo(function(){return Object(w.e)(function(){return Object(a.__awaiter)(r,void 0,void 0,function(){var i,r,o;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return i=null==n?void 0:n.barrier,r=null==n?void 0:n.bypass,i?[4,i]:[3,2];case 1:a.sent(),a.label=2;case 2:return r?E.e.isActivated("CE443088-1048-4D30-BCF1-14E5A320BE65","07/12/2022","Directly consume resources with .bypass")?[3,4]:[4,e.consumeAsync(t)]:[3,8];case 3:return[2,a.sent()];case 4:(o=new g.n(e,{owner:"Components"})).expose(A,!0),a.label=5;case 5:return a.trys.push([5,,7,8]),[4,o.consumeAsync(t)];case 6:return[2,a.sent()];case 7:return o.dispose(),[7];case 8:return[4,e.consumeAsync(t)];case 9:return[2,a.sent()]}})})})},[e,t])}var k=n(971),M=n(505),P=n(45),T=n(100),U=n(131),F=n(71),H=n(65),R=Object(b.n)({filePicker:h.n,itemsView:S.e,itemsViewLayouts:C.e,itemPickerCompleteAction:O.e}),N=new g.t({name:"".concat("LegacyFilePicker",".base"),factory:{dependencies:{agent:d.t,behavior:d.n},create:function(e){var t=e.behavior,n=e.agent;return{instance:function(e){var r,o=this,s=e.defaultRender,c=e.navSetKey,d=Object(a.__rest)(e,["defaultRender","navSetKey"]),_=t.showNavigation,h=void 0!==_&&_,b=Object(l.e)(t),g=function(e){return 0===e.selectionMode?"single":"multiple"}(t),S=function(e){return 2===e.viewType?"folders":1===e.viewType?"files":"all"}(t),C=i.useMemo(function(){return Object(u.t)(Object(p.t)(function(e){var t=e.itemKeys;return function(e){return Object(a.__awaiter)(o,void 0,void 0,function(){var i;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return[4,e(Object(f.e)(function(e){for(var n=[],a=0,i=t;a<i.length;a++){var r=i[a],o=e.demandItemFacet(m.t,r);o&&n.push(o)}return n}))];case 1:return i=a.sent(),n.complete(i.map(function(e){return e.peek()})),[2]}})})}}))},[]),O=i.useMemo(function(){return Object(u.n)(Object(p.t)(function(e){return function(e){return Object(a.__awaiter)(o,void 0,void 0,function(){return Object(a.__generator)(this,function(e){return n.cancel(),[2]})})}}))},[]),w=i.useCallback(function(e,t){return{}},[]),E=(r=t.layoutType,i.useMemo(function(){switch(r){case D.r:return I.t;case D.n:return I.e;case D.s:return x.e}},[r])),A=Object(v.e)(E),L=Object(y.e)(E),M=Object(k.e)({filters:b}),P=i.useMemo(function(){return{filePicker:w,itemsView:A,itemsViewLayouts:L,itemPickerCompleteAction:M}},[w,A,L,M]);return s?i.createElement(R,{value:P},i.createElement(s,Object(a.__assign)({},d,{title:h?void 0:"",selectionMode:g,itemMode:S,filters:b,navSetKey:h?c:void 0,completeAction:C,completeCommandName:t.completeText,failCommandName:t.cancelText,failAction:O}))):null}}}}}),B=new g.t({name:"".concat("LegacyFilePicker",".base"),factory:{dependencies:{agent:d.t,itemsScopeItemKey:M.e},create:function(e){var t=e.agent,n=e.itemsScopeItemKey;return{instance:function(e){var r=e.defaultRender,o=(e.navSetKey,Object(a.__rest)(e,["defaultRender","navSetKey"])),s=i.useState(!1),c=s[0],d=s[1],l=Object(T.t)();return i.useEffect(function(){t.initialize().then(function(){d(!0)},function(e){var t;e instanceof P.e&&"UnableToVerifyPickerHost"===e.code?H.e.log(e):l(Object(U.e)({items:(t={},t[n]=Object(a.__assign)({},F.t.pack(e)),t)})),d(!0)})},[]),r&&c?i.createElement(r,Object(a.__assign)({},o)):null}}}}}),j=n(93),V=n(104),z=n(359),G=n(8),K=n(114),W=n(120),q=n(150),Q=n(9),Y=n(2563),J={oneDrive:!0,recent:!0,shared:Object(Q._r)(Q.Se),photos:Object(Q._r)(Q.ye)},X=new g.t({name:"LegacyFilePickerItemSetNavControlHandler",factory:{dependencies:{behavior:d.n},create:function(e){var t=e.behavior;return{instance:function(e,n){var i,r,o,s,d,l=n.childKeys,u=t.sourceTypes,f=void 0===u?J:u,p=t.typeFilter,m=t.entryLocation,_=E.e.isActivated("BEDA8F7A-E438-4098-9316-319F6D6D0A6C","07/26/2022","Honor source type filters in legacy Picker")?J:Object(Y.t)(f,Object(Y.e)(p))||{},h=!m||m.oneDrive&&!m.oneDrive.recent,b=null===(i=null==m?void 0:m.oneDrive)||void 0===i?void 0:i.recent,g=null!==(r=_.oneDrive)&&void 0!==r&&r,v=null!==(o=_.recent)&&void 0!==o&&o,y=!!Object(Q._r)(Q.Se)&&null!==(s=_.shared)&&void 0!==s&&s,S=!!Object(Q._r)(Q.ye)&&null!==(d=_.photos)&&void 0!==d&&d,D=[];if(e.demandItemFacet(c.e,n.itemKey)&&l)for(var I=0,x=l;I<x.length;I++){var C=x[I];e.demandItemFacet(c.t,C)&&D.push(C)}function O(e,t){var n=t.commandGroup;return n?{commandGroup:Object(a.__assign)(Object(a.__assign)({},n),{name:""})}:{}}return{navGroupControlHandler:function(e,t){var n=t.itemKey,a=t.childItemKeys,i=e.demandItemFacet(c.t,n);if(i&&a){for(var r=[],o=0,s=a;o<s.length;o++){var d=s[o],l=e.demandItemFacet(G.e,d),u=e.demandItemFacet(K.e,d),f=e.demandItemFacet(W.e,d);l?(g||h)&&r.push(d):u?((v||b)&&r.push(d),S&&r.push(q.e.serialize({driveId:i.driveId,streamId:""}))):f&&y&&r.push(d)}return{childItemKeys:r,commandGroupControlHandler:O}}return{}},childKeys:D}}}}}}),Z=n(315),$=n(976),ee=n(977),te=Object(b.n)({filePicker:h.n,itemSetNav:z.t,itemsViewSearch:Z.e}),ne=Object(j.e)(function(e){var t=L(Object(r.n)(),i.useState(function(){return B.bypass})[0],{bypass:!0});return i.createElement(_.e,{bypass:!0},i.createElement(t,Object(a.__assign)({},e)))},Object(j.e)(function(e){var t=e.defaultRender,n=Object(a.__rest)(e,["defaultRender"]),l=Object(r.n)().consume(d.n),u=Object(r.n)().consume(X),f=l.showNavigation,p=void 0!==f&&f,m=l.showSearch,_=void 0!==m&&m&&Object(Q._r)(Q.Aa),h=i.useCallback(function(e,t){return Object(a.__assign)({},_?{searchBarAs:ee.e}:{})},[_]),b=Object($.e)(),g=function(){var e,t=null!==(e=Object(V.e)(s.B||void 0))&&void 0!==e?e:"me";return c.e.serialize({driveId:t,endpoint:Object(o.c)({apiVersion:"v1.0",driveId:t})})}(),v=i.useMemo(function(){return{filePicker:h,itemSetNav:u,itemsViewSearch:b}},[h,u,b]);return t?i.createElement(te,{value:v},i.createElement(t,Object(a.__assign)({},n,{navSetKey:p?g:""}))):null},function(e){var t=L(Object(r.n)(),i.useState(function(){return N.bypass})[0],{bypass:!0});return i.createElement(_.e,{bypass:!0},i.createElement(t,Object(a.__assign)({},e)))}))}}]);